{"ast":null,"code":"import _possibleConstructorReturn from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _createForOfIteratorHelper from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _assertThisInitialized from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _get from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _toConsumableArray from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _inherits from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _slicedToArray from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/mac/Apps/sr-manager/web/node_modules/@babel/runtime/regenerator\";\nimport 'core-js/modules/es.promise.js';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport 'core-js/modules/es.string.match.js';\nimport 'core-js/modules/es.string.replace.js';\nimport 'core-js/modules/es.string.starts-with.js';\nimport 'core-js/modules/es.array.iterator.js';\nimport 'core-js/modules/web.dom-collections.iterator.js';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport 'core-js/modules/es.array.reduce.js';\nimport 'core-js/modules/es.string.ends-with.js';\nimport 'core-js/modules/es.string.split.js';\nimport requestAnimationFrame from 'raf';\nimport 'core-js/modules/es.string.trim.js';\nimport RGBColor from 'rgbcolor';\nimport 'core-js/modules/es.string.includes.js';\nimport 'core-js/modules/es.array.index-of.js';\nimport 'core-js/modules/es.array.reverse.js';\nimport { SVGPathData } from 'svg-pathdata';\nimport 'core-js/modules/es.regexp.to-string.js';\nimport { canvasRGBA } from 'stackblur-canvas';\n/**\r\n * Options preset for `OffscreenCanvas`.\r\n * @param config - Preset requirements.\r\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\r\n * @returns Preset object.\r\n */\n\nfunction offscreen() {\n  var _ref4 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      DOMParserFallback = _ref4.DOMParser;\n\n  var preset = {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser: DOMParserFallback,\n    createCanvas: function createCanvas(width, height) {\n      return new OffscreenCanvas(width, height);\n    },\n    createImage: function createImage(url) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var response, blob, img;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(url);\n\n              case 2:\n                response = _context.sent;\n                _context.next = 5;\n                return response.blob();\n\n              case 5:\n                blob = _context.sent;\n                _context.next = 8;\n                return createImageBitmap(blob);\n\n              case 8:\n                img = _context.sent;\n                return _context.abrupt(\"return\", img);\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    }\n  };\n\n  if (typeof DOMParser !== 'undefined' || typeof DOMParserFallback === 'undefined') {\n    Reflect.deleteProperty(preset, 'DOMParser');\n  }\n\n  return preset;\n}\n/**\r\n * Options preset for `node-canvas`.\r\n * @param config - Preset requirements.\r\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\r\n * @param config.canvas - `node-canvas` exports.\r\n * @param config.fetch - WHATWG-compatible `fetch` function.\r\n * @returns Preset object.\r\n */\n\n\nfunction node(_ref) {\n  var DOMParser = _ref.DOMParser,\n      canvas = _ref.canvas,\n      fetch = _ref.fetch;\n  return {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser: DOMParser,\n    fetch: fetch,\n    createCanvas: canvas.createCanvas,\n    createImage: canvas.loadImage\n  };\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  offscreen: offscreen,\n  node: node\n});\n/**\r\n * HTML-safe compress white-spaces.\r\n * @param str - String to compress.\r\n * @returns String.\r\n */\n\nfunction compressSpaces(str) {\n  return str.replace(/(?!\\u3000)\\s+/gm, ' ');\n}\n/**\r\n * HTML-safe left trim.\r\n * @param str - String to trim.\r\n * @returns String.\r\n */\n\n\nfunction trimLeft(str) {\n  return str.replace(/^[\\n \\t]+/, '');\n}\n/**\r\n * HTML-safe right trim.\r\n * @param str - String to trim.\r\n * @returns String.\r\n */\n\n\nfunction trimRight(str) {\n  return str.replace(/[\\n \\t]+$/, '');\n}\n/**\r\n * String to numbers array.\r\n * @param str - Numbers string.\r\n * @returns Numbers array.\r\n */\n\n\nfunction toNumbers(str) {\n  var matches = (str || '').match(/-?(\\d+(?:\\.\\d*(?:[eE][+-]?\\d+)?)?|\\.\\d+)(?=\\D|$)/gm) || [];\n  return matches.map(parseFloat);\n} // Microsoft Edge fix\n\n\nvar allUppercase = /^[A-Z-]+$/;\n/**\r\n * Normalize attribute name.\r\n * @param name - Attribute name.\r\n * @returns Normalized attribute name.\r\n */\n\nfunction normalizeAttributeName(name) {\n  if (allUppercase.test(name)) {\n    return name.toLowerCase();\n  }\n\n  return name;\n}\n/**\r\n * Parse external URL.\r\n * @param url - CSS url string.\r\n * @returns Parsed URL.\r\n */\n\n\nfunction parseExternalUrl(url) {\n  //                      single quotes [2]\n  //                      v         double quotes [3]\n  //                      v         v         no quotes [4]\n  //                      v         v         v\n  var urlMatch = /url\\(('([^']+)'|\"([^\"]+)\"|([^'\")]+))\\)/.exec(url) || [];\n  return urlMatch[2] || urlMatch[3] || urlMatch[4];\n}\n/**\r\n * Transform floats to integers in rgb colors.\r\n * @param color - Color to normalize.\r\n * @returns Normalized color.\r\n */\n\n\nfunction normalizeColor(color) {\n  if (!color.startsWith('rgb')) {\n    return color;\n  }\n\n  var rgbParts = 3;\n  var normalizedColor = color.replace(/\\d+(\\.\\d+)?/g, function (num, isFloat) {\n    return rgbParts-- && isFloat ? String(Math.round(parseFloat(num))) : num;\n  });\n  return normalizedColor;\n} // slightly modified version of https://github.com/keeganstreet/specificity/blob/master/specificity.js\n\n\nvar attributeRegex = /(\\[[^\\]]+\\])/g;\nvar idRegex = /(#[^\\s+>~.[:]+)/g;\nvar classRegex = /(\\.[^\\s+>~.[:]+)/g;\nvar pseudoElementRegex = /(::[^\\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi;\nvar pseudoClassWithBracketsRegex = /(:[\\w-]+\\([^)]*\\))/gi;\nvar pseudoClassRegex = /(:[^\\s+>~.[:]+)/g;\nvar elementRegex = /([^\\s+>~.[:]+)/g;\n\nfunction findSelectorMatch(selector, regex) {\n  var matches = regex.exec(selector);\n\n  if (!matches) {\n    return [selector, 0];\n  }\n\n  return [selector.replace(regex, ' '), matches.length];\n}\n/**\r\n * Measure selector specificity.\r\n * @param selector - Selector to measure.\r\n * @returns Specificity.\r\n */\n\n\nfunction getSelectorSpecificity(selector) {\n  var specificity = [0, 0, 0];\n  var currentSelector = selector.replace(/:not\\(([^)]*)\\)/g, '     $1 ').replace(/{[\\s\\S]*/gm, ' ');\n  var delta = 0;\n\n  var _findSelectorMatch = findSelectorMatch(currentSelector, attributeRegex);\n\n  var _findSelectorMatch2 = _slicedToArray(_findSelectorMatch, 2);\n\n  currentSelector = _findSelectorMatch2[0];\n  delta = _findSelectorMatch2[1];\n  specificity[1] += delta;\n\n  var _findSelectorMatch3 = findSelectorMatch(currentSelector, idRegex);\n\n  var _findSelectorMatch4 = _slicedToArray(_findSelectorMatch3, 2);\n\n  currentSelector = _findSelectorMatch4[0];\n  delta = _findSelectorMatch4[1];\n  specificity[0] += delta;\n\n  var _findSelectorMatch5 = findSelectorMatch(currentSelector, classRegex);\n\n  var _findSelectorMatch6 = _slicedToArray(_findSelectorMatch5, 2);\n\n  currentSelector = _findSelectorMatch6[0];\n  delta = _findSelectorMatch6[1];\n  specificity[1] += delta;\n\n  var _findSelectorMatch7 = findSelectorMatch(currentSelector, pseudoElementRegex);\n\n  var _findSelectorMatch8 = _slicedToArray(_findSelectorMatch7, 2);\n\n  currentSelector = _findSelectorMatch8[0];\n  delta = _findSelectorMatch8[1];\n  specificity[2] += delta;\n\n  var _findSelectorMatch9 = findSelectorMatch(currentSelector, pseudoClassWithBracketsRegex);\n\n  var _findSelectorMatch10 = _slicedToArray(_findSelectorMatch9, 2);\n\n  currentSelector = _findSelectorMatch10[0];\n  delta = _findSelectorMatch10[1];\n  specificity[1] += delta;\n\n  var _findSelectorMatch11 = findSelectorMatch(currentSelector, pseudoClassRegex);\n\n  var _findSelectorMatch12 = _slicedToArray(_findSelectorMatch11, 2);\n\n  currentSelector = _findSelectorMatch12[0];\n  delta = _findSelectorMatch12[1];\n  specificity[1] += delta;\n  currentSelector = currentSelector.replace(/[*\\s+>~]/g, ' ').replace(/[#.]/g, ' ');\n\n  var _findSelectorMatch13 = findSelectorMatch(currentSelector, elementRegex);\n\n  var _findSelectorMatch14 = _slicedToArray(_findSelectorMatch13, 2);\n\n  currentSelector = _findSelectorMatch14[0];\n  delta = _findSelectorMatch14[1];\n  // lgtm [js/useless-assignment-to-local]\n  specificity[2] += delta;\n  return specificity.join('');\n}\n\nvar PSEUDO_ZERO = .00000001;\n/**\r\n * Vector magnitude.\r\n * @param v\r\n * @returns Number result.\r\n */\n\nfunction vectorMagnitude(v) {\n  return Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2));\n}\n/**\r\n * Ratio between two vectors.\r\n * @param u\r\n * @param v\r\n * @returns Number result.\r\n */\n\n\nfunction vectorsRatio(u, v) {\n  return (u[0] * v[0] + u[1] * v[1]) / (vectorMagnitude(u) * vectorMagnitude(v));\n}\n/**\r\n * Angle between two vectors.\r\n * @param u\r\n * @param v\r\n * @returns Number result.\r\n */\n\n\nfunction vectorsAngle(u, v) {\n  return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vectorsRatio(u, v));\n}\n\nfunction CB1(t) {\n  return t * t * t;\n}\n\nfunction CB2(t) {\n  return 3 * t * t * (1 - t);\n}\n\nfunction CB3(t) {\n  return 3 * t * (1 - t) * (1 - t);\n}\n\nfunction CB4(t) {\n  return (1 - t) * (1 - t) * (1 - t);\n}\n\nfunction QB1(t) {\n  return t * t;\n}\n\nfunction QB2(t) {\n  return 2 * t * (1 - t);\n}\n\nfunction QB3(t) {\n  return (1 - t) * (1 - t);\n}\n\nvar Property = /*#__PURE__*/function () {\n  function Property(document, name, value) {\n    _classCallCheck(this, Property);\n\n    this.document = document;\n    this.name = name;\n    this.value = value;\n    this.isNormalizedColor = false;\n  }\n\n  _createClass(Property, [{\n    key: \"split\",\n    value: function split() {\n      var separator = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ' ';\n      var document = this.document,\n          name = this.name;\n      return compressSpaces(this.getString()).trim().split(separator).map(function (value) {\n        return new Property(document, name, value);\n      });\n    }\n  }, {\n    key: \"hasValue\",\n    value: function hasValue(zeroIsValue) {\n      var value = this.value;\n      return value !== null && value !== '' && (zeroIsValue || value !== 0) && typeof value !== 'undefined';\n    }\n  }, {\n    key: \"isString\",\n    value: function isString(regexp) {\n      var value = this.value;\n      var result = typeof value === 'string';\n\n      if (!result || !regexp) {\n        return result;\n      }\n\n      return regexp.test(value);\n    }\n  }, {\n    key: \"isUrlDefinition\",\n    value: function isUrlDefinition() {\n      return this.isString(/^url\\(/);\n    }\n  }, {\n    key: \"isPixels\",\n    value: function isPixels() {\n      if (!this.hasValue()) {\n        return false;\n      }\n\n      var asString = this.getString();\n\n      switch (true) {\n        case asString.endsWith('px'):\n        case /^[0-9]+$/.test(asString):\n          return true;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      this.value = value;\n      return this;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(def) {\n      if (typeof def === 'undefined' || this.hasValue()) {\n        return this.value;\n      }\n\n      return def;\n    }\n  }, {\n    key: \"getNumber\",\n    value: function getNumber(def) {\n      if (!this.hasValue()) {\n        if (typeof def === 'undefined') {\n          return 0;\n        }\n\n        return parseFloat(def);\n      }\n\n      var value = this.value;\n      var n = parseFloat(value);\n\n      if (this.isString(/%$/)) {\n        n /= 100.0;\n      }\n\n      return n;\n    }\n  }, {\n    key: \"getString\",\n    value: function getString(def) {\n      if (typeof def === 'undefined' || this.hasValue()) {\n        return typeof this.value === 'undefined' ? '' : String(this.value);\n      }\n\n      return String(def);\n    }\n  }, {\n    key: \"getColor\",\n    value: function getColor(def) {\n      var color = this.getString(def);\n\n      if (this.isNormalizedColor) {\n        return color;\n      }\n\n      this.isNormalizedColor = true;\n      color = normalizeColor(color);\n      this.value = color;\n      return color;\n    }\n  }, {\n    key: \"getDpi\",\n    value: function getDpi() {\n      return 96.0; // TODO: compute?\n    }\n  }, {\n    key: \"getRem\",\n    value: function getRem() {\n      return this.document.rootEmSize;\n    }\n  }, {\n    key: \"getEm\",\n    value: function getEm() {\n      return this.document.emSize;\n    }\n  }, {\n    key: \"getUnits\",\n    value: function getUnits() {\n      return this.getString().replace(/[0-9.-]/g, '');\n    }\n  }, {\n    key: \"getPixels\",\n    value: function getPixels(axisOrIsFontSize) {\n      var processPercent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!this.hasValue()) {\n        return 0;\n      }\n\n      var _ref5 = typeof axisOrIsFontSize === 'boolean' ? [undefined, axisOrIsFontSize] : [axisOrIsFontSize],\n          _ref6 = _slicedToArray(_ref5, 2),\n          axis = _ref6[0],\n          isFontSize = _ref6[1];\n\n      var viewPort = this.document.screen.viewPort;\n\n      switch (true) {\n        case this.isString(/vmin$/):\n          return this.getNumber() / 100.0 * Math.min(viewPort.computeSize('x'), viewPort.computeSize('y'));\n\n        case this.isString(/vmax$/):\n          return this.getNumber() / 100.0 * Math.max(viewPort.computeSize('x'), viewPort.computeSize('y'));\n\n        case this.isString(/vw$/):\n          return this.getNumber() / 100.0 * viewPort.computeSize('x');\n\n        case this.isString(/vh$/):\n          return this.getNumber() / 100.0 * viewPort.computeSize('y');\n\n        case this.isString(/rem$/):\n          return this.getNumber() * this.getRem();\n\n        case this.isString(/em$/):\n          return this.getNumber() * this.getEm();\n\n        case this.isString(/ex$/):\n          return this.getNumber() * this.getEm() / 2.0;\n\n        case this.isString(/px$/):\n          return this.getNumber();\n\n        case this.isString(/pt$/):\n          return this.getNumber() * this.getDpi() * (1.0 / 72.0);\n\n        case this.isString(/pc$/):\n          return this.getNumber() * 15;\n\n        case this.isString(/cm$/):\n          return this.getNumber() * this.getDpi() / 2.54;\n\n        case this.isString(/mm$/):\n          return this.getNumber() * this.getDpi() / 25.4;\n\n        case this.isString(/in$/):\n          return this.getNumber() * this.getDpi();\n\n        case this.isString(/%$/) && isFontSize:\n          return this.getNumber() * this.getEm();\n\n        case this.isString(/%$/):\n          return this.getNumber() * viewPort.computeSize(axis);\n\n        default:\n          {\n            var n = this.getNumber();\n\n            if (processPercent && n < 1.0) {\n              return n * viewPort.computeSize(axis);\n            }\n\n            return n;\n          }\n      }\n    }\n  }, {\n    key: \"getMilliseconds\",\n    value: function getMilliseconds() {\n      if (!this.hasValue()) {\n        return 0;\n      }\n\n      if (this.isString(/ms$/)) {\n        return this.getNumber();\n      }\n\n      return this.getNumber() * 1000;\n    }\n  }, {\n    key: \"getRadians\",\n    value: function getRadians() {\n      if (!this.hasValue()) {\n        return 0;\n      }\n\n      switch (true) {\n        case this.isString(/deg$/):\n          return this.getNumber() * (Math.PI / 180.0);\n\n        case this.isString(/grad$/):\n          return this.getNumber() * (Math.PI / 200.0);\n\n        case this.isString(/rad$/):\n          return this.getNumber();\n\n        default:\n          return this.getNumber() * (Math.PI / 180.0);\n      }\n    }\n  }, {\n    key: \"getDefinition\",\n    value: function getDefinition() {\n      var asString = this.getString();\n      var name = /#([^)'\"]+)/.exec(asString);\n\n      if (name) {\n        name = name[1];\n      }\n\n      if (!name) {\n        name = asString;\n      }\n\n      return this.document.definitions[name];\n    }\n  }, {\n    key: \"getFillStyleDefinition\",\n    value: function getFillStyleDefinition(element, opacity) {\n      var def = this.getDefinition();\n\n      if (!def) {\n        return null;\n      } // gradient\n\n\n      if (typeof def.createGradient === 'function') {\n        return def.createGradient(this.document.ctx, element, opacity);\n      } // pattern\n\n\n      if (typeof def.createPattern === 'function') {\n        if (def.getHrefAttribute().hasValue()) {\n          var patternTransform = def.getAttribute('patternTransform');\n          def = def.getHrefAttribute().getDefinition();\n\n          if (patternTransform.hasValue()) {\n            def.getAttribute('patternTransform', true).setValue(patternTransform.value);\n          }\n        }\n\n        return def.createPattern(this.document.ctx, element, opacity);\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getTextBaseline\",\n    value: function getTextBaseline() {\n      if (!this.hasValue()) {\n        return null;\n      }\n\n      return Property.textBaselineMapping[this.getString()];\n    }\n  }, {\n    key: \"addOpacity\",\n    value: function addOpacity(opacity) {\n      var value = this.getColor();\n      var len = value.length;\n      var commas = 0; // Simulate old RGBColor version, which can't parse rgba.\n\n      for (var i = 0; i < len; i++) {\n        if (value[i] === ',') {\n          commas++;\n        }\n\n        if (commas === 3) {\n          break;\n        }\n      }\n\n      if (opacity.hasValue() && this.isString() && commas !== 3) {\n        var color = new RGBColor(value);\n\n        if (color.ok) {\n          color.alpha = opacity.getNumber();\n          value = color.toRGBA();\n        }\n      }\n\n      return new Property(this.document, this.name, value);\n    }\n  }], [{\n    key: \"empty\",\n    value: function empty(document) {\n      return new Property(document, 'EMPTY', '');\n    }\n  }]);\n\n  return Property;\n}();\n\nProperty.textBaselineMapping = {\n  'baseline': 'alphabetic',\n  'before-edge': 'top',\n  'text-before-edge': 'top',\n  'middle': 'middle',\n  'central': 'middle',\n  'after-edge': 'bottom',\n  'text-after-edge': 'bottom',\n  'ideographic': 'ideographic',\n  'alphabetic': 'alphabetic',\n  'hanging': 'hanging',\n  'mathematical': 'alphabetic'\n};\n\nvar ViewPort = /*#__PURE__*/function () {\n  function ViewPort() {\n    _classCallCheck(this, ViewPort);\n\n    this.viewPorts = [];\n  }\n\n  _createClass(ViewPort, [{\n    key: \"clear\",\n    value: function clear() {\n      this.viewPorts = [];\n    }\n  }, {\n    key: \"setCurrent\",\n    value: function setCurrent(width, height) {\n      this.viewPorts.push({\n        width: width,\n        height: height\n      });\n    }\n  }, {\n    key: \"removeCurrent\",\n    value: function removeCurrent() {\n      this.viewPorts.pop();\n    }\n  }, {\n    key: \"getCurrent\",\n    value: function getCurrent() {\n      var viewPorts = this.viewPorts;\n      return viewPorts[viewPorts.length - 1];\n    }\n  }, {\n    key: \"width\",\n    get: function get() {\n      return this.getCurrent().width;\n    }\n  }, {\n    key: \"height\",\n    get: function get() {\n      return this.getCurrent().height;\n    }\n  }, {\n    key: \"computeSize\",\n    value: function computeSize(d) {\n      if (typeof d === 'number') {\n        return d;\n      }\n\n      if (d === 'x') {\n        return this.width;\n      }\n\n      if (d === 'y') {\n        return this.height;\n      }\n\n      return Math.sqrt(Math.pow(this.width, 2) + Math.pow(this.height, 2)) / Math.sqrt(2);\n    }\n  }]);\n\n  return ViewPort;\n}();\n\nvar Point = /*#__PURE__*/function () {\n  function Point(x, y) {\n    _classCallCheck(this, Point);\n\n    this.x = x;\n    this.y = y;\n  }\n\n  _createClass(Point, [{\n    key: \"angleTo\",\n    value: function angleTo(point) {\n      return Math.atan2(point.y - this.y, point.x - this.x);\n    }\n  }, {\n    key: \"applyTransform\",\n    value: function applyTransform(transform) {\n      var x = this.x,\n          y = this.y;\n      var xp = x * transform[0] + y * transform[2] + transform[4];\n      var yp = x * transform[1] + y * transform[3] + transform[5];\n      this.x = xp;\n      this.y = yp;\n    }\n  }], [{\n    key: \"parse\",\n    value: function parse(point) {\n      var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var _toNumbers = toNumbers(point),\n          _toNumbers2 = _slicedToArray(_toNumbers, 2),\n          _toNumbers2$ = _toNumbers2[0],\n          x = _toNumbers2$ === void 0 ? defaultValue : _toNumbers2$,\n          _toNumbers2$2 = _toNumbers2[1],\n          y = _toNumbers2$2 === void 0 ? defaultValue : _toNumbers2$2;\n\n      return new Point(x, y);\n    }\n  }, {\n    key: \"parseScale\",\n    value: function parseScale(scale) {\n      var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n      var _toNumbers3 = toNumbers(scale),\n          _toNumbers4 = _slicedToArray(_toNumbers3, 2),\n          _toNumbers4$ = _toNumbers4[0],\n          x = _toNumbers4$ === void 0 ? defaultValue : _toNumbers4$,\n          _toNumbers4$2 = _toNumbers4[1],\n          y = _toNumbers4$2 === void 0 ? x : _toNumbers4$2;\n\n      return new Point(x, y);\n    }\n  }, {\n    key: \"parsePath\",\n    value: function parsePath(path) {\n      var points = toNumbers(path);\n      var len = points.length;\n      var pathPoints = [];\n\n      for (var i = 0; i < len; i += 2) {\n        pathPoints.push(new Point(points[i], points[i + 1]));\n      }\n\n      return pathPoints;\n    }\n  }]);\n\n  return Point;\n}();\n\nvar Mouse = /*#__PURE__*/function () {\n  function Mouse(screen) {\n    _classCallCheck(this, Mouse);\n\n    this.screen = screen;\n    this.working = false;\n    this.events = [];\n    this.eventElements = []; // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n\n    this.onClick = this.onClick.bind(this); // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n\n    this.onMouseMove = this.onMouseMove.bind(this);\n  }\n\n  _createClass(Mouse, [{\n    key: \"isWorking\",\n    value: function isWorking() {\n      return this.working;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      if (this.working) {\n        return;\n      }\n\n      var screen = this.screen,\n          onClick = this.onClick,\n          onMouseMove = this.onMouseMove;\n      var canvas = screen.ctx.canvas;\n      canvas.onclick = onClick;\n      canvas.onmousemove = onMouseMove;\n      this.working = true;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (!this.working) {\n        return;\n      }\n\n      var canvas = this.screen.ctx.canvas;\n      this.working = false;\n      canvas.onclick = null;\n      canvas.onmousemove = null;\n    }\n  }, {\n    key: \"hasEvents\",\n    value: function hasEvents() {\n      return this.working && this.events.length > 0;\n    }\n  }, {\n    key: \"runEvents\",\n    value: function runEvents() {\n      if (!this.working) {\n        return;\n      }\n\n      var document = this.screen,\n          events = this.events,\n          eventElements = this.eventElements;\n      var style = document.ctx.canvas.style;\n\n      if (style) {\n        style.cursor = '';\n      }\n\n      events.forEach(function (_ref, i) {\n        var run = _ref.run;\n        var element = eventElements[i];\n\n        while (element) {\n          run(element);\n          element = element.parent;\n        }\n      }); // done running, clear\n\n      this.events = [];\n      this.eventElements = [];\n    }\n  }, {\n    key: \"checkPath\",\n    value: function checkPath(element, ctx) {\n      if (!this.working || !ctx) {\n        return;\n      }\n\n      var events = this.events,\n          eventElements = this.eventElements;\n      events.forEach(function (_ref2, i) {\n        var x = _ref2.x,\n            y = _ref2.y;\n\n        if (!eventElements[i] && ctx.isPointInPath && ctx.isPointInPath(x, y)) {\n          eventElements[i] = element;\n        }\n      });\n    }\n  }, {\n    key: \"checkBoundingBox\",\n    value: function checkBoundingBox(element, boundingBox) {\n      if (!this.working || !boundingBox) {\n        return;\n      }\n\n      var events = this.events,\n          eventElements = this.eventElements;\n      events.forEach(function (_ref3, i) {\n        var x = _ref3.x,\n            y = _ref3.y;\n\n        if (!eventElements[i] && boundingBox.isPointInBox(x, y)) {\n          eventElements[i] = element;\n        }\n      });\n    }\n  }, {\n    key: \"mapXY\",\n    value: function mapXY(x, y) {\n      var _this$screen = this.screen,\n          window = _this$screen.window,\n          ctx = _this$screen.ctx;\n      var point = new Point(x, y);\n      var element = ctx.canvas;\n\n      while (element) {\n        point.x -= element.offsetLeft;\n        point.y -= element.offsetTop;\n        element = element.offsetParent;\n      }\n\n      if (window.scrollX) {\n        point.x += window.scrollX;\n      }\n\n      if (window.scrollY) {\n        point.y += window.scrollY;\n      }\n\n      return point;\n    }\n  }, {\n    key: \"onClick\",\n    value: function onClick(event) {\n      var _this$mapXY = this.mapXY(event.clientX, event.clientY),\n          x = _this$mapXY.x,\n          y = _this$mapXY.y;\n\n      this.events.push({\n        type: 'onclick',\n        x: x,\n        y: y,\n        run: function run(eventTarget) {\n          if (eventTarget.onClick) {\n            eventTarget.onClick();\n          }\n        }\n      });\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(event) {\n      var _this$mapXY2 = this.mapXY(event.clientX, event.clientY),\n          x = _this$mapXY2.x,\n          y = _this$mapXY2.y;\n\n      this.events.push({\n        type: 'onmousemove',\n        x: x,\n        y: y,\n        run: function run(eventTarget) {\n          if (eventTarget.onMouseMove) {\n            eventTarget.onMouseMove();\n          }\n        }\n      });\n    }\n  }]);\n\n  return Mouse;\n}();\n\nvar defaultWindow = typeof window !== 'undefined' ? window : null;\nvar defaultFetch$1 = typeof fetch !== 'undefined' ? fetch.bind(undefined) // `fetch` depends on context: `someObject.fetch(...)` will throw error.\n: null;\n\nvar Screen = /*#__PURE__*/function () {\n  function Screen(ctx) {\n    _classCallCheck(this, Screen);\n\n    var _ref7 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref7$fetch = _ref7.fetch,\n        fetch = _ref7$fetch === void 0 ? defaultFetch$1 : _ref7$fetch,\n        _ref7$window = _ref7.window,\n        window = _ref7$window === void 0 ? defaultWindow : _ref7$window;\n\n    this.ctx = ctx;\n    this.FRAMERATE = 30;\n    this.MAX_VIRTUAL_PIXELS = 30000;\n    this.CLIENT_WIDTH = 800;\n    this.CLIENT_HEIGHT = 600;\n    this.viewPort = new ViewPort();\n    this.mouse = new Mouse(this);\n    this.animations = [];\n    this.waits = [];\n    this.frameDuration = 0;\n    this.isReadyLock = false;\n    this.isFirstRender = true;\n    this.intervalId = null;\n    this.window = window;\n    this.fetch = fetch;\n  }\n\n  _createClass(Screen, [{\n    key: \"wait\",\n    value: function wait(checker) {\n      this.waits.push(checker);\n    }\n  }, {\n    key: \"ready\",\n    value: function ready() {\n      // eslint-disable-next-line @typescript-eslint/no-misused-promises\n      if (!this.readyPromise) {\n        return Promise.resolve();\n      }\n\n      return this.readyPromise;\n    }\n  }, {\n    key: \"isReady\",\n    value: function isReady() {\n      if (this.isReadyLock) {\n        return true;\n      }\n\n      var isReadyLock = this.waits.every(function (_) {\n        return _();\n      });\n\n      if (isReadyLock) {\n        this.waits = [];\n\n        if (this.resolveReady) {\n          this.resolveReady();\n        }\n      }\n\n      this.isReadyLock = isReadyLock;\n      return isReadyLock;\n    }\n  }, {\n    key: \"setDefaults\",\n    value: function setDefaults(ctx) {\n      // initial values and defaults\n      ctx.strokeStyle = 'rgba(0,0,0,0)';\n      ctx.lineCap = 'butt';\n      ctx.lineJoin = 'miter';\n      ctx.miterLimit = 4;\n    }\n  }, {\n    key: \"setViewBox\",\n    value: function setViewBox(_ref) {\n      var document = _ref.document,\n          ctx = _ref.ctx,\n          aspectRatio = _ref.aspectRatio,\n          width = _ref.width,\n          desiredWidth = _ref.desiredWidth,\n          height = _ref.height,\n          desiredHeight = _ref.desiredHeight,\n          _ref$minX = _ref.minX,\n          minX = _ref$minX === void 0 ? 0 : _ref$minX,\n          _ref$minY = _ref.minY,\n          minY = _ref$minY === void 0 ? 0 : _ref$minY,\n          refX = _ref.refX,\n          refY = _ref.refY,\n          _ref$clip = _ref.clip,\n          clip = _ref$clip === void 0 ? false : _ref$clip,\n          _ref$clipX = _ref.clipX,\n          clipX = _ref$clipX === void 0 ? 0 : _ref$clipX,\n          _ref$clipY = _ref.clipY,\n          clipY = _ref$clipY === void 0 ? 0 : _ref$clipY; // aspect ratio - http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\n\n      var cleanAspectRatio = compressSpaces(aspectRatio).replace(/^defer\\s/, ''); // ignore defer\n\n      var _cleanAspectRatio$spl = cleanAspectRatio.split(' '),\n          _cleanAspectRatio$spl2 = _slicedToArray(_cleanAspectRatio$spl, 2),\n          aspectRatioAlign = _cleanAspectRatio$spl2[0],\n          aspectRatioMeetOrSlice = _cleanAspectRatio$spl2[1];\n\n      var align = aspectRatioAlign || 'xMidYMid';\n      var meetOrSlice = aspectRatioMeetOrSlice || 'meet'; // calculate scale\n\n      var scaleX = width / desiredWidth;\n      var scaleY = height / desiredHeight;\n      var scaleMin = Math.min(scaleX, scaleY);\n      var scaleMax = Math.max(scaleX, scaleY);\n      var finalDesiredWidth = desiredWidth;\n      var finalDesiredHeight = desiredHeight;\n\n      if (meetOrSlice === 'meet') {\n        finalDesiredWidth *= scaleMin;\n        finalDesiredHeight *= scaleMin;\n      }\n\n      if (meetOrSlice === 'slice') {\n        finalDesiredWidth *= scaleMax;\n        finalDesiredHeight *= scaleMax;\n      }\n\n      var refXProp = new Property(document, 'refX', refX);\n      var refYProp = new Property(document, 'refY', refY);\n      var hasRefs = refXProp.hasValue() && refYProp.hasValue();\n\n      if (hasRefs) {\n        ctx.translate(-scaleMin * refXProp.getPixels('x'), -scaleMin * refYProp.getPixels('y'));\n      }\n\n      if (clip) {\n        var scaledClipX = scaleMin * clipX;\n        var scaledClipY = scaleMin * clipY;\n        ctx.beginPath();\n        ctx.moveTo(scaledClipX, scaledClipY);\n        ctx.lineTo(width, scaledClipY);\n        ctx.lineTo(width, height);\n        ctx.lineTo(scaledClipX, height);\n        ctx.closePath();\n        ctx.clip();\n      }\n\n      if (!hasRefs) {\n        var isMeetMinY = meetOrSlice === 'meet' && scaleMin === scaleY;\n        var isSliceMaxY = meetOrSlice === 'slice' && scaleMax === scaleY;\n        var isMeetMinX = meetOrSlice === 'meet' && scaleMin === scaleX;\n        var isSliceMaxX = meetOrSlice === 'slice' && scaleMax === scaleX;\n\n        if (align.startsWith('xMid') && (isMeetMinY || isSliceMaxY)) {\n          ctx.translate(width / 2.0 - finalDesiredWidth / 2.0, 0);\n        }\n\n        if (align.endsWith('YMid') && (isMeetMinX || isSliceMaxX)) {\n          ctx.translate(0, height / 2.0 - finalDesiredHeight / 2.0);\n        }\n\n        if (align.startsWith('xMax') && (isMeetMinY || isSliceMaxY)) {\n          ctx.translate(width - finalDesiredWidth, 0);\n        }\n\n        if (align.endsWith('YMax') && (isMeetMinX || isSliceMaxX)) {\n          ctx.translate(0, height - finalDesiredHeight);\n        }\n      } // scale\n\n\n      switch (true) {\n        case align === 'none':\n          ctx.scale(scaleX, scaleY);\n          break;\n\n        case meetOrSlice === 'meet':\n          ctx.scale(scaleMin, scaleMin);\n          break;\n\n        case meetOrSlice === 'slice':\n          ctx.scale(scaleMax, scaleMax);\n          break;\n      } // translate\n\n\n      ctx.translate(-minX, -minY);\n    }\n  }, {\n    key: \"start\",\n    value: function start(element) {\n      var _this3 = this;\n\n      var _ref8 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref8$enableRedraw = _ref8.enableRedraw,\n          enableRedraw = _ref8$enableRedraw === void 0 ? false : _ref8$enableRedraw,\n          _ref8$ignoreMouse = _ref8.ignoreMouse,\n          ignoreMouse = _ref8$ignoreMouse === void 0 ? false : _ref8$ignoreMouse,\n          _ref8$ignoreAnimation = _ref8.ignoreAnimation,\n          ignoreAnimation = _ref8$ignoreAnimation === void 0 ? false : _ref8$ignoreAnimation,\n          _ref8$ignoreDimension = _ref8.ignoreDimensions,\n          ignoreDimensions = _ref8$ignoreDimension === void 0 ? false : _ref8$ignoreDimension,\n          _ref8$ignoreClear = _ref8.ignoreClear,\n          ignoreClear = _ref8$ignoreClear === void 0 ? false : _ref8$ignoreClear,\n          forceRedraw = _ref8.forceRedraw,\n          scaleWidth = _ref8.scaleWidth,\n          scaleHeight = _ref8.scaleHeight,\n          offsetX = _ref8.offsetX,\n          offsetY = _ref8.offsetY;\n\n      var FRAMERATE = this.FRAMERATE,\n          mouse = this.mouse;\n      var frameDuration = 1000 / FRAMERATE;\n      this.frameDuration = frameDuration;\n      this.readyPromise = new Promise(function (resolve) {\n        _this3.resolveReady = resolve;\n      });\n\n      if (this.isReady()) {\n        this.render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY);\n      }\n\n      if (!enableRedraw) {\n        return;\n      }\n\n      var now = Date.now();\n      var then = now;\n      var delta = 0;\n\n      var tick = function tick() {\n        now = Date.now();\n        delta = now - then;\n\n        if (delta >= frameDuration) {\n          then = now - delta % frameDuration;\n\n          if (_this3.shouldUpdate(ignoreAnimation, forceRedraw)) {\n            _this3.render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY);\n\n            mouse.runEvents();\n          }\n        }\n\n        _this3.intervalId = requestAnimationFrame(tick);\n      };\n\n      if (!ignoreMouse) {\n        mouse.start();\n      }\n\n      this.intervalId = requestAnimationFrame(tick);\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this.intervalId) {\n        requestAnimationFrame.cancel(this.intervalId);\n        this.intervalId = null;\n      }\n\n      this.mouse.stop();\n    }\n  }, {\n    key: \"shouldUpdate\",\n    value: function shouldUpdate(ignoreAnimation, forceRedraw) {\n      // need update from animations?\n      if (!ignoreAnimation) {\n        var frameDuration = this.frameDuration;\n        var shouldUpdate = this.animations.reduce(function (shouldUpdate, animation) {\n          return animation.update(frameDuration) || shouldUpdate;\n        }, false);\n\n        if (shouldUpdate) {\n          return true;\n        }\n      } // need update from redraw?\n\n\n      if (typeof forceRedraw === 'function' && forceRedraw()) {\n        return true;\n      }\n\n      if (!this.isReadyLock && this.isReady()) {\n        return true;\n      } // need update from mouse events?\n\n\n      if (this.mouse.hasEvents()) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"render\",\n    value: function render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY) {\n      var CLIENT_WIDTH = this.CLIENT_WIDTH,\n          CLIENT_HEIGHT = this.CLIENT_HEIGHT,\n          viewPort = this.viewPort,\n          ctx = this.ctx,\n          isFirstRender = this.isFirstRender;\n      var canvas = ctx.canvas;\n      viewPort.clear();\n\n      if (canvas.width && canvas.height) {\n        viewPort.setCurrent(canvas.width, canvas.height);\n      } else {\n        viewPort.setCurrent(CLIENT_WIDTH, CLIENT_HEIGHT);\n      }\n\n      var widthStyle = element.getStyle('width');\n      var heightStyle = element.getStyle('height');\n\n      if (!ignoreDimensions && (isFirstRender || typeof scaleWidth !== 'number' && typeof scaleHeight !== 'number')) {\n        // set canvas size\n        if (widthStyle.hasValue()) {\n          canvas.width = widthStyle.getPixels('x');\n\n          if (canvas.style) {\n            canvas.style.width = \"\".concat(canvas.width, \"px\");\n          }\n        }\n\n        if (heightStyle.hasValue()) {\n          canvas.height = heightStyle.getPixels('y');\n\n          if (canvas.style) {\n            canvas.style.height = \"\".concat(canvas.height, \"px\");\n          }\n        }\n      }\n\n      var cWidth = canvas.clientWidth || canvas.width;\n      var cHeight = canvas.clientHeight || canvas.height;\n\n      if (ignoreDimensions && widthStyle.hasValue() && heightStyle.hasValue()) {\n        cWidth = widthStyle.getPixels('x');\n        cHeight = heightStyle.getPixels('y');\n      }\n\n      viewPort.setCurrent(cWidth, cHeight);\n\n      if (typeof offsetX === 'number') {\n        element.getAttribute('x', true).setValue(offsetX);\n      }\n\n      if (typeof offsetY === 'number') {\n        element.getAttribute('y', true).setValue(offsetY);\n      }\n\n      if (typeof scaleWidth === 'number' || typeof scaleHeight === 'number') {\n        var viewBox = toNumbers(element.getAttribute('viewBox').getString());\n        var xRatio = 0;\n        var yRatio = 0;\n\n        if (typeof scaleWidth === 'number') {\n          var _widthStyle = element.getStyle('width');\n\n          if (_widthStyle.hasValue()) {\n            xRatio = _widthStyle.getPixels('x') / scaleWidth;\n          } else if (!isNaN(viewBox[2])) {\n            xRatio = viewBox[2] / scaleWidth;\n          }\n        }\n\n        if (typeof scaleHeight === 'number') {\n          var _heightStyle = element.getStyle('height');\n\n          if (_heightStyle.hasValue()) {\n            yRatio = _heightStyle.getPixels('y') / scaleHeight;\n          } else if (!isNaN(viewBox[3])) {\n            yRatio = viewBox[3] / scaleHeight;\n          }\n        }\n\n        if (!xRatio) {\n          xRatio = yRatio;\n        }\n\n        if (!yRatio) {\n          yRatio = xRatio;\n        }\n\n        element.getAttribute('width', true).setValue(scaleWidth);\n        element.getAttribute('height', true).setValue(scaleHeight);\n        var transformStyle = element.getStyle('transform', true, true);\n        transformStyle.setValue(\"\".concat(transformStyle.getString(), \" scale(\").concat(1.0 / xRatio, \", \").concat(1.0 / yRatio, \")\"));\n      } // clear and render\n\n\n      if (!ignoreClear) {\n        ctx.clearRect(0, 0, cWidth, cHeight);\n      }\n\n      element.render(ctx);\n\n      if (isFirstRender) {\n        this.isFirstRender = false;\n      }\n    }\n  }]);\n\n  return Screen;\n}();\n\nScreen.defaultWindow = defaultWindow;\nScreen.defaultFetch = defaultFetch$1;\nvar defaultFetch = Screen.defaultFetch;\nvar DefaultDOMParser = typeof DOMParser !== 'undefined' ? DOMParser : null;\n\nvar Parser = /*#__PURE__*/function () {\n  function Parser() {\n    _classCallCheck(this, Parser);\n\n    var _ref9 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref9$fetch = _ref9.fetch,\n        fetch = _ref9$fetch === void 0 ? defaultFetch : _ref9$fetch,\n        _ref9$DOMParser = _ref9.DOMParser,\n        DOMParser = _ref9$DOMParser === void 0 ? DefaultDOMParser : _ref9$DOMParser;\n\n    this.fetch = fetch;\n    this.DOMParser = DOMParser;\n  }\n\n  _createClass(Parser, [{\n    key: \"parse\",\n    value: function parse(resource) {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!resource.startsWith('<')) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this.parseFromString(resource));\n\n              case 2:\n                return _context2.abrupt(\"return\", _this.load(resource));\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }))();\n    }\n  }, {\n    key: \"parseFromString\",\n    value: function parseFromString(xml) {\n      var parser = new this.DOMParser();\n\n      try {\n        return this.checkDocument(parser.parseFromString(xml, 'image/svg+xml'));\n      } catch (err) {\n        return this.checkDocument(parser.parseFromString(xml, 'text/xml'));\n      }\n    }\n  }, {\n    key: \"checkDocument\",\n    value: function checkDocument(document) {\n      var parserError = document.getElementsByTagName('parsererror')[0];\n\n      if (parserError) {\n        throw new Error(parserError.textContent);\n      }\n\n      return document;\n    }\n  }, {\n    key: \"load\",\n    value: function load(url) {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var response, xml;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return _this2.fetch(url);\n\n              case 2:\n                response = _context3.sent;\n                _context3.next = 5;\n                return response.text();\n\n              case 5:\n                xml = _context3.sent;\n                return _context3.abrupt(\"return\", _this2.parseFromString(xml));\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }))();\n    }\n  }]);\n\n  return Parser;\n}();\n\nvar Translate = /*#__PURE__*/function () {\n  function Translate(_, point) {\n    _classCallCheck(this, Translate);\n\n    this.type = 'translate';\n    this.point = null;\n    this.point = Point.parse(point);\n  }\n\n  _createClass(Translate, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var _this$point = this.point,\n          x = _this$point.x,\n          y = _this$point.y;\n      ctx.translate(x || 0.0, y || 0.0);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var _this$point2 = this.point,\n          x = _this$point2.x,\n          y = _this$point2.y;\n      ctx.translate(-1.0 * x || 0.0, -1.0 * y || 0.0);\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var _this$point3 = this.point,\n          x = _this$point3.x,\n          y = _this$point3.y;\n      point.applyTransform([1, 0, 0, 1, x || 0.0, y || 0.0]);\n    }\n  }]);\n\n  return Translate;\n}();\n\nvar Rotate = /*#__PURE__*/function () {\n  function Rotate(document, rotate, transformOrigin) {\n    _classCallCheck(this, Rotate);\n\n    this.type = 'rotate';\n    this.angle = null;\n    this.originX = null;\n    this.originY = null;\n    this.cx = 0;\n    this.cy = 0;\n    var numbers = toNumbers(rotate);\n    this.angle = new Property(document, 'angle', numbers[0]);\n    this.originX = transformOrigin[0];\n    this.originY = transformOrigin[1];\n    this.cx = numbers[1] || 0;\n    this.cy = numbers[2] || 0;\n  }\n\n  _createClass(Rotate, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var cx = this.cx,\n          cy = this.cy,\n          originX = this.originX,\n          originY = this.originY,\n          angle = this.angle;\n      var tx = cx + originX.getPixels('x');\n      var ty = cy + originY.getPixels('y');\n      ctx.translate(tx, ty);\n      ctx.rotate(angle.getRadians());\n      ctx.translate(-tx, -ty);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var cx = this.cx,\n          cy = this.cy,\n          originX = this.originX,\n          originY = this.originY,\n          angle = this.angle;\n      var tx = cx + originX.getPixels('x');\n      var ty = cy + originY.getPixels('y');\n      ctx.translate(tx, ty);\n      ctx.rotate(-1.0 * angle.getRadians());\n      ctx.translate(-tx, -ty);\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var cx = this.cx,\n          cy = this.cy,\n          angle = this.angle;\n      var rad = angle.getRadians();\n      point.applyTransform([1, 0, 0, 1, cx || 0.0, cy || 0.0 // this.p.y\n      ]);\n      point.applyTransform([Math.cos(rad), Math.sin(rad), -Math.sin(rad), Math.cos(rad), 0, 0]);\n      point.applyTransform([1, 0, 0, 1, -cx || 0.0, -cy || 0.0 // -this.p.y\n      ]);\n    }\n  }]);\n\n  return Rotate;\n}();\n\nvar Scale = /*#__PURE__*/function () {\n  function Scale(_, scale, transformOrigin) {\n    _classCallCheck(this, Scale);\n\n    this.type = 'scale';\n    this.scale = null;\n    this.originX = null;\n    this.originY = null;\n    var scaleSize = Point.parseScale(scale); // Workaround for node-canvas\n\n    if (scaleSize.x === 0 || scaleSize.y === 0) {\n      scaleSize.x = PSEUDO_ZERO;\n      scaleSize.y = PSEUDO_ZERO;\n    }\n\n    this.scale = scaleSize;\n    this.originX = transformOrigin[0];\n    this.originY = transformOrigin[1];\n  }\n\n  _createClass(Scale, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var _this$scale = this.scale,\n          x = _this$scale.x,\n          y = _this$scale.y,\n          originX = this.originX,\n          originY = this.originY;\n      var tx = originX.getPixels('x');\n      var ty = originY.getPixels('y');\n      ctx.translate(tx, ty);\n      ctx.scale(x, y || x);\n      ctx.translate(-tx, -ty);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var _this$scale2 = this.scale,\n          x = _this$scale2.x,\n          y = _this$scale2.y,\n          originX = this.originX,\n          originY = this.originY;\n      var tx = originX.getPixels('x');\n      var ty = originY.getPixels('y');\n      ctx.translate(tx, ty);\n      ctx.scale(1.0 / x, 1.0 / y || x);\n      ctx.translate(-tx, -ty);\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var _this$scale3 = this.scale,\n          x = _this$scale3.x,\n          y = _this$scale3.y;\n      point.applyTransform([x || 0.0, 0, 0, y || 0.0, 0, 0]);\n    }\n  }]);\n\n  return Scale;\n}();\n\nvar Matrix = /*#__PURE__*/function () {\n  function Matrix(_, matrix, transformOrigin) {\n    _classCallCheck(this, Matrix);\n\n    this.type = 'matrix';\n    this.matrix = [];\n    this.originX = null;\n    this.originY = null;\n    this.matrix = toNumbers(matrix);\n    this.originX = transformOrigin[0];\n    this.originY = transformOrigin[1];\n  }\n\n  _createClass(Matrix, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var originX = this.originX,\n          originY = this.originY,\n          matrix = this.matrix;\n      var tx = originX.getPixels('x');\n      var ty = originY.getPixels('y');\n      ctx.translate(tx, ty);\n      ctx.transform(matrix[0], matrix[1], matrix[2], matrix[3], matrix[4], matrix[5]);\n      ctx.translate(-tx, -ty);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var originX = this.originX,\n          originY = this.originY,\n          matrix = this.matrix;\n      var a = matrix[0];\n      var b = matrix[2];\n      var c = matrix[4];\n      var d = matrix[1];\n      var e = matrix[3];\n      var f = matrix[5];\n      var g = 0.0;\n      var h = 0.0;\n      var i = 1.0;\n      var det = 1 / (a * (e * i - f * h) - b * (d * i - f * g) + c * (d * h - e * g));\n      var tx = originX.getPixels('x');\n      var ty = originY.getPixels('y');\n      ctx.translate(tx, ty);\n      ctx.transform(det * (e * i - f * h), det * (f * g - d * i), det * (c * h - b * i), det * (a * i - c * g), det * (b * f - c * e), det * (c * d - a * f));\n      ctx.translate(-tx, -ty);\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      point.applyTransform(this.matrix);\n    }\n  }]);\n\n  return Matrix;\n}();\n\nvar Skew = /*#__PURE__*/function (_Matrix) {\n  _inherits(Skew, _Matrix);\n\n  var _super = _createSuper(Skew);\n\n  function Skew(document, skew, transformOrigin) {\n    var _this4;\n\n    _classCallCheck(this, Skew);\n\n    _this4 = _super.call(this, document, skew, transformOrigin);\n    _this4.type = 'skew';\n    _this4.angle = null;\n    _this4.angle = new Property(document, 'angle', skew);\n    return _this4;\n  }\n\n  return Skew;\n}(Matrix);\n\nvar SkewX = /*#__PURE__*/function (_Skew) {\n  _inherits(SkewX, _Skew);\n\n  var _super2 = _createSuper(SkewX);\n\n  function SkewX(document, skew, transformOrigin) {\n    var _this5;\n\n    _classCallCheck(this, SkewX);\n\n    _this5 = _super2.call(this, document, skew, transformOrigin);\n    _this5.type = 'skewX';\n    _this5.matrix = [1, 0, Math.tan(_this5.angle.getRadians()), 1, 0, 0];\n    return _this5;\n  }\n\n  return SkewX;\n}(Skew);\n\nvar SkewY = /*#__PURE__*/function (_Skew2) {\n  _inherits(SkewY, _Skew2);\n\n  var _super3 = _createSuper(SkewY);\n\n  function SkewY(document, skew, transformOrigin) {\n    var _this6;\n\n    _classCallCheck(this, SkewY);\n\n    _this6 = _super3.call(this, document, skew, transformOrigin);\n    _this6.type = 'skewY';\n    _this6.matrix = [1, Math.tan(_this6.angle.getRadians()), 0, 1, 0, 0];\n    return _this6;\n  }\n\n  return SkewY;\n}(Skew);\n\nfunction parseTransforms(transform) {\n  return compressSpaces(transform).trim().replace(/\\)([a-zA-Z])/g, ') $1').replace(/\\)(\\s?,\\s?)/g, ') ').split(/\\s(?=[a-z])/);\n}\n\nfunction parseTransform(transform) {\n  var _transform$split = transform.split('('),\n      _transform$split2 = _slicedToArray(_transform$split, 2),\n      type = _transform$split2[0],\n      value = _transform$split2[1];\n\n  return [type.trim(), value.trim().replace(')', '')];\n}\n\nvar Transform = /*#__PURE__*/function () {\n  function Transform(document, transform, transformOrigin) {\n    var _this7 = this;\n\n    _classCallCheck(this, Transform);\n\n    this.document = document;\n    this.transforms = [];\n    var data = parseTransforms(transform);\n    data.forEach(function (transform) {\n      if (transform === 'none') {\n        return;\n      }\n\n      var _parseTransform = parseTransform(transform),\n          _parseTransform2 = _slicedToArray(_parseTransform, 2),\n          type = _parseTransform2[0],\n          value = _parseTransform2[1];\n\n      var TransformType = Transform.transformTypes[type];\n\n      if (typeof TransformType !== 'undefined') {\n        _this7.transforms.push(new TransformType(_this7.document, value, transformOrigin));\n      }\n    });\n  }\n\n  _createClass(Transform, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var transforms = this.transforms;\n      var len = transforms.length;\n\n      for (var i = 0; i < len; i++) {\n        transforms[i].apply(ctx);\n      }\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var transforms = this.transforms;\n      var len = transforms.length;\n\n      for (var i = len - 1; i >= 0; i--) {\n        transforms[i].unapply(ctx);\n      }\n    } // TODO: applyToPoint unused ... remove?\n\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var transforms = this.transforms;\n      var len = transforms.length;\n\n      for (var i = 0; i < len; i++) {\n        transforms[i].applyToPoint(point);\n      }\n    }\n  }], [{\n    key: \"fromElement\",\n    value: function fromElement(document, element) {\n      var transformStyle = element.getStyle('transform', false, true);\n\n      var _element$getStyle$spl = element.getStyle('transform-origin', false, true).split(),\n          _element$getStyle$spl2 = _slicedToArray(_element$getStyle$spl, 2),\n          transformOriginXProperty = _element$getStyle$spl2[0],\n          _element$getStyle$spl3 = _element$getStyle$spl2[1],\n          transformOriginYProperty = _element$getStyle$spl3 === void 0 ? transformOriginXProperty : _element$getStyle$spl3;\n\n      var transformOrigin = [transformOriginXProperty, transformOriginYProperty];\n\n      if (transformStyle.hasValue()) {\n        return new Transform(document, transformStyle.getString(), transformOrigin);\n      }\n\n      return null;\n    }\n  }]);\n\n  return Transform;\n}();\n\nTransform.transformTypes = {\n  translate: Translate,\n  rotate: Rotate,\n  scale: Scale,\n  matrix: Matrix,\n  skewX: SkewX,\n  skewY: SkewY\n};\n\nvar Element = /*#__PURE__*/function () {\n  function Element(document, node) {\n    var _this8 = this;\n\n    _classCallCheck(this, Element);\n\n    var captureTextNodes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.document = document;\n    this.node = node;\n    this.captureTextNodes = captureTextNodes;\n    this.attributes = {};\n    this.styles = {};\n    this.stylesSpecificity = {};\n    this.animationFrozen = false;\n    this.animationFrozenValue = '';\n    this.parent = null;\n    this.children = [];\n\n    if (!node || node.nodeType !== 1) {\n      // ELEMENT_NODE\n      return;\n    } // add attributes\n\n\n    Array.from(node.attributes).forEach(function (attribute) {\n      var nodeName = normalizeAttributeName(attribute.nodeName);\n      _this8.attributes[nodeName] = new Property(document, nodeName, attribute.value);\n    });\n    this.addStylesFromStyleDefinition(); // add inline styles\n\n    if (this.getAttribute('style').hasValue()) {\n      var styles = this.getAttribute('style').getString().split(';').map(function (_) {\n        return _.trim();\n      });\n      styles.forEach(function (style) {\n        if (!style) {\n          return;\n        }\n\n        var _style$split$map = style.split(':').map(function (_) {\n          return _.trim();\n        }),\n            _style$split$map2 = _slicedToArray(_style$split$map, 2),\n            name = _style$split$map2[0],\n            value = _style$split$map2[1];\n\n        _this8.styles[name] = new Property(document, name, value);\n      });\n    }\n\n    var definitions = document.definitions;\n    var id = this.getAttribute('id'); // add id\n\n    if (id.hasValue()) {\n      if (!definitions[id.getString()]) {\n        definitions[id.getString()] = this;\n      }\n    }\n\n    Array.from(node.childNodes).forEach(function (childNode) {\n      if (childNode.nodeType === 1) {\n        _this8.addChild(childNode); // ELEMENT_NODE\n\n      } else if (captureTextNodes && (childNode.nodeType === 3 || childNode.nodeType === 4)) {\n        var textNode = document.createTextNode(childNode);\n\n        if (textNode.getText().length > 0) {\n          _this8.addChild(textNode); // TEXT_NODE\n\n        }\n      }\n    });\n  }\n\n  _createClass(Element, [{\n    key: \"getAttribute\",\n    value: function getAttribute(name) {\n      var createIfNotExists = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var attr = this.attributes[name];\n\n      if (!attr && createIfNotExists) {\n        var _attr = new Property(this.document, name, '');\n\n        this.attributes[name] = _attr;\n        return _attr;\n      }\n\n      return attr || Property.empty(this.document);\n    }\n  }, {\n    key: \"getHrefAttribute\",\n    value: function getHrefAttribute() {\n      for (var key in this.attributes) {\n        if (key === 'href' || key.endsWith(':href')) {\n          return this.attributes[key];\n        }\n      }\n\n      return Property.empty(this.document);\n    }\n  }, {\n    key: \"getStyle\",\n    value: function getStyle(name) {\n      var createIfNotExists = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var skipAncestors = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var style = this.styles[name];\n\n      if (style) {\n        return style;\n      }\n\n      var attr = this.getAttribute(name);\n\n      if (attr !== null && attr !== void 0 && attr.hasValue()) {\n        this.styles[name] = attr; // move up to me to cache\n\n        return attr;\n      }\n\n      if (!skipAncestors) {\n        var parent = this.parent;\n\n        if (parent) {\n          var parentStyle = parent.getStyle(name);\n\n          if (parentStyle !== null && parentStyle !== void 0 && parentStyle.hasValue()) {\n            return parentStyle;\n          }\n        }\n      }\n\n      if (createIfNotExists) {\n        var _style = new Property(this.document, name, '');\n\n        this.styles[name] = _style;\n        return _style;\n      }\n\n      return style || Property.empty(this.document);\n    }\n  }, {\n    key: \"render\",\n    value: function render(ctx) {\n      // don't render display=none\n      // don't render visibility=hidden\n      if (this.getStyle('display').getString() === 'none' || this.getStyle('visibility').getString() === 'hidden') {\n        return;\n      }\n\n      ctx.save();\n\n      if (this.getStyle('mask').hasValue()) {\n        // mask\n        var mask = this.getStyle('mask').getDefinition();\n\n        if (mask) {\n          this.applyEffects(ctx);\n          mask.apply(ctx, this);\n        }\n      } else if (this.getStyle('filter').getValue('none') !== 'none') {\n        // filter\n        var filter = this.getStyle('filter').getDefinition();\n\n        if (filter) {\n          this.applyEffects(ctx);\n          filter.apply(ctx, this);\n        }\n      } else {\n        this.setContext(ctx);\n        this.renderChildren(ctx);\n        this.clearContext(ctx);\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: \"setContext\",\n    value: function setContext(_) {// NO RENDER\n    }\n  }, {\n    key: \"applyEffects\",\n    value: function applyEffects(ctx) {\n      // transform\n      var transform = Transform.fromElement(this.document, this);\n\n      if (transform) {\n        transform.apply(ctx);\n      } // clip\n\n\n      var clipPathStyleProp = this.getStyle('clip-path', false, true);\n\n      if (clipPathStyleProp.hasValue()) {\n        var clip = clipPathStyleProp.getDefinition();\n\n        if (clip) {\n          clip.apply(ctx);\n        }\n      }\n    }\n  }, {\n    key: \"clearContext\",\n    value: function clearContext(_) {// NO RENDER\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      this.children.forEach(function (child) {\n        child.render(ctx);\n      });\n    }\n  }, {\n    key: \"addChild\",\n    value: function addChild(childNode) {\n      var child = childNode instanceof Element ? childNode : this.document.createElement(childNode);\n      child.parent = this;\n\n      if (!Element.ignoreChildTypes.includes(child.type)) {\n        this.children.push(child);\n      }\n    }\n  }, {\n    key: \"matchesSelector\",\n    value: function matchesSelector(selector) {\n      var node = this.node;\n\n      if (typeof node.matches === 'function') {\n        return node.matches(selector);\n      }\n\n      var styleClasses = node.getAttribute('class');\n\n      if (!styleClasses || styleClasses === '') {\n        return false;\n      }\n\n      return styleClasses.split(' ').some(function (styleClass) {\n        return \".\".concat(styleClass) === selector;\n      });\n    }\n  }, {\n    key: \"addStylesFromStyleDefinition\",\n    value: function addStylesFromStyleDefinition() {\n      var _this$document = this.document,\n          styles = _this$document.styles,\n          stylesSpecificity = _this$document.stylesSpecificity;\n\n      for (var selector in styles) {\n        if (!selector.startsWith('@') && this.matchesSelector(selector)) {\n          var style = styles[selector];\n          var specificity = stylesSpecificity[selector];\n\n          if (style) {\n            for (var name in style) {\n              var existingSpecificity = this.stylesSpecificity[name];\n\n              if (typeof existingSpecificity === 'undefined') {\n                existingSpecificity = '000';\n              }\n\n              if (specificity >= existingSpecificity) {\n                this.styles[name] = style[name];\n                this.stylesSpecificity[name] = specificity;\n              }\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"removeStyles\",\n    value: function removeStyles(element, ignoreStyles) {\n      var toRestore = ignoreStyles.reduce(function (toRestore, name) {\n        var styleProp = element.getStyle(name);\n\n        if (!styleProp.hasValue()) {\n          return toRestore;\n        }\n\n        var value = styleProp.getString();\n        styleProp.setValue('');\n        return [].concat(_toConsumableArray(toRestore), [[name, value]]);\n      }, []);\n      return toRestore;\n    }\n  }, {\n    key: \"restoreStyles\",\n    value: function restoreStyles(element, styles) {\n      styles.forEach(function (_ref) {\n        var _ref10 = _slicedToArray(_ref, 2),\n            name = _ref10[0],\n            value = _ref10[1];\n\n        element.getStyle(name, true).setValue(value);\n      });\n    }\n  }]);\n\n  return Element;\n}();\n\nElement.ignoreChildTypes = ['title'];\n\nvar UnknownElement = /*#__PURE__*/function (_Element) {\n  _inherits(UnknownElement, _Element);\n\n  var _super4 = _createSuper(UnknownElement);\n\n  function UnknownElement(document, node, captureTextNodes) {\n    _classCallCheck(this, UnknownElement);\n\n    return _super4.call(this, document, node, captureTextNodes);\n  }\n\n  return UnknownElement;\n}(Element);\n\nfunction wrapFontFamily(fontFamily) {\n  var trimmed = fontFamily.trim();\n  return /^('|\")/.test(trimmed) ? trimmed : \"\\\"\".concat(trimmed, \"\\\"\");\n}\n\nfunction prepareFontFamily(fontFamily) {\n  return typeof process === 'undefined' ? fontFamily : fontFamily.trim().split(',').map(wrapFontFamily).join(',');\n}\n/**\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-style\r\n * @param fontStyle\r\n * @returns CSS font style.\r\n */\n\n\nfunction prepareFontStyle(fontStyle) {\n  if (!fontStyle) {\n    return '';\n  }\n\n  var targetFontStyle = fontStyle.trim().toLowerCase();\n\n  switch (targetFontStyle) {\n    case 'normal':\n    case 'italic':\n    case 'oblique':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontStyle;\n\n    default:\n      if (/^oblique\\s+(-|)\\d+deg$/.test(targetFontStyle)) {\n        return targetFontStyle;\n      }\n\n      return '';\n  }\n}\n/**\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\r\n * @param fontWeight\r\n * @returns CSS font weight.\r\n */\n\n\nfunction prepareFontWeight(fontWeight) {\n  if (!fontWeight) {\n    return '';\n  }\n\n  var targetFontWeight = fontWeight.trim().toLowerCase();\n\n  switch (targetFontWeight) {\n    case 'normal':\n    case 'bold':\n    case 'lighter':\n    case 'bolder':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontWeight;\n\n    default:\n      if (/^[\\d.]+$/.test(targetFontWeight)) {\n        return targetFontWeight;\n      }\n\n      return '';\n  }\n}\n\nvar Font = /*#__PURE__*/function () {\n  function Font(fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit) {\n    _classCallCheck(this, Font);\n\n    var inheritFont = inherit ? typeof inherit === 'string' ? Font.parse(inherit) : inherit : {};\n    this.fontFamily = fontFamily || inheritFont.fontFamily;\n    this.fontSize = fontSize || inheritFont.fontSize;\n    this.fontStyle = fontStyle || inheritFont.fontStyle;\n    this.fontWeight = fontWeight || inheritFont.fontWeight;\n    this.fontVariant = fontVariant || inheritFont.fontVariant;\n  }\n\n  _createClass(Font, [{\n    key: \"toString\",\n    value: function toString() {\n      return [prepareFontStyle(this.fontStyle), this.fontVariant, prepareFontWeight(this.fontWeight), this.fontSize, // Wrap fontFamily only on nodejs and only for canvas.ctx\n      prepareFontFamily(this.fontFamily)].join(' ').trim();\n    }\n  }], [{\n    key: \"parse\",\n    value: function parse() {\n      var font = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var inherit = arguments.length > 1 ? arguments[1] : undefined;\n      var fontStyle = '';\n      var fontVariant = '';\n      var fontWeight = '';\n      var fontSize = '';\n      var fontFamily = '';\n      var parts = compressSpaces(font).trim().split(' ');\n      var set = {\n        fontSize: false,\n        fontStyle: false,\n        fontWeight: false,\n        fontVariant: false\n      };\n      parts.forEach(function (part) {\n        switch (true) {\n          case !set.fontStyle && Font.styles.includes(part):\n            if (part !== 'inherit') {\n              fontStyle = part;\n            }\n\n            set.fontStyle = true;\n            break;\n\n          case !set.fontVariant && Font.variants.includes(part):\n            if (part !== 'inherit') {\n              fontVariant = part;\n            }\n\n            set.fontStyle = true;\n            set.fontVariant = true;\n            break;\n\n          case !set.fontWeight && Font.weights.includes(part):\n            if (part !== 'inherit') {\n              fontWeight = part;\n            }\n\n            set.fontStyle = true;\n            set.fontVariant = true;\n            set.fontWeight = true;\n            break;\n\n          case !set.fontSize:\n            if (part !== 'inherit') {\n              var _part$split = part.split('/');\n\n              var _part$split2 = _slicedToArray(_part$split, 1);\n\n              fontSize = _part$split2[0];\n            }\n\n            set.fontStyle = true;\n            set.fontVariant = true;\n            set.fontWeight = true;\n            set.fontSize = true;\n            break;\n\n          default:\n            if (part !== 'inherit') {\n              fontFamily += part;\n            }\n\n        }\n      });\n      return new Font(fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit);\n    }\n  }]);\n\n  return Font;\n}();\n\nFont.styles = 'normal|italic|oblique|inherit';\nFont.variants = 'normal|small-caps|inherit';\nFont.weights = 'normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit';\n\nvar BoundingBox = /*#__PURE__*/function () {\n  function BoundingBox() {\n    _classCallCheck(this, BoundingBox);\n\n    var x1 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Number.NaN;\n    var y1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Number.NaN;\n    var x2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : Number.NaN;\n    var y2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Number.NaN;\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n    this.addPoint(x1, y1);\n    this.addPoint(x2, y2);\n  }\n\n  _createClass(BoundingBox, [{\n    key: \"x\",\n    get: function get() {\n      return this.x1;\n    }\n  }, {\n    key: \"y\",\n    get: function get() {\n      return this.y1;\n    }\n  }, {\n    key: \"width\",\n    get: function get() {\n      return this.x2 - this.x1;\n    }\n  }, {\n    key: \"height\",\n    get: function get() {\n      return this.y2 - this.y1;\n    }\n  }, {\n    key: \"addPoint\",\n    value: function addPoint(x, y) {\n      if (typeof x !== 'undefined') {\n        if (isNaN(this.x1) || isNaN(this.x2)) {\n          this.x1 = x;\n          this.x2 = x;\n        }\n\n        if (x < this.x1) {\n          this.x1 = x;\n        }\n\n        if (x > this.x2) {\n          this.x2 = x;\n        }\n      }\n\n      if (typeof y !== 'undefined') {\n        if (isNaN(this.y1) || isNaN(this.y2)) {\n          this.y1 = y;\n          this.y2 = y;\n        }\n\n        if (y < this.y1) {\n          this.y1 = y;\n        }\n\n        if (y > this.y2) {\n          this.y2 = y;\n        }\n      }\n    }\n  }, {\n    key: \"addX\",\n    value: function addX(x) {\n      this.addPoint(x, null);\n    }\n  }, {\n    key: \"addY\",\n    value: function addY(y) {\n      this.addPoint(null, y);\n    }\n  }, {\n    key: \"addBoundingBox\",\n    value: function addBoundingBox(boundingBox) {\n      if (!boundingBox) {\n        return;\n      }\n\n      var x1 = boundingBox.x1,\n          y1 = boundingBox.y1,\n          x2 = boundingBox.x2,\n          y2 = boundingBox.y2;\n      this.addPoint(x1, y1);\n      this.addPoint(x2, y2);\n    }\n  }, {\n    key: \"sumCubic\",\n    value: function sumCubic(t, p0, p1, p2, p3) {\n      return Math.pow(1 - t, 3) * p0 + 3 * Math.pow(1 - t, 2) * t * p1 + 3 * (1 - t) * Math.pow(t, 2) * p2 + Math.pow(t, 3) * p3;\n    }\n  }, {\n    key: \"bezierCurveAdd\",\n    value: function bezierCurveAdd(forX, p0, p1, p2, p3) {\n      var b = 6 * p0 - 12 * p1 + 6 * p2;\n      var a = -3 * p0 + 9 * p1 - 9 * p2 + 3 * p3;\n      var c = 3 * p1 - 3 * p0;\n\n      if (a === 0) {\n        if (b === 0) {\n          return;\n        }\n\n        var t = -c / b;\n\n        if (0 < t && t < 1) {\n          if (forX) {\n            this.addX(this.sumCubic(t, p0, p1, p2, p3));\n          } else {\n            this.addY(this.sumCubic(t, p0, p1, p2, p3));\n          }\n        }\n\n        return;\n      }\n\n      var b2ac = Math.pow(b, 2) - 4 * c * a;\n\n      if (b2ac < 0) {\n        return;\n      }\n\n      var t1 = (-b + Math.sqrt(b2ac)) / (2 * a);\n\n      if (0 < t1 && t1 < 1) {\n        if (forX) {\n          this.addX(this.sumCubic(t1, p0, p1, p2, p3));\n        } else {\n          this.addY(this.sumCubic(t1, p0, p1, p2, p3));\n        }\n      }\n\n      var t2 = (-b - Math.sqrt(b2ac)) / (2 * a);\n\n      if (0 < t2 && t2 < 1) {\n        if (forX) {\n          this.addX(this.sumCubic(t2, p0, p1, p2, p3));\n        } else {\n          this.addY(this.sumCubic(t2, p0, p1, p2, p3));\n        }\n      }\n    } // from http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html\n\n  }, {\n    key: \"addBezierCurve\",\n    value: function addBezierCurve(p0x, p0y, p1x, p1y, p2x, p2y, p3x, p3y) {\n      this.addPoint(p0x, p0y);\n      this.addPoint(p3x, p3y);\n      this.bezierCurveAdd(true, p0x, p1x, p2x, p3x);\n      this.bezierCurveAdd(false, p0y, p1y, p2y, p3y);\n    }\n  }, {\n    key: \"addQuadraticCurve\",\n    value: function addQuadraticCurve(p0x, p0y, p1x, p1y, p2x, p2y) {\n      var cp1x = p0x + 2 / 3 * (p1x - p0x); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\n      var cp1y = p0y + 2 / 3 * (p1y - p0y); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\n      var cp2x = cp1x + 1 / 3 * (p2x - p0x); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\n      var cp2y = cp1y + 1 / 3 * (p2y - p0y); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\n      this.addBezierCurve(p0x, p0y, cp1x, cp2x, cp1y, cp2y, p2x, p2y);\n    }\n  }, {\n    key: \"isPointInBox\",\n    value: function isPointInBox(x, y) {\n      var x1 = this.x1,\n          y1 = this.y1,\n          x2 = this.x2,\n          y2 = this.y2;\n      return x1 <= x && x <= x2 && y1 <= y && y <= y2;\n    }\n  }]);\n\n  return BoundingBox;\n}();\n\nvar PathParser = /*#__PURE__*/function (_SVGPathData) {\n  _inherits(PathParser, _SVGPathData);\n\n  var _super5 = _createSuper(PathParser);\n\n  function PathParser(path) {\n    var _this9;\n\n    _classCallCheck(this, PathParser);\n\n    _this9 = _super5.call(this, path // Fix spaces after signs.\n    .replace(/([+\\-.])\\s+/gm, '$1') // Remove invalid part.\n    .replace(/[^MmZzLlHhVvCcSsQqTtAae\\d\\s.,+-].*/g, ''));\n    _this9.control = null;\n    _this9.start = null;\n    _this9.current = null;\n    _this9.command = null;\n    _this9.commands = _this9.commands;\n    _this9.i = -1;\n    _this9.previousCommand = null;\n    _this9.points = [];\n    _this9.angles = [];\n    return _this9;\n  }\n\n  _createClass(PathParser, [{\n    key: \"reset\",\n    value: function reset() {\n      this.i = -1;\n      this.command = null;\n      this.previousCommand = null;\n      this.start = new Point(0, 0);\n      this.control = new Point(0, 0);\n      this.current = new Point(0, 0);\n      this.points = [];\n      this.angles = [];\n    }\n  }, {\n    key: \"isEnd\",\n    value: function isEnd() {\n      var i = this.i,\n          commands = this.commands;\n      return i >= commands.length - 1;\n    }\n  }, {\n    key: \"next\",\n    value: function next() {\n      var command = this.commands[++this.i];\n      this.previousCommand = this.command;\n      this.command = command;\n      return command;\n    }\n  }, {\n    key: \"getPoint\",\n    value: function getPoint() {\n      var xProp = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'x';\n      var yProp = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'y';\n      var point = new Point(this.command[xProp], this.command[yProp]);\n      return this.makeAbsolute(point);\n    }\n  }, {\n    key: \"getAsControlPoint\",\n    value: function getAsControlPoint(xProp, yProp) {\n      var point = this.getPoint(xProp, yProp);\n      this.control = point;\n      return point;\n    }\n  }, {\n    key: \"getAsCurrentPoint\",\n    value: function getAsCurrentPoint(xProp, yProp) {\n      var point = this.getPoint(xProp, yProp);\n      this.current = point;\n      return point;\n    }\n  }, {\n    key: \"getReflectedControlPoint\",\n    value: function getReflectedControlPoint() {\n      var previousCommand = this.previousCommand.type;\n\n      if (previousCommand !== SVGPathData.CURVE_TO && previousCommand !== SVGPathData.SMOOTH_CURVE_TO && previousCommand !== SVGPathData.QUAD_TO && previousCommand !== SVGPathData.SMOOTH_QUAD_TO) {\n        return this.current;\n      } // reflect point\n\n\n      var _this$current = this.current,\n          cx = _this$current.x,\n          cy = _this$current.y,\n          _this$control = this.control,\n          ox = _this$control.x,\n          oy = _this$control.y;\n      var point = new Point(2 * cx - ox, 2 * cy - oy);\n      return point;\n    }\n  }, {\n    key: \"makeAbsolute\",\n    value: function makeAbsolute(point) {\n      if (this.command.relative) {\n        var _this$current2 = this.current,\n            x = _this$current2.x,\n            y = _this$current2.y;\n        point.x += x;\n        point.y += y;\n      }\n\n      return point;\n    }\n  }, {\n    key: \"addMarker\",\n    value: function addMarker(point, from, priorTo) {\n      var points = this.points,\n          angles = this.angles; // if the last angle isn't filled in because we didn't have this point yet ...\n\n      if (priorTo && angles.length > 0 && !angles[angles.length - 1]) {\n        angles[angles.length - 1] = points[points.length - 1].angleTo(priorTo);\n      }\n\n      this.addMarkerAngle(point, from ? from.angleTo(point) : null);\n    }\n  }, {\n    key: \"addMarkerAngle\",\n    value: function addMarkerAngle(point, angle) {\n      this.points.push(point);\n      this.angles.push(angle);\n    }\n  }, {\n    key: \"getMarkerPoints\",\n    value: function getMarkerPoints() {\n      return this.points;\n    }\n  }, {\n    key: \"getMarkerAngles\",\n    value: function getMarkerAngles() {\n      var angles = this.angles;\n      var len = angles.length;\n\n      for (var i = 0; i < len; i++) {\n        if (!angles[i]) {\n          for (var j = i + 1; j < len; j++) {\n            if (angles[j]) {\n              angles[i] = angles[j];\n              break;\n            }\n          }\n        }\n      }\n\n      return angles;\n    }\n  }]);\n\n  return PathParser;\n}(SVGPathData);\n\nvar RenderedElement = /*#__PURE__*/function (_Element2) {\n  _inherits(RenderedElement, _Element2);\n\n  var _super6 = _createSuper(RenderedElement);\n\n  function RenderedElement() {\n    var _this10;\n\n    _classCallCheck(this, RenderedElement);\n\n    _this10 = _super6.apply(this, arguments);\n    _this10.modifiedEmSizeStack = false;\n    return _this10;\n  }\n\n  _createClass(RenderedElement, [{\n    key: \"calculateOpacity\",\n    value: function calculateOpacity() {\n      var opacity = 1.0; // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n\n      var element = this;\n\n      while (element) {\n        var opacityStyle = element.getStyle('opacity', false, true); // no ancestors on style call\n\n        if (opacityStyle.hasValue(true)) {\n          opacity *= opacityStyle.getNumber();\n        }\n\n        element = element.parent;\n      }\n\n      return opacity;\n    }\n  }, {\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      var fromMeasure = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!fromMeasure) {\n        // causes stack overflow when measuring text with gradients\n        // fill\n        var fillStyleProp = this.getStyle('fill');\n        var fillOpacityStyleProp = this.getStyle('fill-opacity');\n        var strokeStyleProp = this.getStyle('stroke');\n        var strokeOpacityProp = this.getStyle('stroke-opacity');\n\n        if (fillStyleProp.isUrlDefinition()) {\n          var fillStyle = fillStyleProp.getFillStyleDefinition(this, fillOpacityStyleProp);\n\n          if (fillStyle) {\n            ctx.fillStyle = fillStyle;\n          }\n        } else if (fillStyleProp.hasValue()) {\n          if (fillStyleProp.getString() === 'currentColor') {\n            fillStyleProp.setValue(this.getStyle('color').getColor());\n          }\n\n          var _fillStyle = fillStyleProp.getColor();\n\n          if (_fillStyle !== 'inherit') {\n            ctx.fillStyle = _fillStyle === 'none' ? 'rgba(0,0,0,0)' : _fillStyle;\n          }\n        }\n\n        if (fillOpacityStyleProp.hasValue()) {\n          var _fillStyle2 = new Property(this.document, 'fill', ctx.fillStyle).addOpacity(fillOpacityStyleProp).getColor();\n\n          ctx.fillStyle = _fillStyle2;\n        } // stroke\n\n\n        if (strokeStyleProp.isUrlDefinition()) {\n          var strokeStyle = strokeStyleProp.getFillStyleDefinition(this, strokeOpacityProp);\n\n          if (strokeStyle) {\n            ctx.strokeStyle = strokeStyle;\n          }\n        } else if (strokeStyleProp.hasValue()) {\n          if (strokeStyleProp.getString() === 'currentColor') {\n            strokeStyleProp.setValue(this.getStyle('color').getColor());\n          }\n\n          var _strokeStyle = strokeStyleProp.getString();\n\n          if (_strokeStyle !== 'inherit') {\n            ctx.strokeStyle = _strokeStyle === 'none' ? 'rgba(0,0,0,0)' : _strokeStyle;\n          }\n        }\n\n        if (strokeOpacityProp.hasValue()) {\n          var _strokeStyle2 = new Property(this.document, 'stroke', ctx.strokeStyle).addOpacity(strokeOpacityProp).getString();\n\n          ctx.strokeStyle = _strokeStyle2;\n        }\n\n        var strokeWidthStyleProp = this.getStyle('stroke-width');\n\n        if (strokeWidthStyleProp.hasValue()) {\n          var newLineWidth = strokeWidthStyleProp.getPixels();\n          ctx.lineWidth = !newLineWidth ? PSEUDO_ZERO // browsers don't respect 0 (or node-canvas? :-)\n          : newLineWidth;\n        }\n\n        var strokeLinecapStyleProp = this.getStyle('stroke-linecap');\n        var strokeLinejoinStyleProp = this.getStyle('stroke-linejoin');\n        var strokeMiterlimitProp = this.getStyle('stroke-miterlimit'); // NEED TEST\n        // const pointOrderStyleProp = this.getStyle('paint-order');\n\n        var strokeDasharrayStyleProp = this.getStyle('stroke-dasharray');\n        var strokeDashoffsetProp = this.getStyle('stroke-dashoffset');\n\n        if (strokeLinecapStyleProp.hasValue()) {\n          ctx.lineCap = strokeLinecapStyleProp.getString();\n        }\n\n        if (strokeLinejoinStyleProp.hasValue()) {\n          ctx.lineJoin = strokeLinejoinStyleProp.getString();\n        }\n\n        if (strokeMiterlimitProp.hasValue()) {\n          ctx.miterLimit = strokeMiterlimitProp.getNumber();\n        } // NEED TEST\n        // if (pointOrderStyleProp.hasValue()) {\n        // \t// ?\n        // \tctx.paintOrder = pointOrderStyleProp.getValue();\n        // }\n\n\n        if (strokeDasharrayStyleProp.hasValue() && strokeDasharrayStyleProp.getString() !== 'none') {\n          var gaps = toNumbers(strokeDasharrayStyleProp.getString());\n\n          if (typeof ctx.setLineDash !== 'undefined') {\n            ctx.setLineDash(gaps);\n          } else // @ts-expect-error Handle browser prefix.\n            if (typeof ctx.webkitLineDash !== 'undefined') {\n              // @ts-expect-error Handle browser prefix.\n              ctx.webkitLineDash = gaps;\n            } else // @ts-expect-error Handle browser prefix.\n              if (typeof ctx.mozDash !== 'undefined' && !(gaps.length === 1 && gaps[0] === 0)) {\n                // @ts-expect-error Handle browser prefix.\n                ctx.mozDash = gaps;\n              }\n\n          var offset = strokeDashoffsetProp.getPixels();\n\n          if (typeof ctx.lineDashOffset !== 'undefined') {\n            ctx.lineDashOffset = offset;\n          } else // @ts-expect-error Handle browser prefix.\n            if (typeof ctx.webkitLineDashOffset !== 'undefined') {\n              // @ts-expect-error Handle browser prefix.\n              ctx.webkitLineDashOffset = offset;\n            } else // @ts-expect-error Handle browser prefix.\n              if (typeof ctx.mozDashOffset !== 'undefined') {\n                // @ts-expect-error Handle browser prefix.\n                ctx.mozDashOffset = offset;\n              }\n        }\n      } // font\n\n\n      this.modifiedEmSizeStack = false;\n\n      if (typeof ctx.font !== 'undefined') {\n        var fontStyleProp = this.getStyle('font');\n        var fontStyleStyleProp = this.getStyle('font-style');\n        var fontVariantStyleProp = this.getStyle('font-variant');\n        var fontWeightStyleProp = this.getStyle('font-weight');\n        var fontSizeStyleProp = this.getStyle('font-size');\n        var fontFamilyStyleProp = this.getStyle('font-family');\n        var font = new Font(fontStyleStyleProp.getString(), fontVariantStyleProp.getString(), fontWeightStyleProp.getString(), fontSizeStyleProp.hasValue() ? \"\".concat(fontSizeStyleProp.getPixels(true), \"px\") : '', fontFamilyStyleProp.getString(), Font.parse(fontStyleProp.getString(), ctx.font));\n        fontStyleStyleProp.setValue(font.fontStyle);\n        fontVariantStyleProp.setValue(font.fontVariant);\n        fontWeightStyleProp.setValue(font.fontWeight);\n        fontSizeStyleProp.setValue(font.fontSize);\n        fontFamilyStyleProp.setValue(font.fontFamily);\n        ctx.font = font.toString();\n\n        if (fontSizeStyleProp.isPixels()) {\n          this.document.emSize = fontSizeStyleProp.getPixels();\n          this.modifiedEmSizeStack = true;\n        }\n      }\n\n      if (!fromMeasure) {\n        // effects\n        this.applyEffects(ctx); // opacity\n\n        ctx.globalAlpha = this.calculateOpacity();\n      }\n    }\n  }, {\n    key: \"clearContext\",\n    value: function clearContext(ctx) {\n      _get(_getPrototypeOf(RenderedElement.prototype), \"clearContext\", this).call(this, ctx);\n\n      if (this.modifiedEmSizeStack) {\n        this.document.popEmSize();\n      }\n    }\n  }]);\n\n  return RenderedElement;\n}(Element);\n\nvar PathElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(PathElement, _RenderedElement);\n\n  var _super7 = _createSuper(PathElement);\n\n  function PathElement(document, node, captureTextNodes) {\n    var _this11;\n\n    _classCallCheck(this, PathElement);\n\n    _this11 = _super7.call(this, document, node, captureTextNodes);\n    _this11.type = 'path';\n    _this11.pathParser = null;\n    _this11.pathParser = new PathParser(_this11.getAttribute('d').getString());\n    return _this11;\n  }\n\n  _createClass(PathElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var pathParser = this.pathParser;\n      var boundingBox = new BoundingBox();\n      pathParser.reset();\n\n      if (ctx) {\n        ctx.beginPath();\n      }\n\n      while (!pathParser.isEnd()) {\n        switch (pathParser.next().type) {\n          case PathParser.MOVE_TO:\n            this.pathM(ctx, boundingBox);\n            break;\n\n          case PathParser.LINE_TO:\n            this.pathL(ctx, boundingBox);\n            break;\n\n          case PathParser.HORIZ_LINE_TO:\n            this.pathH(ctx, boundingBox);\n            break;\n\n          case PathParser.VERT_LINE_TO:\n            this.pathV(ctx, boundingBox);\n            break;\n\n          case PathParser.CURVE_TO:\n            this.pathC(ctx, boundingBox);\n            break;\n\n          case PathParser.SMOOTH_CURVE_TO:\n            this.pathS(ctx, boundingBox);\n            break;\n\n          case PathParser.QUAD_TO:\n            this.pathQ(ctx, boundingBox);\n            break;\n\n          case PathParser.SMOOTH_QUAD_TO:\n            this.pathT(ctx, boundingBox);\n            break;\n\n          case PathParser.ARC:\n            this.pathA(ctx, boundingBox);\n            break;\n\n          case PathParser.CLOSE_PATH:\n            this.pathZ(ctx, boundingBox);\n            break;\n        }\n      }\n\n      return boundingBox;\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(_) {\n      return this.path();\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      var pathParser = this.pathParser;\n      var points = pathParser.getMarkerPoints();\n      var angles = pathParser.getMarkerAngles();\n      var markers = points.map(function (point, i) {\n        return [point, angles[i]];\n      });\n      return markers;\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      this.path(ctx);\n      this.document.screen.mouse.checkPath(this, ctx);\n      var fillRuleStyleProp = this.getStyle('fill-rule');\n\n      if (ctx.fillStyle !== '') {\n        if (fillRuleStyleProp.getString('inherit') !== 'inherit') {\n          ctx.fill(fillRuleStyleProp.getString());\n        } else {\n          ctx.fill();\n        }\n      }\n\n      if (ctx.strokeStyle !== '') {\n        if (this.getAttribute('vector-effect').getString() === 'non-scaling-stroke') {\n          ctx.save();\n          ctx.setTransform(1, 0, 0, 1, 0, 0);\n          ctx.stroke();\n          ctx.restore();\n        } else {\n          ctx.stroke();\n        }\n      }\n\n      var markers = this.getMarkers();\n\n      if (markers) {\n        var markersLastIndex = markers.length - 1;\n        var markerStartStyleProp = this.getStyle('marker-start');\n        var markerMidStyleProp = this.getStyle('marker-mid');\n        var markerEndStyleProp = this.getStyle('marker-end');\n\n        if (markerStartStyleProp.isUrlDefinition()) {\n          var marker = markerStartStyleProp.getDefinition();\n\n          var _markers$ = _slicedToArray(markers[0], 2),\n              point = _markers$[0],\n              angle = _markers$[1];\n\n          marker.render(ctx, point, angle);\n        }\n\n        if (markerMidStyleProp.isUrlDefinition()) {\n          var _marker = markerMidStyleProp.getDefinition();\n\n          for (var i = 1; i < markersLastIndex; i++) {\n            var _markers$i = _slicedToArray(markers[i], 2),\n                _point = _markers$i[0],\n                _angle = _markers$i[1];\n\n            _marker.render(ctx, _point, _angle);\n          }\n        }\n\n        if (markerEndStyleProp.isUrlDefinition()) {\n          var _marker2 = markerEndStyleProp.getDefinition();\n\n          var _markers$markersLastI = _slicedToArray(markers[markersLastIndex], 2),\n              _point2 = _markers$markersLastI[0],\n              _angle2 = _markers$markersLastI[1];\n\n          _marker2.render(ctx, _point2, _angle2);\n        }\n      }\n    }\n  }, {\n    key: \"pathM\",\n    value: function pathM(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathM = PathElement.pathM(pathParser),\n          point = _PathElement$pathM.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.moveTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathL\",\n    value: function pathL(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathL = PathElement.pathL(pathParser),\n          current = _PathElement$pathL.current,\n          point = _PathElement$pathL.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point, current);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathH\",\n    value: function pathH(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathH = PathElement.pathH(pathParser),\n          current = _PathElement$pathH.current,\n          point = _PathElement$pathH.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point, current);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathV\",\n    value: function pathV(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathV = PathElement.pathV(pathParser),\n          current = _PathElement$pathV.current,\n          point = _PathElement$pathV.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point, current);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathC\",\n    value: function pathC(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathC = PathElement.pathC(pathParser),\n          current = _PathElement$pathC.current,\n          point = _PathElement$pathC.point,\n          controlPoint = _PathElement$pathC.controlPoint,\n          currentPoint = _PathElement$pathC.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, point);\n      boundingBox.addBezierCurve(current.x, current.y, point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.bezierCurveTo(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathS\",\n    value: function pathS(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathS = PathElement.pathS(pathParser),\n          current = _PathElement$pathS.current,\n          point = _PathElement$pathS.point,\n          controlPoint = _PathElement$pathS.controlPoint,\n          currentPoint = _PathElement$pathS.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, point);\n      boundingBox.addBezierCurve(current.x, current.y, point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.bezierCurveTo(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathQ\",\n    value: function pathQ(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathQ = PathElement.pathQ(pathParser),\n          current = _PathElement$pathQ.current,\n          controlPoint = _PathElement$pathQ.controlPoint,\n          currentPoint = _PathElement$pathQ.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, controlPoint);\n      boundingBox.addQuadraticCurve(current.x, current.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.quadraticCurveTo(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathT\",\n    value: function pathT(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathT = PathElement.pathT(pathParser),\n          current = _PathElement$pathT.current,\n          controlPoint = _PathElement$pathT.controlPoint,\n          currentPoint = _PathElement$pathT.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, controlPoint);\n      boundingBox.addQuadraticCurve(current.x, current.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.quadraticCurveTo(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathA\",\n    value: function pathA(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathA = PathElement.pathA(pathParser),\n          currentPoint = _PathElement$pathA.currentPoint,\n          rX = _PathElement$pathA.rX,\n          rY = _PathElement$pathA.rY,\n          sweepFlag = _PathElement$pathA.sweepFlag,\n          xAxisRotation = _PathElement$pathA.xAxisRotation,\n          centp = _PathElement$pathA.centp,\n          a1 = _PathElement$pathA.a1,\n          ad = _PathElement$pathA.ad; // for markers\n\n\n      var dir = 1 - sweepFlag ? 1.0 : -1.0;\n      var ah = a1 + dir * (ad / 2.0);\n      var halfWay = new Point(centp.x + rX * Math.cos(ah), centp.y + rY * Math.sin(ah));\n      pathParser.addMarkerAngle(halfWay, ah - dir * Math.PI / 2);\n      pathParser.addMarkerAngle(currentPoint, ah - dir * Math.PI);\n      boundingBox.addPoint(currentPoint.x, currentPoint.y); // TODO: this is too naive, make it better\n\n      if (ctx && !isNaN(a1) && !isNaN(ad)) {\n        var r = rX > rY ? rX : rY;\n        var sx = rX > rY ? 1 : rX / rY;\n        var sy = rX > rY ? rY / rX : 1;\n        ctx.translate(centp.x, centp.y);\n        ctx.rotate(xAxisRotation);\n        ctx.scale(sx, sy);\n        ctx.arc(0, 0, r, a1, a1 + ad, Boolean(1 - sweepFlag));\n        ctx.scale(1 / sx, 1 / sy);\n        ctx.rotate(-xAxisRotation);\n        ctx.translate(-centp.x, -centp.y);\n      }\n    }\n  }, {\n    key: \"pathZ\",\n    value: function pathZ(ctx, boundingBox) {\n      PathElement.pathZ(this.pathParser);\n\n      if (ctx) {\n        // only close path if it is not a straight line\n        if (boundingBox.x1 !== boundingBox.x2 && boundingBox.y1 !== boundingBox.y2) {\n          ctx.closePath();\n        }\n      }\n    }\n  }], [{\n    key: \"pathM\",\n    value: function pathM(pathParser) {\n      var point = pathParser.getAsCurrentPoint();\n      pathParser.start = pathParser.current;\n      return {\n        point: point\n      };\n    }\n  }, {\n    key: \"pathL\",\n    value: function pathL(pathParser) {\n      var current = pathParser.current;\n      var point = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        point: point\n      };\n    }\n  }, {\n    key: \"pathH\",\n    value: function pathH(pathParser) {\n      var current = pathParser.current,\n          command = pathParser.command;\n      var point = new Point((command.relative ? current.x : 0) + command.x, current.y);\n      pathParser.current = point;\n      return {\n        current: current,\n        point: point\n      };\n    }\n  }, {\n    key: \"pathV\",\n    value: function pathV(pathParser) {\n      var current = pathParser.current,\n          command = pathParser.command;\n      var point = new Point(current.x, (command.relative ? current.y : 0) + command.y);\n      pathParser.current = point;\n      return {\n        current: current,\n        point: point\n      };\n    }\n  }, {\n    key: \"pathC\",\n    value: function pathC(pathParser) {\n      var current = pathParser.current;\n      var point = pathParser.getPoint('x1', 'y1');\n      var controlPoint = pathParser.getAsControlPoint('x2', 'y2');\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        point: point,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathS\",\n    value: function pathS(pathParser) {\n      var current = pathParser.current;\n      var point = pathParser.getReflectedControlPoint();\n      var controlPoint = pathParser.getAsControlPoint('x2', 'y2');\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        point: point,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathQ\",\n    value: function pathQ(pathParser) {\n      var current = pathParser.current;\n      var controlPoint = pathParser.getAsControlPoint('x1', 'y1');\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathT\",\n    value: function pathT(pathParser) {\n      var current = pathParser.current;\n      var controlPoint = pathParser.getReflectedControlPoint();\n      pathParser.control = controlPoint;\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathA\",\n    value: function pathA(pathParser) {\n      var current = pathParser.current,\n          command = pathParser.command;\n      var rX = command.rX,\n          rY = command.rY,\n          xRot = command.xRot,\n          lArcFlag = command.lArcFlag,\n          sweepFlag = command.sweepFlag;\n      var xAxisRotation = xRot * (Math.PI / 180.0);\n      var currentPoint = pathParser.getAsCurrentPoint(); // Conversion from endpoint to center parameterization\n      // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n      // x1', y1'\n\n      var currp = new Point(Math.cos(xAxisRotation) * (current.x - currentPoint.x) / 2.0 + Math.sin(xAxisRotation) * (current.y - currentPoint.y) / 2.0, -Math.sin(xAxisRotation) * (current.x - currentPoint.x) / 2.0 + Math.cos(xAxisRotation) * (current.y - currentPoint.y) / 2.0); // adjust radii\n\n      var l = Math.pow(currp.x, 2) / Math.pow(rX, 2) + Math.pow(currp.y, 2) / Math.pow(rY, 2);\n\n      if (l > 1) {\n        rX *= Math.sqrt(l);\n        rY *= Math.sqrt(l);\n      } // cx', cy'\n\n\n      var s = (lArcFlag === sweepFlag ? -1 : 1) * Math.sqrt((Math.pow(rX, 2) * Math.pow(rY, 2) - Math.pow(rX, 2) * Math.pow(currp.y, 2) - Math.pow(rY, 2) * Math.pow(currp.x, 2)) / (Math.pow(rX, 2) * Math.pow(currp.y, 2) + Math.pow(rY, 2) * Math.pow(currp.x, 2)));\n\n      if (isNaN(s)) {\n        s = 0;\n      }\n\n      var cpp = new Point(s * rX * currp.y / rY, s * -rY * currp.x / rX); // cx, cy\n\n      var centp = new Point((current.x + currentPoint.x) / 2.0 + Math.cos(xAxisRotation) * cpp.x - Math.sin(xAxisRotation) * cpp.y, (current.y + currentPoint.y) / 2.0 + Math.sin(xAxisRotation) * cpp.x + Math.cos(xAxisRotation) * cpp.y); // initial angle\n\n      var a1 = vectorsAngle([1, 0], [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY]); // θ1\n      // angle delta\n\n      var u = [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY];\n      var v = [(-currp.x - cpp.x) / rX, (-currp.y - cpp.y) / rY];\n      var ad = vectorsAngle(u, v); // Δθ\n\n      if (vectorsRatio(u, v) <= -1) {\n        ad = Math.PI;\n      }\n\n      if (vectorsRatio(u, v) >= 1) {\n        ad = 0;\n      }\n\n      return {\n        currentPoint: currentPoint,\n        rX: rX,\n        rY: rY,\n        sweepFlag: sweepFlag,\n        xAxisRotation: xAxisRotation,\n        centp: centp,\n        a1: a1,\n        ad: ad\n      };\n    }\n  }, {\n    key: \"pathZ\",\n    value: function pathZ(pathParser) {\n      pathParser.current = pathParser.start;\n    }\n  }]);\n\n  return PathElement;\n}(RenderedElement);\n\nvar GlyphElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(GlyphElement, _PathElement);\n\n  var _super8 = _createSuper(GlyphElement);\n\n  function GlyphElement(document, node, captureTextNodes) {\n    var _this12;\n\n    _classCallCheck(this, GlyphElement);\n\n    _this12 = _super8.call(this, document, node, captureTextNodes);\n    _this12.type = 'glyph';\n    _this12.horizAdvX = _this12.getAttribute('horiz-adv-x').getNumber();\n    _this12.unicode = _this12.getAttribute('unicode').getString();\n    _this12.arabicForm = _this12.getAttribute('arabic-form').getString();\n    return _this12;\n  }\n\n  return GlyphElement;\n}(PathElement);\n\nvar TextElement = /*#__PURE__*/function (_RenderedElement2) {\n  _inherits(TextElement, _RenderedElement2);\n\n  var _super9 = _createSuper(TextElement);\n\n  function TextElement(document, node, captureTextNodes) {\n    var _this13;\n\n    _classCallCheck(this, TextElement);\n\n    _this13 = _super9.call(this, document, node, (this instanceof TextElement ? this.constructor : void 0) === TextElement ? true : captureTextNodes);\n    _this13.type = 'text';\n    _this13.x = 0;\n    _this13.y = 0;\n    _this13.measureCache = -1;\n    return _this13;\n  }\n\n  _createClass(TextElement, [{\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      var fromMeasure = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      _get(_getPrototypeOf(TextElement.prototype), \"setContext\", this).call(this, ctx, fromMeasure);\n\n      var textBaseline = this.getStyle('dominant-baseline').getTextBaseline() || this.getStyle('alignment-baseline').getTextBaseline();\n\n      if (textBaseline) {\n        ctx.textBaseline = textBaseline;\n      }\n    }\n  }, {\n    key: \"initializeCoordinates\",\n    value: function initializeCoordinates(ctx) {\n      this.x = this.getAttribute('x').getPixels('x');\n      this.y = this.getAttribute('y').getPixels('y');\n      var dxAttr = this.getAttribute('dx');\n      var dyAttr = this.getAttribute('dy');\n\n      if (dxAttr.hasValue()) {\n        this.x += dxAttr.getPixels('x');\n      }\n\n      if (dyAttr.hasValue()) {\n        this.y += dyAttr.getPixels('y');\n      }\n\n      this.x += this.getAnchorDelta(ctx, this, 0);\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(ctx) {\n      var _this14 = this;\n\n      if (this.type !== 'text') {\n        return this.getTElementBoundingBox(ctx);\n      }\n\n      this.initializeCoordinates(ctx);\n      var boundingBox = null;\n      this.children.forEach(function (_, i) {\n        var childBoundingBox = _this14.getChildBoundingBox(ctx, _this14, _this14, i);\n\n        if (!boundingBox) {\n          boundingBox = childBoundingBox;\n        } else {\n          boundingBox.addBoundingBox(childBoundingBox);\n        }\n      });\n      return boundingBox;\n    }\n  }, {\n    key: \"getFontSize\",\n    value: function getFontSize() {\n      var document = this.document,\n          parent = this.parent;\n      var inheritFontSize = Font.parse(document.ctx.font).fontSize;\n      var fontSize = parent.getStyle('font-size').getNumber(inheritFontSize);\n      return fontSize;\n    }\n  }, {\n    key: \"getTElementBoundingBox\",\n    value: function getTElementBoundingBox(ctx) {\n      var fontSize = this.getFontSize();\n      return new BoundingBox(this.x, this.y - fontSize, this.x + this.measureText(ctx), this.y);\n    }\n  }, {\n    key: \"getGlyph\",\n    value: function getGlyph(font, text, i) {\n      var char = text[i];\n      var glyph = null;\n\n      if (font.isArabic) {\n        var len = text.length;\n        var prevChar = text[i - 1];\n        var nextChar = text[i + 1];\n        var arabicForm = 'isolated';\n\n        if ((i === 0 || prevChar === ' ') && i < len - 2 && nextChar !== ' ') {\n          arabicForm = 'terminal';\n        }\n\n        if (i > 0 && prevChar !== ' ' && i < len - 2 && nextChar !== ' ') {\n          arabicForm = 'medial';\n        }\n\n        if (i > 0 && prevChar !== ' ' && (i === len - 1 || nextChar === ' ')) {\n          arabicForm = 'initial';\n        }\n\n        if (typeof font.glyphs[char] !== 'undefined') {\n          // NEED TEST\n          var maybeGlyph = font.glyphs[char];\n          glyph = maybeGlyph instanceof GlyphElement ? maybeGlyph : maybeGlyph[arabicForm];\n        }\n      } else {\n        glyph = font.glyphs[char];\n      }\n\n      if (!glyph) {\n        glyph = font.missingGlyph;\n      }\n\n      return glyph;\n    }\n  }, {\n    key: \"getText\",\n    value: function getText() {\n      return '';\n    }\n  }, {\n    key: \"getTextFromNode\",\n    value: function getTextFromNode(node) {\n      var textNode = node || this.node;\n      var childNodes = Array.from(textNode.parentNode.childNodes);\n      var index = childNodes.indexOf(textNode);\n      var lastIndex = childNodes.length - 1;\n      var text = compressSpaces( // textNode.value\n      // || textNode.text\n      textNode.textContent || '');\n\n      if (index === 0) {\n        text = trimLeft(text);\n      }\n\n      if (index === lastIndex) {\n        text = trimRight(text);\n      }\n\n      return text;\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      var _this15 = this;\n\n      if (this.type !== 'text') {\n        this.renderTElementChildren(ctx);\n        return;\n      }\n\n      this.initializeCoordinates(ctx);\n      this.children.forEach(function (_, i) {\n        _this15.renderChild(ctx, _this15, _this15, i);\n      });\n      var mouse = this.document.screen.mouse; // Do not calc bounding box if mouse is not working.\n\n      if (mouse.isWorking()) {\n        mouse.checkBoundingBox(this, this.getBoundingBox(ctx));\n      }\n    }\n  }, {\n    key: \"renderTElementChildren\",\n    value: function renderTElementChildren(ctx) {\n      var document = this.document,\n          parent = this.parent;\n      var renderText = this.getText();\n      var customFont = parent.getStyle('font-family').getDefinition();\n\n      if (customFont) {\n        var unitsPerEm = customFont.fontFace.unitsPerEm;\n        var ctxFont = Font.parse(document.ctx.font);\n        var fontSize = parent.getStyle('font-size').getNumber(ctxFont.fontSize);\n        var fontStyle = parent.getStyle('font-style').getString(ctxFont.fontStyle);\n        var scale = fontSize / unitsPerEm;\n        var text = customFont.isRTL ? renderText.split('').reverse().join('') : renderText;\n        var dx = toNumbers(parent.getAttribute('dx').getString());\n        var len = text.length;\n\n        for (var i = 0; i < len; i++) {\n          var glyph = this.getGlyph(customFont, text, i);\n          ctx.translate(this.x, this.y);\n          ctx.scale(scale, -scale);\n          var lw = ctx.lineWidth;\n          ctx.lineWidth = ctx.lineWidth * unitsPerEm / fontSize;\n\n          if (fontStyle === 'italic') {\n            ctx.transform(1, 0, .4, 1, 0, 0);\n          }\n\n          glyph.render(ctx);\n\n          if (fontStyle === 'italic') {\n            ctx.transform(1, 0, -.4, 1, 0, 0);\n          }\n\n          ctx.lineWidth = lw;\n          ctx.scale(1 / scale, -1 / scale);\n          ctx.translate(-this.x, -this.y);\n          this.x += fontSize * (glyph.horizAdvX || customFont.horizAdvX) / unitsPerEm;\n\n          if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n            this.x += dx[i];\n          }\n        }\n\n        return;\n      }\n\n      var x = this.x,\n          y = this.y; // NEED TEST\n      // if (ctx.paintOrder === 'stroke') {\n      // \tif (ctx.strokeStyle) {\n      // \t\tctx.strokeText(renderText, x, y);\n      // \t}\n      // \tif (ctx.fillStyle) {\n      // \t\tctx.fillText(renderText, x, y);\n      // \t}\n      // } else {\n\n      if (ctx.fillStyle) {\n        ctx.fillText(renderText, x, y);\n      }\n\n      if (ctx.strokeStyle) {\n        ctx.strokeText(renderText, x, y);\n      } // }\n\n    }\n  }, {\n    key: \"getAnchorDelta\",\n    value: function getAnchorDelta(ctx, parent, startI) {\n      var textAnchor = this.getStyle('text-anchor').getString('start');\n\n      if (textAnchor !== 'start') {\n        var children = parent.children;\n        var len = children.length;\n        var child = null;\n        var width = 0;\n\n        for (var i = startI; i < len; i++) {\n          child = children[i];\n\n          if (i > startI && child.getAttribute('x').hasValue() || child.getAttribute('text-anchor').hasValue()) {\n            break; // new group\n          }\n\n          width += child.measureTextRecursive(ctx);\n        }\n\n        return -1 * (textAnchor === 'end' ? width : width / 2.0);\n      }\n\n      return 0;\n    }\n  }, {\n    key: \"adjustChildCoordinates\",\n    value: function adjustChildCoordinates(ctx, textParent, parent, i) {\n      var child = parent.children[i];\n\n      if (typeof child.measureText !== 'function') {\n        return child;\n      }\n\n      ctx.save();\n      child.setContext(ctx, true);\n      var xAttr = child.getAttribute('x');\n      var yAttr = child.getAttribute('y');\n      var dxAttr = child.getAttribute('dx');\n      var dyAttr = child.getAttribute('dy');\n      var textAnchor = child.getAttribute('text-anchor').getString('start');\n\n      if (i === 0 && child.type !== 'textNode') {\n        if (!xAttr.hasValue()) {\n          xAttr.setValue(textParent.getAttribute('x').getValue('0'));\n        }\n\n        if (!yAttr.hasValue()) {\n          yAttr.setValue(textParent.getAttribute('y').getValue('0'));\n        }\n\n        if (!dxAttr.hasValue()) {\n          dxAttr.setValue(textParent.getAttribute('dx').getValue('0'));\n        }\n\n        if (!dyAttr.hasValue()) {\n          dyAttr.setValue(textParent.getAttribute('dy').getValue('0'));\n        }\n      }\n\n      if (xAttr.hasValue()) {\n        child.x = xAttr.getPixels('x') + textParent.getAnchorDelta(ctx, parent, i);\n\n        if (textAnchor !== 'start') {\n          var width = child.measureTextRecursive(ctx);\n          child.x += -1 * (textAnchor === 'end' ? width : width / 2.0);\n        }\n\n        if (dxAttr.hasValue()) {\n          child.x += dxAttr.getPixels('x');\n        }\n      } else {\n        if (textAnchor !== 'start') {\n          var _width = child.measureTextRecursive(ctx);\n\n          textParent.x += -1 * (textAnchor === 'end' ? _width : _width / 2.0);\n        }\n\n        if (dxAttr.hasValue()) {\n          textParent.x += dxAttr.getPixels('x');\n        }\n\n        child.x = textParent.x;\n      }\n\n      textParent.x = child.x + child.measureText(ctx);\n\n      if (yAttr.hasValue()) {\n        child.y = yAttr.getPixels('y');\n\n        if (dyAttr.hasValue()) {\n          child.y += dyAttr.getPixels('y');\n        }\n      } else {\n        if (dyAttr.hasValue()) {\n          textParent.y += dyAttr.getPixels('y');\n        }\n\n        child.y = textParent.y;\n      }\n\n      textParent.y = child.y;\n      child.clearContext(ctx);\n      ctx.restore();\n      return child;\n    }\n  }, {\n    key: \"getChildBoundingBox\",\n    value: function getChildBoundingBox(ctx, textParent, parent, i) {\n      var child = this.adjustChildCoordinates(ctx, textParent, parent, i); // not a text node?\n\n      if (typeof child.getBoundingBox !== 'function') {\n        return null;\n      }\n\n      var boundingBox = child.getBoundingBox(ctx);\n\n      if (!boundingBox) {\n        return null;\n      }\n\n      child.children.forEach(function (_, i) {\n        var childBoundingBox = textParent.getChildBoundingBox(ctx, textParent, child, i);\n        boundingBox.addBoundingBox(childBoundingBox);\n      });\n      return boundingBox;\n    }\n  }, {\n    key: \"renderChild\",\n    value: function renderChild(ctx, textParent, parent, i) {\n      var child = this.adjustChildCoordinates(ctx, textParent, parent, i);\n      child.render(ctx);\n      child.children.forEach(function (_, i) {\n        textParent.renderChild(ctx, textParent, child, i);\n      });\n    }\n  }, {\n    key: \"measureTextRecursive\",\n    value: function measureTextRecursive(ctx) {\n      var width = this.children.reduce(function (width, child) {\n        return width + child.measureTextRecursive(ctx);\n      }, this.measureText(ctx));\n      return width;\n    }\n  }, {\n    key: \"measureText\",\n    value: function measureText(ctx) {\n      var measureCache = this.measureCache;\n\n      if (~measureCache) {\n        return measureCache;\n      }\n\n      var renderText = this.getText();\n      var measure = this.measureTargetText(ctx, renderText);\n      this.measureCache = measure;\n      return measure;\n    }\n  }, {\n    key: \"measureTargetText\",\n    value: function measureTargetText(ctx, targetText) {\n      if (!targetText.length) {\n        return 0;\n      }\n\n      var parent = this.parent;\n      var customFont = parent.getStyle('font-family').getDefinition();\n\n      if (customFont) {\n        var fontSize = this.getFontSize();\n        var text = customFont.isRTL ? targetText.split('').reverse().join('') : targetText;\n        var dx = toNumbers(parent.getAttribute('dx').getString());\n        var len = text.length;\n        var _measure = 0;\n\n        for (var i = 0; i < len; i++) {\n          var glyph = this.getGlyph(customFont, text, i);\n          _measure += (glyph.horizAdvX || customFont.horizAdvX) * fontSize / customFont.fontFace.unitsPerEm;\n\n          if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n            _measure += dx[i];\n          }\n        }\n\n        return _measure;\n      }\n\n      if (!ctx.measureText) {\n        return targetText.length * 10;\n      }\n\n      ctx.save();\n      this.setContext(ctx, true);\n\n      var _ctx$measureText = ctx.measureText(targetText),\n          measure = _ctx$measureText.width;\n\n      this.clearContext(ctx);\n      ctx.restore();\n      return measure;\n    }\n  }]);\n\n  return TextElement;\n}(RenderedElement);\n\nvar TSpanElement = /*#__PURE__*/function (_TextElement) {\n  _inherits(TSpanElement, _TextElement);\n\n  var _super10 = _createSuper(TSpanElement);\n\n  function TSpanElement(document, node, captureTextNodes) {\n    var _this16;\n\n    _classCallCheck(this, TSpanElement);\n\n    _this16 = _super10.call(this, document, node, (this instanceof TSpanElement ? this.constructor : void 0) === TSpanElement ? true : captureTextNodes);\n    _this16.type = 'tspan'; // if this node has children, then they own the text\n\n    _this16.text = _this16.children.length > 0 ? '' : _this16.getTextFromNode();\n    return _this16;\n  }\n\n  _createClass(TSpanElement, [{\n    key: \"getText\",\n    value: function getText() {\n      return this.text;\n    }\n  }]);\n\n  return TSpanElement;\n}(TextElement);\n\nvar TextNode = /*#__PURE__*/function (_TSpanElement) {\n  _inherits(TextNode, _TSpanElement);\n\n  var _super11 = _createSuper(TextNode);\n\n  function TextNode() {\n    var _this17;\n\n    _classCallCheck(this, TextNode);\n\n    _this17 = _super11.apply(this, arguments);\n    _this17.type = 'textNode';\n    return _this17;\n  }\n\n  return TextNode;\n}(TSpanElement);\n\nvar SVGElement = /*#__PURE__*/function (_RenderedElement3) {\n  _inherits(SVGElement, _RenderedElement3);\n\n  var _super12 = _createSuper(SVGElement);\n\n  function SVGElement() {\n    var _this18;\n\n    _classCallCheck(this, SVGElement);\n\n    _this18 = _super12.apply(this, arguments);\n    _this18.type = 'svg';\n    _this18.root = false;\n    return _this18;\n  }\n\n  _createClass(SVGElement, [{\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      var _this$node$parentNode;\n\n      var document = this.document;\n      var screen = document.screen,\n          window = document.window;\n      var canvas = ctx.canvas;\n      screen.setDefaults(ctx);\n\n      if (canvas.style && typeof ctx.font !== 'undefined' && window && typeof window.getComputedStyle !== 'undefined') {\n        ctx.font = window.getComputedStyle(canvas).getPropertyValue('font');\n        var fontSizeProp = new Property(document, 'fontSize', Font.parse(ctx.font).fontSize);\n\n        if (fontSizeProp.hasValue()) {\n          document.rootEmSize = fontSizeProp.getPixels('y');\n          document.emSize = document.rootEmSize;\n        }\n      } // create new view port\n\n\n      if (!this.getAttribute('x').hasValue()) {\n        this.getAttribute('x', true).setValue(0);\n      }\n\n      if (!this.getAttribute('y').hasValue()) {\n        this.getAttribute('y', true).setValue(0);\n      }\n\n      var _screen$viewPort = screen.viewPort,\n          width = _screen$viewPort.width,\n          height = _screen$viewPort.height;\n\n      if (!this.getStyle('width').hasValue()) {\n        this.getStyle('width', true).setValue('100%');\n      }\n\n      if (!this.getStyle('height').hasValue()) {\n        this.getStyle('height', true).setValue('100%');\n      }\n\n      if (!this.getStyle('color').hasValue()) {\n        this.getStyle('color', true).setValue('black');\n      }\n\n      var refXAttr = this.getAttribute('refX');\n      var refYAttr = this.getAttribute('refY');\n      var viewBoxAttr = this.getAttribute('viewBox');\n      var viewBox = viewBoxAttr.hasValue() ? toNumbers(viewBoxAttr.getString()) : null;\n      var clip = !this.root && this.getStyle('overflow').getValue('hidden') !== 'visible';\n      var minX = 0;\n      var minY = 0;\n      var clipX = 0;\n      var clipY = 0;\n\n      if (viewBox) {\n        minX = viewBox[0];\n        minY = viewBox[1];\n      }\n\n      if (!this.root) {\n        width = this.getStyle('width').getPixels('x');\n        height = this.getStyle('height').getPixels('y');\n\n        if (this.type === 'marker') {\n          clipX = minX;\n          clipY = minY;\n          minX = 0;\n          minY = 0;\n        }\n      }\n\n      screen.viewPort.setCurrent(width, height); // Default value of transform-origin is center only for root SVG elements\n      // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform-origin\n\n      if (this.node // is not temporary SVGElement\n      && (!this.parent || ((_this$node$parentNode = this.node.parentNode) === null || _this$node$parentNode === void 0 ? void 0 : _this$node$parentNode.nodeName) === 'foreignObject') && this.getStyle('transform', false, true).hasValue() && !this.getStyle('transform-origin', false, true).hasValue()) {\n        this.getStyle('transform-origin', true, true).setValue('50% 50%');\n      }\n\n      _get(_getPrototypeOf(SVGElement.prototype), \"setContext\", this).call(this, ctx);\n\n      ctx.translate(this.getAttribute('x').getPixels('x'), this.getAttribute('y').getPixels('y'));\n\n      if (viewBox) {\n        width = viewBox[2];\n        height = viewBox[3];\n      }\n\n      document.setViewBox({\n        ctx: ctx,\n        aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n        width: screen.viewPort.width,\n        desiredWidth: width,\n        height: screen.viewPort.height,\n        desiredHeight: height,\n        minX: minX,\n        minY: minY,\n        refX: refXAttr.getValue(),\n        refY: refYAttr.getValue(),\n        clip: clip,\n        clipX: clipX,\n        clipY: clipY\n      });\n\n      if (viewBox) {\n        screen.viewPort.removeCurrent();\n        screen.viewPort.setCurrent(width, height);\n      }\n    }\n  }, {\n    key: \"clearContext\",\n    value: function clearContext(ctx) {\n      _get(_getPrototypeOf(SVGElement.prototype), \"clearContext\", this).call(this, ctx);\n\n      this.document.screen.viewPort.removeCurrent();\n    }\n    /**\r\n     * Resize SVG to fit in given size.\r\n     * @param width\r\n     * @param height\r\n     * @param preserveAspectRatio\r\n     */\n\n  }, {\n    key: \"resize\",\n    value: function resize(width) {\n      var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : width;\n      var preserveAspectRatio = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var widthAttr = this.getAttribute('width', true);\n      var heightAttr = this.getAttribute('height', true);\n      var viewBoxAttr = this.getAttribute('viewBox');\n      var styleAttr = this.getAttribute('style');\n      var originWidth = widthAttr.getNumber(0);\n      var originHeight = heightAttr.getNumber(0);\n\n      if (preserveAspectRatio) {\n        if (typeof preserveAspectRatio === 'string') {\n          this.getAttribute('preserveAspectRatio', true).setValue(preserveAspectRatio);\n        } else {\n          var preserveAspectRatioAttr = this.getAttribute('preserveAspectRatio');\n\n          if (preserveAspectRatioAttr.hasValue()) {\n            preserveAspectRatioAttr.setValue(preserveAspectRatioAttr.getString().replace(/^\\s*(\\S.*\\S)\\s*$/, '$1'));\n          }\n        }\n      }\n\n      widthAttr.setValue(width);\n      heightAttr.setValue(height);\n\n      if (!viewBoxAttr.hasValue()) {\n        viewBoxAttr.setValue(\"0 0 \".concat(originWidth || width, \" \").concat(originHeight || height));\n      }\n\n      if (styleAttr.hasValue()) {\n        var widthStyle = this.getStyle('width');\n        var heightStyle = this.getStyle('height');\n\n        if (widthStyle.hasValue()) {\n          widthStyle.setValue(\"\".concat(width, \"px\"));\n        }\n\n        if (heightStyle.hasValue()) {\n          heightStyle.setValue(\"\".concat(height, \"px\"));\n        }\n      }\n    }\n  }]);\n\n  return SVGElement;\n}(RenderedElement);\n\nvar RectElement = /*#__PURE__*/function (_PathElement2) {\n  _inherits(RectElement, _PathElement2);\n\n  var _super13 = _createSuper(RectElement);\n\n  function RectElement() {\n    var _this19;\n\n    _classCallCheck(this, RectElement);\n\n    _this19 = _super13.apply(this, arguments);\n    _this19.type = 'rect';\n    return _this19;\n  }\n\n  _createClass(RectElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width', false, true).getPixels('x');\n      var height = this.getStyle('height', false, true).getPixels('y');\n      var rxAttr = this.getAttribute('rx');\n      var ryAttr = this.getAttribute('ry');\n      var rx = rxAttr.getPixels('x');\n      var ry = ryAttr.getPixels('y');\n\n      if (rxAttr.hasValue() && !ryAttr.hasValue()) {\n        ry = rx;\n      }\n\n      if (ryAttr.hasValue() && !rxAttr.hasValue()) {\n        rx = ry;\n      }\n\n      rx = Math.min(rx, width / 2.0);\n      ry = Math.min(ry, height / 2.0);\n\n      if (ctx) {\n        var KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);\n        ctx.beginPath(); // always start the path so we don't fill prior paths\n\n        if (height > 0 && width > 0) {\n          ctx.moveTo(x + rx, y);\n          ctx.lineTo(x + width - rx, y);\n          ctx.bezierCurveTo(x + width - rx + KAPPA * rx, y, x + width, y + ry - KAPPA * ry, x + width, y + ry);\n          ctx.lineTo(x + width, y + height - ry);\n          ctx.bezierCurveTo(x + width, y + height - ry + KAPPA * ry, x + width - rx + KAPPA * rx, y + height, x + width - rx, y + height);\n          ctx.lineTo(x + rx, y + height);\n          ctx.bezierCurveTo(x + rx - KAPPA * rx, y + height, x, y + height - ry + KAPPA * ry, x, y + height - ry);\n          ctx.lineTo(x, y + ry);\n          ctx.bezierCurveTo(x, y + ry - KAPPA * ry, x + rx - KAPPA * rx, y, x + rx, y);\n          ctx.closePath();\n        }\n      }\n\n      return new BoundingBox(x, y, x + width, y + height);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      return null;\n    }\n  }]);\n\n  return RectElement;\n}(PathElement);\n\nvar CircleElement = /*#__PURE__*/function (_PathElement3) {\n  _inherits(CircleElement, _PathElement3);\n\n  var _super14 = _createSuper(CircleElement);\n\n  function CircleElement() {\n    var _this20;\n\n    _classCallCheck(this, CircleElement);\n\n    _this20 = _super14.apply(this, arguments);\n    _this20.type = 'circle';\n    return _this20;\n  }\n\n  _createClass(CircleElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var cx = this.getAttribute('cx').getPixels('x');\n      var cy = this.getAttribute('cy').getPixels('y');\n      var r = this.getAttribute('r').getPixels();\n\n      if (ctx && r > 0) {\n        ctx.beginPath();\n        ctx.arc(cx, cy, r, 0, Math.PI * 2, false);\n        ctx.closePath();\n      }\n\n      return new BoundingBox(cx - r, cy - r, cx + r, cy + r);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      return null;\n    }\n  }]);\n\n  return CircleElement;\n}(PathElement);\n\nvar EllipseElement = /*#__PURE__*/function (_PathElement4) {\n  _inherits(EllipseElement, _PathElement4);\n\n  var _super15 = _createSuper(EllipseElement);\n\n  function EllipseElement() {\n    var _this21;\n\n    _classCallCheck(this, EllipseElement);\n\n    _this21 = _super15.apply(this, arguments);\n    _this21.type = 'ellipse';\n    return _this21;\n  }\n\n  _createClass(EllipseElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);\n      var rx = this.getAttribute('rx').getPixels('x');\n      var ry = this.getAttribute('ry').getPixels('y');\n      var cx = this.getAttribute('cx').getPixels('x');\n      var cy = this.getAttribute('cy').getPixels('y');\n\n      if (ctx && rx > 0 && ry > 0) {\n        ctx.beginPath();\n        ctx.moveTo(cx + rx, cy);\n        ctx.bezierCurveTo(cx + rx, cy + KAPPA * ry, cx + KAPPA * rx, cy + ry, cx, cy + ry);\n        ctx.bezierCurveTo(cx - KAPPA * rx, cy + ry, cx - rx, cy + KAPPA * ry, cx - rx, cy);\n        ctx.bezierCurveTo(cx - rx, cy - KAPPA * ry, cx - KAPPA * rx, cy - ry, cx, cy - ry);\n        ctx.bezierCurveTo(cx + KAPPA * rx, cy - ry, cx + rx, cy - KAPPA * ry, cx + rx, cy);\n        ctx.closePath();\n      }\n\n      return new BoundingBox(cx - rx, cy - ry, cx + rx, cy + ry);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      return null;\n    }\n  }]);\n\n  return EllipseElement;\n}(PathElement);\n\nvar LineElement = /*#__PURE__*/function (_PathElement5) {\n  _inherits(LineElement, _PathElement5);\n\n  var _super16 = _createSuper(LineElement);\n\n  function LineElement() {\n    var _this22;\n\n    _classCallCheck(this, LineElement);\n\n    _this22 = _super16.apply(this, arguments);\n    _this22.type = 'line';\n    return _this22;\n  }\n\n  _createClass(LineElement, [{\n    key: \"getPoints\",\n    value: function getPoints() {\n      return [new Point(this.getAttribute('x1').getPixels('x'), this.getAttribute('y1').getPixels('y')), new Point(this.getAttribute('x2').getPixels('x'), this.getAttribute('y2').getPixels('y'))];\n    }\n  }, {\n    key: \"path\",\n    value: function path(ctx) {\n      var _this$getPoints = this.getPoints(),\n          _this$getPoints2 = _slicedToArray(_this$getPoints, 2),\n          _this$getPoints2$ = _this$getPoints2[0],\n          x0 = _this$getPoints2$.x,\n          y0 = _this$getPoints2$.y,\n          _this$getPoints2$2 = _this$getPoints2[1],\n          x1 = _this$getPoints2$2.x,\n          y1 = _this$getPoints2$2.y;\n\n      if (ctx) {\n        ctx.beginPath();\n        ctx.moveTo(x0, y0);\n        ctx.lineTo(x1, y1);\n      }\n\n      return new BoundingBox(x0, y0, x1, y1);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      var _this$getPoints3 = this.getPoints(),\n          _this$getPoints4 = _slicedToArray(_this$getPoints3, 2),\n          p0 = _this$getPoints4[0],\n          p1 = _this$getPoints4[1];\n\n      var a = p0.angleTo(p1);\n      return [[p0, a], [p1, a]];\n    }\n  }]);\n\n  return LineElement;\n}(PathElement);\n\nvar PolylineElement = /*#__PURE__*/function (_PathElement6) {\n  _inherits(PolylineElement, _PathElement6);\n\n  var _super17 = _createSuper(PolylineElement);\n\n  function PolylineElement(document, node, captureTextNodes) {\n    var _this23;\n\n    _classCallCheck(this, PolylineElement);\n\n    _this23 = _super17.call(this, document, node, captureTextNodes);\n    _this23.type = 'polyline';\n    _this23.points = [];\n    _this23.points = Point.parsePath(_this23.getAttribute('points').getString());\n    return _this23;\n  }\n\n  _createClass(PolylineElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var points = this.points;\n\n      var _points = _slicedToArray(points, 1),\n          _points$ = _points[0],\n          x0 = _points$.x,\n          y0 = _points$.y;\n\n      var boundingBox = new BoundingBox(x0, y0);\n\n      if (ctx) {\n        ctx.beginPath();\n        ctx.moveTo(x0, y0);\n      }\n\n      points.forEach(function (_ref) {\n        var x = _ref.x,\n            y = _ref.y;\n        boundingBox.addPoint(x, y);\n\n        if (ctx) {\n          ctx.lineTo(x, y);\n        }\n      });\n      return boundingBox;\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      var points = this.points;\n      var lastIndex = points.length - 1;\n      var markers = [];\n      points.forEach(function (point, i) {\n        if (i === lastIndex) {\n          return;\n        }\n\n        markers.push([point, point.angleTo(points[i + 1])]);\n      });\n\n      if (markers.length > 0) {\n        markers.push([points[points.length - 1], markers[markers.length - 1][1]]);\n      }\n\n      return markers;\n    }\n  }]);\n\n  return PolylineElement;\n}(PathElement);\n\nvar PolygonElement = /*#__PURE__*/function (_PolylineElement) {\n  _inherits(PolygonElement, _PolylineElement);\n\n  var _super18 = _createSuper(PolygonElement);\n\n  function PolygonElement() {\n    var _this24;\n\n    _classCallCheck(this, PolygonElement);\n\n    _this24 = _super18.apply(this, arguments);\n    _this24.type = 'polygon';\n    return _this24;\n  }\n\n  _createClass(PolygonElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var boundingBox = _get(_getPrototypeOf(PolygonElement.prototype), \"path\", this).call(this, ctx);\n\n      var _this$points = _slicedToArray(this.points, 1),\n          _this$points$ = _this$points[0],\n          x = _this$points$.x,\n          y = _this$points$.y;\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n        ctx.closePath();\n      }\n\n      return boundingBox;\n    }\n  }]);\n\n  return PolygonElement;\n}(PolylineElement);\n\nvar PatternElement = /*#__PURE__*/function (_Element3) {\n  _inherits(PatternElement, _Element3);\n\n  var _super19 = _createSuper(PatternElement);\n\n  function PatternElement() {\n    var _this25;\n\n    _classCallCheck(this, PatternElement);\n\n    _this25 = _super19.apply(this, arguments);\n    _this25.type = 'pattern';\n    return _this25;\n  }\n\n  _createClass(PatternElement, [{\n    key: \"createPattern\",\n    value: function createPattern(ctx, _, parentOpacityProp) {\n      var width = this.getStyle('width').getPixels('x', true);\n      var height = this.getStyle('height').getPixels('y', true); // render me using a temporary svg element\n\n      var patternSvg = new SVGElement(this.document, null);\n      patternSvg.attributes.viewBox = new Property(this.document, 'viewBox', this.getAttribute('viewBox').getValue());\n      patternSvg.attributes.width = new Property(this.document, 'width', \"\".concat(width, \"px\"));\n      patternSvg.attributes.height = new Property(this.document, 'height', \"\".concat(height, \"px\"));\n      patternSvg.attributes.transform = new Property(this.document, 'transform', this.getAttribute('patternTransform').getValue());\n      patternSvg.children = this.children;\n      var patternCanvas = this.document.createCanvas(width, height);\n      var patternCtx = patternCanvas.getContext('2d');\n      var xAttr = this.getAttribute('x');\n      var yAttr = this.getAttribute('y');\n\n      if (xAttr.hasValue() && yAttr.hasValue()) {\n        patternCtx.translate(xAttr.getPixels('x', true), yAttr.getPixels('y', true));\n      }\n\n      if (parentOpacityProp.hasValue()) {\n        this.styles['fill-opacity'] = parentOpacityProp;\n      } else {\n        Reflect.deleteProperty(this.styles, 'fill-opacity');\n      } // render 3x3 grid so when we transform there's no white space on edges\n\n\n      for (var x = -1; x <= 1; x++) {\n        for (var y = -1; y <= 1; y++) {\n          patternCtx.save();\n          patternSvg.attributes.x = new Property(this.document, 'x', x * patternCanvas.width);\n          patternSvg.attributes.y = new Property(this.document, 'y', y * patternCanvas.height);\n          patternSvg.render(patternCtx);\n          patternCtx.restore();\n        }\n      }\n\n      var pattern = ctx.createPattern(patternCanvas, 'repeat');\n      return pattern;\n    }\n  }]);\n\n  return PatternElement;\n}(Element);\n\nvar MarkerElement = /*#__PURE__*/function (_Element4) {\n  _inherits(MarkerElement, _Element4);\n\n  var _super20 = _createSuper(MarkerElement);\n\n  function MarkerElement() {\n    var _this26;\n\n    _classCallCheck(this, MarkerElement);\n\n    _this26 = _super20.apply(this, arguments);\n    _this26.type = 'marker';\n    return _this26;\n  }\n\n  _createClass(MarkerElement, [{\n    key: \"render\",\n    value: function render(ctx, point, angle) {\n      if (!point) {\n        return;\n      }\n\n      var x = point.x,\n          y = point.y;\n      var orient = this.getAttribute('orient').getString('auto');\n      var markerUnits = this.getAttribute('markerUnits').getString('strokeWidth');\n      ctx.translate(x, y);\n\n      if (orient === 'auto') {\n        ctx.rotate(angle);\n      }\n\n      if (markerUnits === 'strokeWidth') {\n        ctx.scale(ctx.lineWidth, ctx.lineWidth);\n      }\n\n      ctx.save(); // render me using a temporary svg element\n\n      var markerSvg = new SVGElement(this.document, null);\n      markerSvg.type = this.type;\n      markerSvg.attributes.viewBox = new Property(this.document, 'viewBox', this.getAttribute('viewBox').getValue());\n      markerSvg.attributes.refX = new Property(this.document, 'refX', this.getAttribute('refX').getValue());\n      markerSvg.attributes.refY = new Property(this.document, 'refY', this.getAttribute('refY').getValue());\n      markerSvg.attributes.width = new Property(this.document, 'width', this.getAttribute('markerWidth').getValue());\n      markerSvg.attributes.height = new Property(this.document, 'height', this.getAttribute('markerHeight').getValue());\n      markerSvg.attributes.overflow = new Property(this.document, 'overflow', this.getAttribute('overflow').getValue());\n      markerSvg.attributes.fill = new Property(this.document, 'fill', this.getAttribute('fill').getColor('black'));\n      markerSvg.attributes.stroke = new Property(this.document, 'stroke', this.getAttribute('stroke').getValue('none'));\n      markerSvg.children = this.children;\n      markerSvg.render(ctx);\n      ctx.restore();\n\n      if (markerUnits === 'strokeWidth') {\n        ctx.scale(1 / ctx.lineWidth, 1 / ctx.lineWidth);\n      }\n\n      if (orient === 'auto') {\n        ctx.rotate(-angle);\n      }\n\n      ctx.translate(-x, -y);\n    }\n  }]);\n\n  return MarkerElement;\n}(Element);\n\nvar DefsElement = /*#__PURE__*/function (_Element5) {\n  _inherits(DefsElement, _Element5);\n\n  var _super21 = _createSuper(DefsElement);\n\n  function DefsElement() {\n    var _this27;\n\n    _classCallCheck(this, DefsElement);\n\n    _this27 = _super21.apply(this, arguments);\n    _this27.type = 'defs';\n    return _this27;\n  }\n\n  _createClass(DefsElement, [{\n    key: \"render\",\n    value: function render() {// NOOP\n    }\n  }]);\n\n  return DefsElement;\n}(Element);\n\nvar GElement = /*#__PURE__*/function (_RenderedElement4) {\n  _inherits(GElement, _RenderedElement4);\n\n  var _super22 = _createSuper(GElement);\n\n  function GElement() {\n    var _this28;\n\n    _classCallCheck(this, GElement);\n\n    _this28 = _super22.apply(this, arguments);\n    _this28.type = 'g';\n    return _this28;\n  }\n\n  _createClass(GElement, [{\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(ctx) {\n      var boundingBox = new BoundingBox();\n      this.children.forEach(function (child) {\n        boundingBox.addBoundingBox(child.getBoundingBox(ctx));\n      });\n      return boundingBox;\n    }\n  }]);\n\n  return GElement;\n}(RenderedElement);\n\nvar GradientElement = /*#__PURE__*/function (_Element6) {\n  _inherits(GradientElement, _Element6);\n\n  var _super23 = _createSuper(GradientElement);\n\n  function GradientElement(document, node, captureTextNodes) {\n    var _this29;\n\n    _classCallCheck(this, GradientElement);\n\n    _this29 = _super23.call(this, document, node, captureTextNodes);\n    _this29.attributesToInherit = ['gradientUnits'];\n    _this29.stops = [];\n\n    var _assertThisInitialize = _assertThisInitialized(_this29),\n        stops = _assertThisInitialize.stops,\n        children = _assertThisInitialize.children;\n\n    children.forEach(function (child) {\n      if (child.type === 'stop') {\n        stops.push(child);\n      }\n    });\n    return _this29;\n  }\n\n  _createClass(GradientElement, [{\n    key: \"getGradientUnits\",\n    value: function getGradientUnits() {\n      return this.getAttribute('gradientUnits').getString('objectBoundingBox');\n    }\n  }, {\n    key: \"createGradient\",\n    value: function createGradient(ctx, element, parentOpacityProp) {\n      var _this30 = this;\n\n      // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n      var stopsContainer = this;\n\n      if (this.getHrefAttribute().hasValue()) {\n        stopsContainer = this.getHrefAttribute().getDefinition();\n        this.inheritStopContainer(stopsContainer);\n      }\n\n      var _stopsContainer = stopsContainer,\n          stops = _stopsContainer.stops;\n      var gradient = this.getGradient(ctx, element);\n\n      if (!gradient) {\n        return this.addParentOpacity(parentOpacityProp, stops[stops.length - 1].color);\n      }\n\n      stops.forEach(function (stop) {\n        gradient.addColorStop(stop.offset, _this30.addParentOpacity(parentOpacityProp, stop.color));\n      });\n\n      if (this.getAttribute('gradientTransform').hasValue()) {\n        // render as transformed pattern on temporary canvas\n        var document = this.document;\n        var _document$screen = document.screen,\n            MAX_VIRTUAL_PIXELS = _document$screen.MAX_VIRTUAL_PIXELS,\n            viewPort = _document$screen.viewPort;\n\n        var _viewPort$viewPorts = _slicedToArray(viewPort.viewPorts, 1),\n            rootView = _viewPort$viewPorts[0];\n\n        var rect = new RectElement(document, null);\n        rect.attributes.x = new Property(document, 'x', -MAX_VIRTUAL_PIXELS / 3.0);\n        rect.attributes.y = new Property(document, 'y', -MAX_VIRTUAL_PIXELS / 3.0);\n        rect.attributes.width = new Property(document, 'width', MAX_VIRTUAL_PIXELS);\n        rect.attributes.height = new Property(document, 'height', MAX_VIRTUAL_PIXELS);\n        var group = new GElement(document, null);\n        group.attributes.transform = new Property(document, 'transform', this.getAttribute('gradientTransform').getValue());\n        group.children = [rect];\n        var patternSvg = new SVGElement(document, null);\n        patternSvg.attributes.x = new Property(document, 'x', 0);\n        patternSvg.attributes.y = new Property(document, 'y', 0);\n        patternSvg.attributes.width = new Property(document, 'width', rootView.width);\n        patternSvg.attributes.height = new Property(document, 'height', rootView.height);\n        patternSvg.children = [group];\n        var patternCanvas = document.createCanvas(rootView.width, rootView.height);\n        var patternCtx = patternCanvas.getContext('2d');\n        patternCtx.fillStyle = gradient;\n        patternSvg.render(patternCtx);\n        return patternCtx.createPattern(patternCanvas, 'no-repeat');\n      }\n\n      return gradient;\n    }\n  }, {\n    key: \"inheritStopContainer\",\n    value: function inheritStopContainer(stopsContainer) {\n      var _this31 = this;\n\n      this.attributesToInherit.forEach(function (attributeToInherit) {\n        if (!_this31.getAttribute(attributeToInherit).hasValue() && stopsContainer.getAttribute(attributeToInherit).hasValue()) {\n          _this31.getAttribute(attributeToInherit, true).setValue(stopsContainer.getAttribute(attributeToInherit).getValue());\n        }\n      });\n    }\n  }, {\n    key: \"addParentOpacity\",\n    value: function addParentOpacity(parentOpacityProp, color) {\n      if (parentOpacityProp.hasValue()) {\n        var colorProp = new Property(this.document, 'color', color);\n        return colorProp.addOpacity(parentOpacityProp).getColor();\n      }\n\n      return color;\n    }\n  }]);\n\n  return GradientElement;\n}(Element);\n\nvar LinearGradientElement = /*#__PURE__*/function (_GradientElement) {\n  _inherits(LinearGradientElement, _GradientElement);\n\n  var _super24 = _createSuper(LinearGradientElement);\n\n  function LinearGradientElement(document, node, captureTextNodes) {\n    var _this32;\n\n    _classCallCheck(this, LinearGradientElement);\n\n    _this32 = _super24.call(this, document, node, captureTextNodes);\n    _this32.type = 'linearGradient';\n\n    _this32.attributesToInherit.push('x1', 'y1', 'x2', 'y2');\n\n    return _this32;\n  }\n\n  _createClass(LinearGradientElement, [{\n    key: \"getGradient\",\n    value: function getGradient(ctx, element) {\n      var isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox';\n      var boundingBox = isBoundingBoxUnits ? element.getBoundingBox(ctx) : null;\n\n      if (isBoundingBoxUnits && !boundingBox) {\n        return null;\n      }\n\n      if (!this.getAttribute('x1').hasValue() && !this.getAttribute('y1').hasValue() && !this.getAttribute('x2').hasValue() && !this.getAttribute('y2').hasValue()) {\n        this.getAttribute('x1', true).setValue(0);\n        this.getAttribute('y1', true).setValue(0);\n        this.getAttribute('x2', true).setValue(1);\n        this.getAttribute('y2', true).setValue(0);\n      }\n\n      var x1 = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('x1').getNumber() : this.getAttribute('x1').getPixels('x');\n      var y1 = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('y1').getNumber() : this.getAttribute('y1').getPixels('y');\n      var x2 = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('x2').getNumber() : this.getAttribute('x2').getPixels('x');\n      var y2 = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('y2').getNumber() : this.getAttribute('y2').getPixels('y');\n\n      if (x1 === x2 && y1 === y2) {\n        return null;\n      }\n\n      return ctx.createLinearGradient(x1, y1, x2, y2);\n    }\n  }]);\n\n  return LinearGradientElement;\n}(GradientElement);\n\nvar RadialGradientElement = /*#__PURE__*/function (_GradientElement2) {\n  _inherits(RadialGradientElement, _GradientElement2);\n\n  var _super25 = _createSuper(RadialGradientElement);\n\n  function RadialGradientElement(document, node, captureTextNodes) {\n    var _this33;\n\n    _classCallCheck(this, RadialGradientElement);\n\n    _this33 = _super25.call(this, document, node, captureTextNodes);\n    _this33.type = 'radialGradient';\n\n    _this33.attributesToInherit.push('cx', 'cy', 'r', 'fx', 'fy', 'fr');\n\n    return _this33;\n  }\n\n  _createClass(RadialGradientElement, [{\n    key: \"getGradient\",\n    value: function getGradient(ctx, element) {\n      var isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox';\n      var boundingBox = element.getBoundingBox(ctx);\n\n      if (isBoundingBoxUnits && !boundingBox) {\n        return null;\n      }\n\n      if (!this.getAttribute('cx').hasValue()) {\n        this.getAttribute('cx', true).setValue('50%');\n      }\n\n      if (!this.getAttribute('cy').hasValue()) {\n        this.getAttribute('cy', true).setValue('50%');\n      }\n\n      if (!this.getAttribute('r').hasValue()) {\n        this.getAttribute('r', true).setValue('50%');\n      }\n\n      var cx = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('cx').getNumber() : this.getAttribute('cx').getPixels('x');\n      var cy = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('cy').getNumber() : this.getAttribute('cy').getPixels('y');\n      var fx = cx;\n      var fy = cy;\n\n      if (this.getAttribute('fx').hasValue()) {\n        fx = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('fx').getNumber() : this.getAttribute('fx').getPixels('x');\n      }\n\n      if (this.getAttribute('fy').hasValue()) {\n        fy = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('fy').getNumber() : this.getAttribute('fy').getPixels('y');\n      }\n\n      var r = isBoundingBoxUnits ? (boundingBox.width + boundingBox.height) / 2.0 * this.getAttribute('r').getNumber() : this.getAttribute('r').getPixels();\n      var fr = this.getAttribute('fr').getPixels();\n      return ctx.createRadialGradient(fx, fy, fr, cx, cy, r);\n    }\n  }]);\n\n  return RadialGradientElement;\n}(GradientElement);\n\nvar StopElement = /*#__PURE__*/function (_Element7) {\n  _inherits(StopElement, _Element7);\n\n  var _super26 = _createSuper(StopElement);\n\n  function StopElement(document, node, captureTextNodes) {\n    var _this34;\n\n    _classCallCheck(this, StopElement);\n\n    _this34 = _super26.call(this, document, node, captureTextNodes);\n    _this34.type = 'stop';\n    var offset = Math.max(0, Math.min(1, _this34.getAttribute('offset').getNumber()));\n\n    var stopOpacity = _this34.getStyle('stop-opacity');\n\n    var stopColor = _this34.getStyle('stop-color', true);\n\n    if (stopColor.getString() === '') {\n      stopColor.setValue('#000');\n    }\n\n    if (stopOpacity.hasValue()) {\n      stopColor = stopColor.addOpacity(stopOpacity);\n    }\n\n    _this34.offset = offset;\n    _this34.color = stopColor.getColor();\n    return _this34;\n  }\n\n  return StopElement;\n}(Element);\n\nvar AnimateElement = /*#__PURE__*/function (_Element8) {\n  _inherits(AnimateElement, _Element8);\n\n  var _super27 = _createSuper(AnimateElement);\n\n  function AnimateElement(document, node, captureTextNodes) {\n    var _this35;\n\n    _classCallCheck(this, AnimateElement);\n\n    _this35 = _super27.call(this, document, node, captureTextNodes);\n    _this35.type = 'animate';\n    _this35.duration = 0;\n    _this35.initialValue = null;\n    _this35.initialUnits = '';\n    _this35.removed = false;\n    _this35.frozen = false;\n    document.screen.animations.push(_assertThisInitialized(_this35));\n    _this35.begin = _this35.getAttribute('begin').getMilliseconds();\n    _this35.maxDuration = _this35.begin + _this35.getAttribute('dur').getMilliseconds();\n    _this35.from = _this35.getAttribute('from');\n    _this35.to = _this35.getAttribute('to');\n    _this35.values = new Property(document, 'values', null);\n\n    var valuesAttr = _this35.getAttribute('values');\n\n    if (valuesAttr.hasValue()) {\n      _this35.values.setValue(valuesAttr.getString().split(';'));\n    }\n\n    return _this35;\n  }\n\n  _createClass(AnimateElement, [{\n    key: \"getProperty\",\n    value: function getProperty() {\n      var attributeType = this.getAttribute('attributeType').getString();\n      var attributeName = this.getAttribute('attributeName').getString();\n\n      if (attributeType === 'CSS') {\n        return this.parent.getStyle(attributeName, true);\n      }\n\n      return this.parent.getAttribute(attributeName, true);\n    }\n  }, {\n    key: \"calcValue\",\n    value: function calcValue() {\n      var initialUnits = this.initialUnits;\n\n      var _this$getProgress = this.getProgress(),\n          progress = _this$getProgress.progress,\n          from = _this$getProgress.from,\n          to = _this$getProgress.to; // tween value linearly\n\n\n      var newValue = from.getNumber() + (to.getNumber() - from.getNumber()) * progress;\n\n      if (initialUnits === '%') {\n        newValue *= 100.0; // numValue() returns 0-1 whereas properties are 0-100\n      }\n\n      return \"\".concat(newValue).concat(initialUnits);\n    }\n  }, {\n    key: \"update\",\n    value: function update(delta) {\n      var parent = this.parent;\n      var prop = this.getProperty(); // set initial value\n\n      if (!this.initialValue) {\n        this.initialValue = prop.getString();\n        this.initialUnits = prop.getUnits();\n      } // if we're past the end time\n\n\n      if (this.duration > this.maxDuration) {\n        var fill = this.getAttribute('fill').getString('remove'); // loop for indefinitely repeating animations\n\n        if (this.getAttribute('repeatCount').getString() === 'indefinite' || this.getAttribute('repeatDur').getString() === 'indefinite') {\n          this.duration = 0;\n        } else if (fill === 'freeze' && !this.frozen) {\n          this.frozen = true;\n          parent.animationFrozen = true;\n          parent.animationFrozenValue = prop.getString();\n        } else if (fill === 'remove' && !this.removed) {\n          this.removed = true;\n          prop.setValue(parent.animationFrozen ? parent.animationFrozenValue : this.initialValue);\n          return true;\n        }\n\n        return false;\n      }\n\n      this.duration += delta; // if we're past the begin time\n\n      var updated = false;\n\n      if (this.begin < this.duration) {\n        var newValue = this.calcValue(); // tween\n\n        var typeAttr = this.getAttribute('type');\n\n        if (typeAttr.hasValue()) {\n          // for transform, etc.\n          var type = typeAttr.getString();\n          newValue = \"\".concat(type, \"(\").concat(newValue, \")\");\n        }\n\n        prop.setValue(newValue);\n        updated = true;\n      }\n\n      return updated;\n    }\n  }, {\n    key: \"getProgress\",\n    value: function getProgress() {\n      var document = this.document,\n          values = this.values;\n      var result = {\n        progress: (this.duration - this.begin) / (this.maxDuration - this.begin)\n      };\n\n      if (values.hasValue()) {\n        var p = result.progress * (values.getValue().length - 1);\n        var lb = Math.floor(p);\n        var ub = Math.ceil(p);\n        result.from = new Property(document, 'from', parseFloat(values.getValue()[lb]));\n        result.to = new Property(document, 'to', parseFloat(values.getValue()[ub]));\n        result.progress = (p - lb) / (ub - lb);\n      } else {\n        result.from = this.from;\n        result.to = this.to;\n      }\n\n      return result;\n    }\n  }]);\n\n  return AnimateElement;\n}(Element);\n\nvar AnimateColorElement = /*#__PURE__*/function (_AnimateElement) {\n  _inherits(AnimateColorElement, _AnimateElement);\n\n  var _super28 = _createSuper(AnimateColorElement);\n\n  function AnimateColorElement() {\n    var _this36;\n\n    _classCallCheck(this, AnimateColorElement);\n\n    _this36 = _super28.apply(this, arguments);\n    _this36.type = 'animateColor';\n    return _this36;\n  }\n\n  _createClass(AnimateColorElement, [{\n    key: \"calcValue\",\n    value: function calcValue() {\n      var _this$getProgress2 = this.getProgress(),\n          progress = _this$getProgress2.progress,\n          from = _this$getProgress2.from,\n          to = _this$getProgress2.to;\n\n      var colorFrom = new RGBColor(from.getColor());\n      var colorTo = new RGBColor(to.getColor());\n\n      if (colorFrom.ok && colorTo.ok) {\n        // tween color linearly\n        var r = colorFrom.r + (colorTo.r - colorFrom.r) * progress;\n        var g = colorFrom.g + (colorTo.g - colorFrom.g) * progress;\n        var b = colorFrom.b + (colorTo.b - colorFrom.b) * progress; // ? alpha\n\n        return \"rgb(\".concat(Math.floor(r), \", \").concat(Math.floor(g), \", \").concat(Math.floor(b), \")\");\n      }\n\n      return this.getAttribute('from').getColor();\n    }\n  }]);\n\n  return AnimateColorElement;\n}(AnimateElement);\n\nvar AnimateTransformElement = /*#__PURE__*/function (_AnimateElement2) {\n  _inherits(AnimateTransformElement, _AnimateElement2);\n\n  var _super29 = _createSuper(AnimateTransformElement);\n\n  function AnimateTransformElement() {\n    var _this37;\n\n    _classCallCheck(this, AnimateTransformElement);\n\n    _this37 = _super29.apply(this, arguments);\n    _this37.type = 'animateTransform';\n    return _this37;\n  }\n\n  _createClass(AnimateTransformElement, [{\n    key: \"calcValue\",\n    value: function calcValue() {\n      var _this$getProgress3 = this.getProgress(),\n          progress = _this$getProgress3.progress,\n          from = _this$getProgress3.from,\n          to = _this$getProgress3.to; // tween value linearly\n\n\n      var transformFrom = toNumbers(from.getString());\n      var transformTo = toNumbers(to.getString());\n      var newValue = transformFrom.map(function (from, i) {\n        var to = transformTo[i];\n        return from + (to - from) * progress;\n      }).join(' ');\n      return newValue;\n    }\n  }]);\n\n  return AnimateTransformElement;\n}(AnimateElement);\n\nvar FontElement = /*#__PURE__*/function (_Element9) {\n  _inherits(FontElement, _Element9);\n\n  var _super30 = _createSuper(FontElement);\n\n  function FontElement(document, node, captureTextNodes) {\n    var _this38;\n\n    _classCallCheck(this, FontElement);\n\n    _this38 = _super30.call(this, document, node, captureTextNodes);\n    _this38.type = 'font';\n    _this38.glyphs = {};\n    _this38.horizAdvX = _this38.getAttribute('horiz-adv-x').getNumber();\n    var definitions = document.definitions;\n\n    var _assertThisInitialize2 = _assertThisInitialized(_this38),\n        children = _assertThisInitialize2.children;\n\n    var _iterator = _createForOfIteratorHelper(children),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var child = _step.value;\n\n        switch (child.type) {\n          case 'font-face':\n            {\n              _this38.fontFace = child;\n              var fontFamilyStyle = child.getStyle('font-family');\n\n              if (fontFamilyStyle.hasValue()) {\n                definitions[fontFamilyStyle.getString()] = _assertThisInitialized(_this38);\n              }\n\n              break;\n            }\n\n          case 'missing-glyph':\n            _this38.missingGlyph = child;\n            break;\n\n          case 'glyph':\n            {\n              var glyph = child;\n\n              if (glyph.arabicForm) {\n                _this38.isRTL = true;\n                _this38.isArabic = true;\n\n                if (typeof _this38.glyphs[glyph.unicode] === 'undefined') {\n                  _this38.glyphs[glyph.unicode] = {};\n                }\n\n                _this38.glyphs[glyph.unicode][glyph.arabicForm] = glyph;\n              } else {\n                _this38.glyphs[glyph.unicode] = glyph;\n              }\n\n              break;\n            }\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    return _this38;\n  }\n\n  _createClass(FontElement, [{\n    key: \"render\",\n    value: function render() {// NO RENDER\n    }\n  }]);\n\n  return FontElement;\n}(Element);\n\nvar FontFaceElement = /*#__PURE__*/function (_Element10) {\n  _inherits(FontFaceElement, _Element10);\n\n  var _super31 = _createSuper(FontFaceElement);\n\n  function FontFaceElement(document, node, captureTextNodes) {\n    var _this39;\n\n    _classCallCheck(this, FontFaceElement);\n\n    _this39 = _super31.call(this, document, node, captureTextNodes);\n    _this39.type = 'font-face';\n    _this39.ascent = _this39.getAttribute('ascent').getNumber();\n    _this39.descent = _this39.getAttribute('descent').getNumber();\n    _this39.unitsPerEm = _this39.getAttribute('units-per-em').getNumber();\n    return _this39;\n  }\n\n  return FontFaceElement;\n}(Element);\n\nvar MissingGlyphElement = /*#__PURE__*/function (_PathElement7) {\n  _inherits(MissingGlyphElement, _PathElement7);\n\n  var _super32 = _createSuper(MissingGlyphElement);\n\n  function MissingGlyphElement() {\n    var _this40;\n\n    _classCallCheck(this, MissingGlyphElement);\n\n    _this40 = _super32.apply(this, arguments);\n    _this40.type = 'missing-glyph';\n    _this40.horizAdvX = 0;\n    return _this40;\n  }\n\n  return MissingGlyphElement;\n}(PathElement);\n\nvar TRefElement = /*#__PURE__*/function (_TextElement2) {\n  _inherits(TRefElement, _TextElement2);\n\n  var _super33 = _createSuper(TRefElement);\n\n  function TRefElement() {\n    var _this41;\n\n    _classCallCheck(this, TRefElement);\n\n    _this41 = _super33.apply(this, arguments);\n    _this41.type = 'tref';\n    return _this41;\n  }\n\n  _createClass(TRefElement, [{\n    key: \"getText\",\n    value: function getText() {\n      var element = this.getHrefAttribute().getDefinition();\n\n      if (element) {\n        var firstChild = element.children[0];\n\n        if (firstChild) {\n          return firstChild.getText();\n        }\n      }\n\n      return '';\n    }\n  }]);\n\n  return TRefElement;\n}(TextElement);\n\nvar AElement = /*#__PURE__*/function (_TextElement3) {\n  _inherits(AElement, _TextElement3);\n\n  var _super34 = _createSuper(AElement);\n\n  function AElement(document, node, captureTextNodes) {\n    var _this42;\n\n    _classCallCheck(this, AElement);\n\n    _this42 = _super34.call(this, document, node, captureTextNodes);\n    _this42.type = 'a';\n    var childNodes = node.childNodes;\n    var firstChild = childNodes[0];\n    var hasText = childNodes.length > 0 && Array.from(childNodes).every(function (node) {\n      return node.nodeType === 3;\n    });\n    _this42.hasText = hasText;\n    _this42.text = hasText ? _this42.getTextFromNode(firstChild) : '';\n    return _this42;\n  }\n\n  _createClass(AElement, [{\n    key: \"getText\",\n    value: function getText() {\n      return this.text;\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      if (this.hasText) {\n        // render as text element\n        _get(_getPrototypeOf(AElement.prototype), \"renderChildren\", this).call(this, ctx);\n\n        var document = this.document,\n            x = this.x,\n            y = this.y;\n        var mouse = document.screen.mouse;\n        var fontSize = new Property(document, 'fontSize', Font.parse(document.ctx.font).fontSize); // Do not calc bounding box if mouse is not working.\n\n        if (mouse.isWorking()) {\n          mouse.checkBoundingBox(this, new BoundingBox(x, y - fontSize.getPixels('y'), x + this.measureText(ctx), y));\n        }\n      } else if (this.children.length > 0) {\n        // render as temporary group\n        var g = new GElement(this.document, null);\n        g.children = this.children;\n        g.parent = this;\n        g.render(ctx);\n      }\n    }\n  }, {\n    key: \"onClick\",\n    value: function onClick() {\n      var window = this.document.window;\n\n      if (window) {\n        window.open(this.getHrefAttribute().getString());\n      }\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove() {\n      var ctx = this.document.ctx;\n      ctx.canvas.style.cursor = 'pointer';\n    }\n  }]);\n\n  return AElement;\n}(TextElement);\n\nfunction ownKeys$2(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$2(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$2(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar TextPathElement = /*#__PURE__*/function (_TextElement4) {\n  _inherits(TextPathElement, _TextElement4);\n\n  var _super35 = _createSuper(TextPathElement);\n\n  function TextPathElement(document, node, captureTextNodes) {\n    var _this43;\n\n    _classCallCheck(this, TextPathElement);\n\n    _this43 = _super35.call(this, document, node, captureTextNodes);\n    _this43.type = 'textPath';\n    _this43.textWidth = 0;\n    _this43.textHeight = 0;\n    _this43.pathLength = -1;\n    _this43.glyphInfo = null;\n    _this43.letterSpacingCache = [];\n    _this43.measuresCache = new Map([['', 0]]);\n\n    var pathElement = _this43.getHrefAttribute().getDefinition();\n\n    _this43.text = _this43.getTextFromNode();\n    _this43.dataArray = _this43.parsePathData(pathElement);\n    return _this43;\n  }\n\n  _createClass(TextPathElement, [{\n    key: \"getText\",\n    value: function getText() {\n      return this.text;\n    }\n  }, {\n    key: \"path\",\n    value: function path(ctx) {\n      var dataArray = this.dataArray;\n\n      if (ctx) {\n        ctx.beginPath();\n      }\n\n      dataArray.forEach(function (_ref) {\n        var type = _ref.type,\n            points = _ref.points;\n\n        switch (type) {\n          case PathParser.LINE_TO:\n            if (ctx) {\n              ctx.lineTo(points[0], points[1]);\n            }\n\n            break;\n\n          case PathParser.MOVE_TO:\n            if (ctx) {\n              ctx.moveTo(points[0], points[1]);\n            }\n\n            break;\n\n          case PathParser.CURVE_TO:\n            if (ctx) {\n              ctx.bezierCurveTo(points[0], points[1], points[2], points[3], points[4], points[5]);\n            }\n\n            break;\n\n          case PathParser.QUAD_TO:\n            if (ctx) {\n              ctx.quadraticCurveTo(points[0], points[1], points[2], points[3]);\n            }\n\n            break;\n\n          case PathParser.ARC:\n            {\n              var _points2 = _slicedToArray(points, 8),\n                  cx = _points2[0],\n                  cy = _points2[1],\n                  rx = _points2[2],\n                  ry = _points2[3],\n                  theta = _points2[4],\n                  dTheta = _points2[5],\n                  psi = _points2[6],\n                  fs = _points2[7];\n\n              var r = rx > ry ? rx : ry;\n              var scaleX = rx > ry ? 1 : rx / ry;\n              var scaleY = rx > ry ? ry / rx : 1;\n\n              if (ctx) {\n                ctx.translate(cx, cy);\n                ctx.rotate(psi);\n                ctx.scale(scaleX, scaleY);\n                ctx.arc(0, 0, r, theta, theta + dTheta, Boolean(1 - fs));\n                ctx.scale(1 / scaleX, 1 / scaleY);\n                ctx.rotate(-psi);\n                ctx.translate(-cx, -cy);\n              }\n\n              break;\n            }\n\n          case PathParser.CLOSE_PATH:\n            if (ctx) {\n              ctx.closePath();\n            }\n\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      this.setTextData(ctx);\n      ctx.save();\n      var textDecoration = this.parent.getStyle('text-decoration').getString();\n      var fontSize = this.getFontSize();\n      var glyphInfo = this.glyphInfo;\n      var fill = ctx.fillStyle;\n\n      if (textDecoration === 'underline') {\n        ctx.beginPath();\n      }\n\n      glyphInfo.forEach(function (glyph, i) {\n        var p0 = glyph.p0,\n            p1 = glyph.p1,\n            rotation = glyph.rotation,\n            partialText = glyph.text;\n        ctx.save();\n        ctx.translate(p0.x, p0.y);\n        ctx.rotate(rotation);\n\n        if (ctx.fillStyle) {\n          ctx.fillText(partialText, 0, 0);\n        }\n\n        if (ctx.strokeStyle) {\n          ctx.strokeText(partialText, 0, 0);\n        }\n\n        ctx.restore();\n\n        if (textDecoration === 'underline') {\n          if (i === 0) {\n            ctx.moveTo(p0.x, p0.y + fontSize / 8);\n          }\n\n          ctx.lineTo(p1.x, p1.y + fontSize / 5);\n        } // // To assist with debugging visually, uncomment following\n        //\n        // ctx.beginPath();\n        // if (i % 2)\n        // \tctx.strokeStyle = 'red';\n        // else\n        // \tctx.strokeStyle = 'green';\n        // ctx.moveTo(p0.x, p0.y);\n        // ctx.lineTo(p1.x, p1.y);\n        // ctx.stroke();\n        // ctx.closePath();\n\n      });\n\n      if (textDecoration === 'underline') {\n        ctx.lineWidth = fontSize / 20;\n        ctx.strokeStyle = fill;\n        ctx.stroke();\n        ctx.closePath();\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: \"getLetterSpacingAt\",\n    value: function getLetterSpacingAt() {\n      var idx = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      return this.letterSpacingCache[idx] || 0;\n    }\n  }, {\n    key: \"findSegmentToFitChar\",\n    value: function findSegmentToFitChar(ctx, anchor, textFullWidth, fullPathWidth, spacesNumber, inputOffset, dy, c, charI) {\n      var offset = inputOffset;\n      var glyphWidth = this.measureText(ctx, c);\n\n      if (c === ' ' && anchor === 'justify' && textFullWidth < fullPathWidth) {\n        glyphWidth += (fullPathWidth - textFullWidth) / spacesNumber;\n      }\n\n      if (charI > -1) {\n        offset += this.getLetterSpacingAt(charI);\n      }\n\n      var splineStep = this.textHeight / 20;\n      var p0 = this.getEquidistantPointOnPath(offset, splineStep, 0);\n      var p1 = this.getEquidistantPointOnPath(offset + glyphWidth, splineStep, 0);\n      var segment = {\n        p0: p0,\n        p1: p1\n      };\n      var rotation = p0 && p1 ? Math.atan2(p1.y - p0.y, p1.x - p0.x) : 0;\n\n      if (dy) {\n        var dyX = Math.cos(Math.PI / 2 + rotation) * dy;\n        var dyY = Math.cos(-rotation) * dy;\n        segment.p0 = _objectSpread$2(_objectSpread$2({}, p0), {}, {\n          x: p0.x + dyX,\n          y: p0.y + dyY\n        });\n        segment.p1 = _objectSpread$2(_objectSpread$2({}, p1), {}, {\n          x: p1.x + dyX,\n          y: p1.y + dyY\n        });\n      }\n\n      offset += glyphWidth;\n      return {\n        offset: offset,\n        segment: segment,\n        rotation: rotation\n      };\n    }\n  }, {\n    key: \"measureText\",\n    value: function measureText(ctx, text) {\n      var measuresCache = this.measuresCache;\n      var targetText = text || this.getText();\n\n      if (measuresCache.has(targetText)) {\n        return measuresCache.get(targetText);\n      }\n\n      var measure = this.measureTargetText(ctx, targetText);\n      measuresCache.set(targetText, measure);\n      return measure;\n    } // This method supposes what all custom fonts already loaded.\n    // If some font will be loaded after this method call, <textPath> will not be rendered correctly.\n    // You need to call this method manually to update glyphs cache.\n\n  }, {\n    key: \"setTextData\",\n    value: function setTextData(ctx) {\n      var _this44 = this;\n\n      if (this.glyphInfo) {\n        return;\n      }\n\n      var renderText = this.getText();\n      var chars = renderText.split('');\n      var spacesNumber = renderText.split(' ').length - 1;\n      var dx = this.parent.getAttribute('dx').split().map(function (_) {\n        return _.getPixels('x');\n      });\n      var dy = this.parent.getAttribute('dy').getPixels('y');\n      var anchor = this.parent.getStyle('text-anchor').getString('start');\n      var thisSpacing = this.getStyle('letter-spacing');\n      var parentSpacing = this.parent.getStyle('letter-spacing');\n      var letterSpacing = 0;\n\n      if (!thisSpacing.hasValue() || thisSpacing.getValue() === 'inherit') {\n        letterSpacing = parentSpacing.getPixels();\n      } else if (thisSpacing.hasValue()) {\n        if (thisSpacing.getValue() !== 'initial' && thisSpacing.getValue() !== 'unset') {\n          letterSpacing = thisSpacing.getPixels();\n        }\n      } // fill letter-spacing cache\n\n\n      var letterSpacingCache = [];\n      var textLen = renderText.length;\n      this.letterSpacingCache = letterSpacingCache;\n\n      for (var i = 0; i < textLen; i++) {\n        letterSpacingCache.push(typeof dx[i] !== 'undefined' ? dx[i] : letterSpacing);\n      }\n\n      var dxSum = letterSpacingCache.reduce(function (acc, cur, i) {\n        return i === 0 ? 0 : acc + cur || 0;\n      }, 0);\n      var textWidth = this.measureText(ctx);\n      var textFullWidth = Math.max(textWidth + dxSum, 0);\n      this.textWidth = textWidth;\n      this.textHeight = this.getFontSize();\n      this.glyphInfo = [];\n      var fullPathWidth = this.getPathLength();\n      var startOffset = this.getStyle('startOffset').getNumber(0) * fullPathWidth;\n      var offset = 0;\n\n      if (anchor === 'middle' || anchor === 'center') {\n        offset = -textFullWidth / 2;\n      }\n\n      if (anchor === 'end' || anchor === 'right') {\n        offset = -textFullWidth;\n      }\n\n      offset += startOffset;\n      chars.forEach(function (char, i) {\n        // Find such segment what distance between p0 and p1 is approx. width of glyph\n        var _this44$findSegmentTo = _this44.findSegmentToFitChar(ctx, anchor, textFullWidth, fullPathWidth, spacesNumber, offset, dy, char, i),\n            nextOffset = _this44$findSegmentTo.offset,\n            segment = _this44$findSegmentTo.segment,\n            rotation = _this44$findSegmentTo.rotation;\n\n        offset = nextOffset;\n\n        if (!segment.p0 || !segment.p1) {\n          return;\n        } // const width = this.getLineLength(\n        // \tsegment.p0.x,\n        // \tsegment.p0.y,\n        // \tsegment.p1.x,\n        // \tsegment.p1.y\n        // );\n        // Note: Since glyphs are rendered one at a time, any kerning pair data built into the font will not be used.\n        // Can foresee having a rough pair table built in that the developer can override as needed.\n        // Or use \"dx\" attribute of the <text> node as a naive replacement\n        // const kern = 0;\n        // placeholder for future implementation\n        // const midpoint = this.getPointOnLine(\n        // \tkern + width / 2.0,\n        // \tsegment.p0.x, segment.p0.y, segment.p1.x, segment.p1.y\n        // );\n\n\n        _this44.glyphInfo.push({\n          // transposeX: midpoint.x,\n          // transposeY: midpoint.y,\n          text: chars[i],\n          p0: segment.p0,\n          p1: segment.p1,\n          rotation: rotation\n        });\n      });\n    }\n  }, {\n    key: \"parsePathData\",\n    value: function parsePathData(path) {\n      this.pathLength = -1; // reset path length\n\n      if (!path) {\n        return [];\n      }\n\n      var pathCommands = [];\n      var pathParser = path.pathParser;\n      pathParser.reset(); // convert l, H, h, V, and v to L\n\n      while (!pathParser.isEnd()) {\n        var current = pathParser.current;\n        var startX = current ? current.x : 0;\n        var startY = current ? current.y : 0;\n        var command = pathParser.next();\n        var nextCommandType = command.type;\n        var points = [];\n\n        switch (command.type) {\n          case PathParser.MOVE_TO:\n            this.pathM(pathParser, points);\n            break;\n\n          case PathParser.LINE_TO:\n            nextCommandType = this.pathL(pathParser, points);\n            break;\n\n          case PathParser.HORIZ_LINE_TO:\n            nextCommandType = this.pathH(pathParser, points);\n            break;\n\n          case PathParser.VERT_LINE_TO:\n            nextCommandType = this.pathV(pathParser, points);\n            break;\n\n          case PathParser.CURVE_TO:\n            this.pathC(pathParser, points);\n            break;\n\n          case PathParser.SMOOTH_CURVE_TO:\n            nextCommandType = this.pathS(pathParser, points);\n            break;\n\n          case PathParser.QUAD_TO:\n            this.pathQ(pathParser, points);\n            break;\n\n          case PathParser.SMOOTH_QUAD_TO:\n            nextCommandType = this.pathT(pathParser, points);\n            break;\n\n          case PathParser.ARC:\n            points = this.pathA(pathParser);\n            break;\n\n          case PathParser.CLOSE_PATH:\n            PathElement.pathZ(pathParser);\n            break;\n        }\n\n        if (command.type !== PathParser.CLOSE_PATH) {\n          pathCommands.push({\n            type: nextCommandType,\n            points: points,\n            start: {\n              x: startX,\n              y: startY\n            },\n            pathLength: this.calcLength(startX, startY, nextCommandType, points)\n          });\n        } else {\n          pathCommands.push({\n            type: PathParser.CLOSE_PATH,\n            points: [],\n            pathLength: 0\n          });\n        }\n      }\n\n      return pathCommands;\n    }\n  }, {\n    key: \"pathM\",\n    value: function pathM(pathParser, points) {\n      var _PathElement$pathM$po = PathElement.pathM(pathParser).point,\n          x = _PathElement$pathM$po.x,\n          y = _PathElement$pathM$po.y;\n      points.push(x, y);\n    }\n  }, {\n    key: \"pathL\",\n    value: function pathL(pathParser, points) {\n      var _PathElement$pathL$po = PathElement.pathL(pathParser).point,\n          x = _PathElement$pathL$po.x,\n          y = _PathElement$pathL$po.y;\n      points.push(x, y);\n      return PathParser.LINE_TO;\n    }\n  }, {\n    key: \"pathH\",\n    value: function pathH(pathParser, points) {\n      var _PathElement$pathH$po = PathElement.pathH(pathParser).point,\n          x = _PathElement$pathH$po.x,\n          y = _PathElement$pathH$po.y;\n      points.push(x, y);\n      return PathParser.LINE_TO;\n    }\n  }, {\n    key: \"pathV\",\n    value: function pathV(pathParser, points) {\n      var _PathElement$pathV$po = PathElement.pathV(pathParser).point,\n          x = _PathElement$pathV$po.x,\n          y = _PathElement$pathV$po.y;\n      points.push(x, y);\n      return PathParser.LINE_TO;\n    }\n  }, {\n    key: \"pathC\",\n    value: function pathC(pathParser, points) {\n      var _PathElement$pathC2 = PathElement.pathC(pathParser),\n          point = _PathElement$pathC2.point,\n          controlPoint = _PathElement$pathC2.controlPoint,\n          currentPoint = _PathElement$pathC2.currentPoint;\n\n      points.push(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }, {\n    key: \"pathS\",\n    value: function pathS(pathParser, points) {\n      var _PathElement$pathS2 = PathElement.pathS(pathParser),\n          point = _PathElement$pathS2.point,\n          controlPoint = _PathElement$pathS2.controlPoint,\n          currentPoint = _PathElement$pathS2.currentPoint;\n\n      points.push(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      return PathParser.CURVE_TO;\n    }\n  }, {\n    key: \"pathQ\",\n    value: function pathQ(pathParser, points) {\n      var _PathElement$pathQ2 = PathElement.pathQ(pathParser),\n          controlPoint = _PathElement$pathQ2.controlPoint,\n          currentPoint = _PathElement$pathQ2.currentPoint;\n\n      points.push(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }, {\n    key: \"pathT\",\n    value: function pathT(pathParser, points) {\n      var _PathElement$pathT2 = PathElement.pathT(pathParser),\n          controlPoint = _PathElement$pathT2.controlPoint,\n          currentPoint = _PathElement$pathT2.currentPoint;\n\n      points.push(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      return PathParser.QUAD_TO;\n    }\n  }, {\n    key: \"pathA\",\n    value: function pathA(pathParser) {\n      var _PathElement$pathA2 = PathElement.pathA(pathParser),\n          rX = _PathElement$pathA2.rX,\n          rY = _PathElement$pathA2.rY,\n          sweepFlag = _PathElement$pathA2.sweepFlag,\n          xAxisRotation = _PathElement$pathA2.xAxisRotation,\n          centp = _PathElement$pathA2.centp,\n          a1 = _PathElement$pathA2.a1,\n          ad = _PathElement$pathA2.ad;\n\n      if (sweepFlag === 0 && ad > 0) {\n        ad -= 2 * Math.PI;\n      }\n\n      if (sweepFlag === 1 && ad < 0) {\n        ad += 2 * Math.PI;\n      }\n\n      return [centp.x, centp.y, rX, rY, a1, ad, xAxisRotation, sweepFlag];\n    }\n  }, {\n    key: \"calcLength\",\n    value: function calcLength(x, y, commandType, points) {\n      var len = 0;\n      var p1 = null;\n      var p2 = null;\n      var t = 0;\n\n      switch (commandType) {\n        case PathParser.LINE_TO:\n          return this.getLineLength(x, y, points[0], points[1]);\n\n        case PathParser.CURVE_TO:\n          // Approximates by breaking curve into 100 line segments\n          len = 0.0;\n          p1 = this.getPointOnCubicBezier(0, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n\n          for (t = 0.01; t <= 1; t += 0.01) {\n            p2 = this.getPointOnCubicBezier(t, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n            len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n            p1 = p2;\n          }\n\n          return len;\n\n        case PathParser.QUAD_TO:\n          // Approximates by breaking curve into 100 line segments\n          len = 0.0;\n          p1 = this.getPointOnQuadraticBezier(0, x, y, points[0], points[1], points[2], points[3]);\n\n          for (t = 0.01; t <= 1; t += 0.01) {\n            p2 = this.getPointOnQuadraticBezier(t, x, y, points[0], points[1], points[2], points[3]);\n            len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n            p1 = p2;\n          }\n\n          return len;\n\n        case PathParser.ARC:\n          {\n            // Approximates by breaking curve into line segments\n            len = 0.0;\n            var start = points[4]; // 4 = theta\n\n            var dTheta = points[5]; // 5 = dTheta\n\n            var end = points[4] + dTheta;\n            var inc = Math.PI / 180.0; // 1 degree resolution\n\n            if (Math.abs(start - end) < inc) {\n              inc = Math.abs(start - end);\n            } // Note: for purpose of calculating arc length, not going to worry about rotating X-axis by angle psi\n\n\n            p1 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], start, 0);\n\n            if (dTheta < 0) {\n              // clockwise\n              for (t = start - inc; t > end; t -= inc) {\n                p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n                len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                p1 = p2;\n              }\n            } else {\n              // counter-clockwise\n              for (t = start + inc; t < end; t += inc) {\n                p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n                len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                p1 = p2;\n              }\n            }\n\n            p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], end, 0);\n            len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n            return len;\n          }\n      }\n\n      return 0;\n    }\n  }, {\n    key: \"getPointOnLine\",\n    value: function getPointOnLine(dist, p1x, p1y, p2x, p2y) {\n      var fromX = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : p1x;\n      var fromY = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : p1y;\n      var m = (p2y - p1y) / (p2x - p1x + PSEUDO_ZERO);\n      var run = Math.sqrt(dist * dist / (1 + m * m));\n\n      if (p2x < p1x) {\n        run *= -1;\n      }\n\n      var rise = m * run;\n      var pt = null;\n\n      if (p2x === p1x) {\n        // vertical line\n        pt = {\n          x: fromX,\n          y: fromY + rise\n        };\n      } else if ((fromY - p1y) / (fromX - p1x + PSEUDO_ZERO) === m) {\n        pt = {\n          x: fromX + run,\n          y: fromY + rise\n        };\n      } else {\n        var ix = 0;\n        var iy = 0;\n        var len = this.getLineLength(p1x, p1y, p2x, p2y);\n\n        if (len < PSEUDO_ZERO) {\n          return null;\n        }\n\n        var u = (fromX - p1x) * (p2x - p1x) + (fromY - p1y) * (p2y - p1y);\n        u /= len * len;\n        ix = p1x + u * (p2x - p1x);\n        iy = p1y + u * (p2y - p1y);\n        var pRise = this.getLineLength(fromX, fromY, ix, iy);\n        var pRun = Math.sqrt(dist * dist - pRise * pRise);\n        run = Math.sqrt(pRun * pRun / (1 + m * m));\n\n        if (p2x < p1x) {\n          run *= -1;\n        }\n\n        rise = m * run;\n        pt = {\n          x: ix + run,\n          y: iy + rise\n        };\n      }\n\n      return pt;\n    }\n  }, {\n    key: \"getPointOnPath\",\n    value: function getPointOnPath(distance) {\n      var fullLen = this.getPathLength();\n      var cumulativePathLength = 0;\n      var p = null;\n\n      if (distance < -0.00005 || distance - 0.00005 > fullLen) {\n        return null;\n      }\n\n      var dataArray = this.dataArray;\n\n      var _iterator2 = _createForOfIteratorHelper(dataArray),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var command = _step2.value;\n\n          if (command && (command.pathLength < 0.00005 || cumulativePathLength + command.pathLength + 0.00005 < distance)) {\n            cumulativePathLength += command.pathLength;\n            continue;\n          }\n\n          var delta = distance - cumulativePathLength;\n          var currentT = 0;\n\n          switch (command.type) {\n            case PathParser.LINE_TO:\n              p = this.getPointOnLine(delta, command.start.x, command.start.y, command.points[0], command.points[1], command.start.x, command.start.y);\n              break;\n\n            case PathParser.ARC:\n              {\n                var start = command.points[4]; // 4 = theta\n\n                var dTheta = command.points[5]; // 5 = dTheta\n\n                var end = command.points[4] + dTheta;\n                currentT = start + delta / command.pathLength * dTheta;\n\n                if (dTheta < 0 && currentT < end || dTheta >= 0 && currentT > end) {\n                  break;\n                }\n\n                p = this.getPointOnEllipticalArc(command.points[0], command.points[1], command.points[2], command.points[3], currentT, command.points[6]);\n                break;\n              }\n\n            case PathParser.CURVE_TO:\n              currentT = delta / command.pathLength;\n\n              if (currentT > 1) {\n                currentT = 1;\n              }\n\n              p = this.getPointOnCubicBezier(currentT, command.start.x, command.start.y, command.points[0], command.points[1], command.points[2], command.points[3], command.points[4], command.points[5]);\n              break;\n\n            case PathParser.QUAD_TO:\n              currentT = delta / command.pathLength;\n\n              if (currentT > 1) {\n                currentT = 1;\n              }\n\n              p = this.getPointOnQuadraticBezier(currentT, command.start.x, command.start.y, command.points[0], command.points[1], command.points[2], command.points[3]);\n              break;\n          }\n\n          if (p) {\n            return p;\n          }\n\n          break;\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getLineLength\",\n    value: function getLineLength(x1, y1, x2, y2) {\n      return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    }\n  }, {\n    key: \"getPathLength\",\n    value: function getPathLength() {\n      if (this.pathLength === -1) {\n        this.pathLength = this.dataArray.reduce(function (length, command) {\n          return command.pathLength > 0 ? length + command.pathLength : length;\n        }, 0);\n      }\n\n      return this.pathLength;\n    }\n  }, {\n    key: \"getPointOnCubicBezier\",\n    value: function getPointOnCubicBezier(pct, p1x, p1y, p2x, p2y, p3x, p3y, p4x, p4y) {\n      var x = p4x * CB1(pct) + p3x * CB2(pct) + p2x * CB3(pct) + p1x * CB4(pct);\n      var y = p4y * CB1(pct) + p3y * CB2(pct) + p2y * CB3(pct) + p1y * CB4(pct);\n      return {\n        x: x,\n        y: y\n      };\n    }\n  }, {\n    key: \"getPointOnQuadraticBezier\",\n    value: function getPointOnQuadraticBezier(pct, p1x, p1y, p2x, p2y, p3x, p3y) {\n      var x = p3x * QB1(pct) + p2x * QB2(pct) + p1x * QB3(pct);\n      var y = p3y * QB1(pct) + p2y * QB2(pct) + p1y * QB3(pct);\n      return {\n        x: x,\n        y: y\n      };\n    }\n  }, {\n    key: \"getPointOnEllipticalArc\",\n    value: function getPointOnEllipticalArc(cx, cy, rx, ry, theta, psi) {\n      var cosPsi = Math.cos(psi);\n      var sinPsi = Math.sin(psi);\n      var pt = {\n        x: rx * Math.cos(theta),\n        y: ry * Math.sin(theta)\n      };\n      return {\n        x: cx + (pt.x * cosPsi - pt.y * sinPsi),\n        y: cy + (pt.x * sinPsi + pt.y * cosPsi)\n      };\n    } // TODO need some optimisations. possibly build cache only for curved segments?\n\n  }, {\n    key: \"buildEquidistantCache\",\n    value: function buildEquidistantCache(inputStep, inputPrecision) {\n      var fullLen = this.getPathLength();\n      var precision = inputPrecision || 0.25; // accuracy vs performance\n\n      var step = inputStep || fullLen / 100;\n\n      if (!this.equidistantCache || this.equidistantCache.step !== step || this.equidistantCache.precision !== precision) {\n        // Prepare cache\n        this.equidistantCache = {\n          step: step,\n          precision: precision,\n          points: []\n        }; // Calculate points\n\n        var s = 0;\n\n        for (var l = 0; l <= fullLen; l += precision) {\n          var p0 = this.getPointOnPath(l);\n          var p1 = this.getPointOnPath(l + precision);\n\n          if (!p0 || !p1) {\n            continue;\n          }\n\n          s += this.getLineLength(p0.x, p0.y, p1.x, p1.y);\n\n          if (s >= step) {\n            this.equidistantCache.points.push({\n              x: p0.x,\n              y: p0.y,\n              distance: l\n            });\n            s -= step;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"getEquidistantPointOnPath\",\n    value: function getEquidistantPointOnPath(targetDistance, step, precision) {\n      this.buildEquidistantCache(step, precision);\n\n      if (targetDistance < 0 || targetDistance - this.getPathLength() > 0.00005) {\n        return null;\n      }\n\n      var idx = Math.round(targetDistance / this.getPathLength() * (this.equidistantCache.points.length - 1));\n      return this.equidistantCache.points[idx] || null;\n    }\n  }]);\n\n  return TextPathElement;\n}(TextElement);\n\nvar dataUriRegex = /^\\s*data:(([^/,;]+\\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;\n\nvar ImageElement = /*#__PURE__*/function (_RenderedElement5) {\n  _inherits(ImageElement, _RenderedElement5);\n\n  var _super36 = _createSuper(ImageElement);\n\n  function ImageElement(document, node, captureTextNodes) {\n    var _this45;\n\n    _classCallCheck(this, ImageElement);\n\n    _this45 = _super36.call(this, document, node, captureTextNodes);\n    _this45.type = 'image';\n    _this45.loaded = false;\n\n    var href = _this45.getHrefAttribute().getString();\n\n    if (!href) {\n      return _possibleConstructorReturn(_this45);\n    }\n\n    var isSvg = href.endsWith('.svg') || /^\\s*data:image\\/svg\\+xml/i.test(href);\n    document.images.push(_assertThisInitialized(_this45));\n\n    if (!isSvg) {\n      void _this45.loadImage(href);\n    } else {\n      void _this45.loadSvg(href);\n    }\n\n    _this45.isSvg = isSvg;\n    return _this45;\n  }\n\n  _createClass(ImageElement, [{\n    key: \"loadImage\",\n    value: function loadImage(href) {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var image;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return _this.document.createImage(href);\n\n              case 3:\n                image = _context4.sent;\n                _this.image = image;\n                _context4.next = 10;\n                break;\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4[\"catch\"](0);\n                console.error(\"Error while loading image \\\"\".concat(href, \"\\\":\"), _context4.t0);\n\n              case 10:\n                _this.loaded = true;\n\n              case 11:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[0, 7]]);\n      }))();\n    }\n  }, {\n    key: \"loadSvg\",\n    value: function loadSvg(href) {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var match, data, response, svg;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                match = dataUriRegex.exec(href);\n\n                if (!match) {\n                  _context5.next = 6;\n                  break;\n                }\n\n                data = match[5];\n\n                if (match[4] === 'base64') {\n                  _this2.image = atob(data);\n                } else {\n                  _this2.image = decodeURIComponent(data);\n                }\n\n                _context5.next = 19;\n                break;\n\n              case 6:\n                _context5.prev = 6;\n                _context5.next = 9;\n                return _this2.document.fetch(href);\n\n              case 9:\n                response = _context5.sent;\n                _context5.next = 12;\n                return response.text();\n\n              case 12:\n                svg = _context5.sent;\n                _this2.image = svg;\n                _context5.next = 19;\n                break;\n\n              case 16:\n                _context5.prev = 16;\n                _context5.t0 = _context5[\"catch\"](6);\n                console.error(\"Error while loading image \\\"\".concat(href, \"\\\":\"), _context5.t0);\n\n              case 19:\n                _this2.loaded = true;\n\n              case 20:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[6, 16]]);\n      }))();\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      var document = this.document,\n          image = this.image,\n          loaded = this.loaded;\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width').getPixels('x');\n      var height = this.getStyle('height').getPixels('y');\n\n      if (!loaded || !image || !width || !height) {\n        return;\n      }\n\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (this.isSvg) {\n        var subDocument = document.canvg.forkString(ctx, this.image, {\n          ignoreMouse: true,\n          ignoreAnimation: true,\n          ignoreDimensions: true,\n          ignoreClear: true,\n          offsetX: 0,\n          offsetY: 0,\n          scaleWidth: width,\n          scaleHeight: height\n        });\n        subDocument.document.documentElement.parent = this;\n        void subDocument.render();\n      } else {\n        var _image = this.image;\n        document.setViewBox({\n          ctx: ctx,\n          aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n          width: width,\n          desiredWidth: _image.width,\n          height: height,\n          desiredHeight: _image.height\n        });\n\n        if (this.loaded) {\n          if (typeof _image.complete === 'undefined' || _image.complete) {\n            ctx.drawImage(_image, 0, 0);\n          }\n        }\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox() {\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width').getPixels('x');\n      var height = this.getStyle('height').getPixels('y');\n      return new BoundingBox(x, y, x + width, y + height);\n    }\n  }]);\n\n  return ImageElement;\n}(RenderedElement);\n\nvar SymbolElement = /*#__PURE__*/function (_RenderedElement6) {\n  _inherits(SymbolElement, _RenderedElement6);\n\n  var _super37 = _createSuper(SymbolElement);\n\n  function SymbolElement() {\n    var _this46;\n\n    _classCallCheck(this, SymbolElement);\n\n    _this46 = _super37.apply(this, arguments);\n    _this46.type = 'symbol';\n    return _this46;\n  }\n\n  _createClass(SymbolElement, [{\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return SymbolElement;\n}(RenderedElement);\n\nvar SVGFontLoader = /*#__PURE__*/function () {\n  function SVGFontLoader(document) {\n    _classCallCheck(this, SVGFontLoader);\n\n    this.document = document;\n    this.loaded = false;\n    document.fonts.push(this);\n  }\n\n  _createClass(SVGFontLoader, [{\n    key: \"load\",\n    value: function load(fontFamily, url) {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n        var document, svgDocument, fonts;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.prev = 0;\n                document = _this.document;\n                _context6.next = 4;\n                return document.canvg.parser.load(url);\n\n              case 4:\n                svgDocument = _context6.sent;\n                fonts = svgDocument.getElementsByTagName('font');\n                Array.from(fonts).forEach(function (fontNode) {\n                  var font = document.createElement(fontNode);\n                  document.definitions[fontFamily] = font;\n                });\n                _context6.next = 12;\n                break;\n\n              case 9:\n                _context6.prev = 9;\n                _context6.t0 = _context6[\"catch\"](0);\n                console.error(\"Error while loading font \\\"\".concat(url, \"\\\":\"), _context6.t0);\n\n              case 12:\n                _this.loaded = true;\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[0, 9]]);\n      }))();\n    }\n  }]);\n\n  return SVGFontLoader;\n}();\n\nvar StyleElement = /*#__PURE__*/function (_Element11) {\n  _inherits(StyleElement, _Element11);\n\n  var _super38 = _createSuper(StyleElement);\n\n  function StyleElement(document, node, captureTextNodes) {\n    var _this47;\n\n    _classCallCheck(this, StyleElement);\n\n    _this47 = _super38.call(this, document, node, captureTextNodes);\n    _this47.type = 'style';\n    var css = compressSpaces(Array.from(node.childNodes) // NEED TEST\n    .map(function (_) {\n      return _.textContent;\n    }).join('').replace(/(\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+\\/)|(^[\\s]*\\/\\/.*)/gm, '') // remove comments\n    .replace(/@import.*;/g, '') // remove imports\n    );\n    var cssDefs = css.split('}');\n    cssDefs.forEach(function (_) {\n      var def = _.trim();\n\n      if (!def) {\n        return;\n      }\n\n      var cssParts = def.split('{');\n      var cssClasses = cssParts[0].split(',');\n      var cssProps = cssParts[1].split(';');\n      cssClasses.forEach(function (_) {\n        var cssClass = _.trim();\n\n        if (!cssClass) {\n          return;\n        }\n\n        var props = document.styles[cssClass] || {};\n        cssProps.forEach(function (cssProp) {\n          var prop = cssProp.indexOf(':');\n          var name = cssProp.substr(0, prop).trim();\n          var value = cssProp.substr(prop + 1, cssProp.length - prop).trim();\n\n          if (name && value) {\n            props[name] = new Property(document, name, value);\n          }\n        });\n        document.styles[cssClass] = props;\n        document.stylesSpecificity[cssClass] = getSelectorSpecificity(cssClass);\n\n        if (cssClass === '@font-face') {\n          //  && !nodeEnv\n          var fontFamily = props['font-family'].getString().replace(/\"|'/g, '');\n          var srcs = props.src.getString().split(',');\n          srcs.forEach(function (src) {\n            if (src.indexOf('format(\"svg\")') > 0) {\n              var url = parseExternalUrl(src);\n\n              if (url) {\n                void new SVGFontLoader(document).load(fontFamily, url);\n              }\n            }\n          });\n        }\n      });\n    });\n    return _this47;\n  }\n\n  return StyleElement;\n}(Element);\n\nStyleElement.parseExternalUrl = parseExternalUrl;\n\nvar UseElement = /*#__PURE__*/function (_RenderedElement7) {\n  _inherits(UseElement, _RenderedElement7);\n\n  var _super39 = _createSuper(UseElement);\n\n  function UseElement() {\n    var _this48;\n\n    _classCallCheck(this, UseElement);\n\n    _this48 = _super39.apply(this, arguments);\n    _this48.type = 'use';\n    return _this48;\n  }\n\n  _createClass(UseElement, [{\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      _get(_getPrototypeOf(UseElement.prototype), \"setContext\", this).call(this, ctx);\n\n      var xAttr = this.getAttribute('x');\n      var yAttr = this.getAttribute('y');\n\n      if (xAttr.hasValue()) {\n        ctx.translate(xAttr.getPixels('x'), 0);\n      }\n\n      if (yAttr.hasValue()) {\n        ctx.translate(0, yAttr.getPixels('y'));\n      }\n    }\n  }, {\n    key: \"path\",\n    value: function path(ctx) {\n      var element = this.element;\n\n      if (element) {\n        element.path(ctx);\n      }\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      var document = this.document,\n          element = this.element;\n\n      if (element) {\n        var tempSvg = element;\n\n        if (element.type === 'symbol') {\n          // render me using a temporary svg element in symbol cases (http://www.w3.org/TR/SVG/struct.html#UseElement)\n          tempSvg = new SVGElement(document, null);\n          tempSvg.attributes.viewBox = new Property(document, 'viewBox', element.getAttribute('viewBox').getString());\n          tempSvg.attributes.preserveAspectRatio = new Property(document, 'preserveAspectRatio', element.getAttribute('preserveAspectRatio').getString());\n          tempSvg.attributes.overflow = new Property(document, 'overflow', element.getAttribute('overflow').getString());\n          tempSvg.children = element.children; // element is still the parent of the children\n\n          element.styles.opacity = new Property(document, 'opacity', this.calculateOpacity());\n        }\n\n        if (tempSvg.type === 'svg') {\n          var widthStyle = this.getStyle('width', false, true);\n          var heightStyle = this.getStyle('height', false, true); // if symbol or svg, inherit width/height from me\n\n          if (widthStyle.hasValue()) {\n            tempSvg.attributes.width = new Property(document, 'width', widthStyle.getString());\n          }\n\n          if (heightStyle.hasValue()) {\n            tempSvg.attributes.height = new Property(document, 'height', heightStyle.getString());\n          }\n        }\n\n        var oldParent = tempSvg.parent;\n        tempSvg.parent = this;\n        tempSvg.render(ctx);\n        tempSvg.parent = oldParent;\n      }\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(ctx) {\n      var element = this.element;\n\n      if (element) {\n        return element.getBoundingBox(ctx);\n      }\n\n      return null;\n    }\n  }, {\n    key: \"elementTransform\",\n    value: function elementTransform() {\n      var document = this.document,\n          element = this.element;\n      return Transform.fromElement(document, element);\n    }\n  }, {\n    key: \"element\",\n    get: function get() {\n      if (!this.cachedElement) {\n        this.cachedElement = this.getHrefAttribute().getDefinition();\n      }\n\n      return this.cachedElement;\n    }\n  }]);\n\n  return UseElement;\n}(RenderedElement);\n\nfunction imGet(img, x, y, width, _height, rgba) {\n  return img[y * width * 4 + x * 4 + rgba];\n}\n\nfunction imSet(img, x, y, width, _height, rgba, val) {\n  img[y * width * 4 + x * 4 + rgba] = val;\n}\n\nfunction m(matrix, i, v) {\n  var mi = matrix[i];\n  return mi * v;\n}\n\nfunction c(a, m1, m2, m3) {\n  return m1 + Math.cos(a) * m2 + Math.sin(a) * m3;\n}\n\nvar FeColorMatrixElement = /*#__PURE__*/function (_Element12) {\n  _inherits(FeColorMatrixElement, _Element12);\n\n  var _super40 = _createSuper(FeColorMatrixElement);\n\n  function FeColorMatrixElement(document, node, captureTextNodes) {\n    var _this49;\n\n    _classCallCheck(this, FeColorMatrixElement);\n\n    _this49 = _super40.call(this, document, node, captureTextNodes);\n    _this49.type = 'feColorMatrix';\n    var matrix = toNumbers(_this49.getAttribute('values').getString());\n\n    switch (_this49.getAttribute('type').getString('matrix')) {\n      // http://www.w3.org/TR/SVG/filters.html#feColorMatrixElement\n      case 'saturate':\n        {\n          var s = matrix[0];\n          /* eslint-disable array-element-newline */\n\n          matrix = [0.213 + 0.787 * s, 0.715 - 0.715 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 + 0.285 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 - 0.715 * s, 0.072 + 0.928 * s, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n          /* eslint-enable array-element-newline */\n\n          break;\n        }\n\n      case 'hueRotate':\n        {\n          var a = matrix[0] * Math.PI / 180.0;\n          /* eslint-disable array-element-newline */\n\n          matrix = [c(a, 0.213, 0.787, -0.213), c(a, 0.715, -0.715, -0.715), c(a, 0.072, -0.072, 0.928), 0, 0, c(a, 0.213, -0.213, 0.143), c(a, 0.715, 0.285, 0.140), c(a, 0.072, -0.072, -0.283), 0, 0, c(a, 0.213, -0.213, -0.787), c(a, 0.715, -0.715, 0.715), c(a, 0.072, 0.928, 0.072), 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n          /* eslint-enable array-element-newline */\n\n          break;\n        }\n\n      case 'luminanceToAlpha':\n        /* eslint-disable array-element-newline */\n        matrix = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2125, 0.7154, 0.0721, 0, 0, 0, 0, 0, 0, 1];\n        /* eslint-enable array-element-newline */\n\n        break;\n    }\n\n    _this49.matrix = matrix;\n    _this49.includeOpacity = _this49.getAttribute('includeOpacity').hasValue();\n    return _this49;\n  }\n\n  _createClass(FeColorMatrixElement, [{\n    key: \"apply\",\n    value: function apply(ctx, _x, _y, width, height) {\n      // assuming x==0 && y==0 for now\n      var includeOpacity = this.includeOpacity,\n          matrix = this.matrix;\n      var srcData = ctx.getImageData(0, 0, width, height);\n\n      for (var y = 0; y < height; y++) {\n        for (var x = 0; x < width; x++) {\n          var r = imGet(srcData.data, x, y, width, height, 0);\n          var g = imGet(srcData.data, x, y, width, height, 1);\n          var b = imGet(srcData.data, x, y, width, height, 2);\n          var a = imGet(srcData.data, x, y, width, height, 3);\n          var nr = m(matrix, 0, r) + m(matrix, 1, g) + m(matrix, 2, b) + m(matrix, 3, a) + m(matrix, 4, 1);\n          var ng = m(matrix, 5, r) + m(matrix, 6, g) + m(matrix, 7, b) + m(matrix, 8, a) + m(matrix, 9, 1);\n          var nb = m(matrix, 10, r) + m(matrix, 11, g) + m(matrix, 12, b) + m(matrix, 13, a) + m(matrix, 14, 1);\n          var na = m(matrix, 15, r) + m(matrix, 16, g) + m(matrix, 17, b) + m(matrix, 18, a) + m(matrix, 19, 1);\n\n          if (includeOpacity) {\n            nr = 0;\n            ng = 0;\n            nb = 0;\n            na *= a / 255;\n          }\n\n          imSet(srcData.data, x, y, width, height, 0, nr);\n          imSet(srcData.data, x, y, width, height, 1, ng);\n          imSet(srcData.data, x, y, width, height, 2, nb);\n          imSet(srcData.data, x, y, width, height, 3, na);\n        }\n      }\n\n      ctx.clearRect(0, 0, width, height);\n      ctx.putImageData(srcData, 0, 0);\n    }\n  }]);\n\n  return FeColorMatrixElement;\n}(Element);\n\nvar MaskElement = /*#__PURE__*/function (_Element13) {\n  _inherits(MaskElement, _Element13);\n\n  var _super41 = _createSuper(MaskElement);\n\n  function MaskElement() {\n    var _this50;\n\n    _classCallCheck(this, MaskElement);\n\n    _this50 = _super41.apply(this, arguments);\n    _this50.type = 'mask';\n    return _this50;\n  }\n\n  _createClass(MaskElement, [{\n    key: \"apply\",\n    value: function apply(ctx, element) {\n      var document = this.document; // render as temp svg\n\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width').getPixels('x');\n      var height = this.getStyle('height').getPixels('y');\n\n      if (!width && !height) {\n        var boundingBox = new BoundingBox();\n        this.children.forEach(function (child) {\n          boundingBox.addBoundingBox(child.getBoundingBox(ctx));\n        });\n        x = Math.floor(boundingBox.x1);\n        y = Math.floor(boundingBox.y1);\n        width = Math.floor(boundingBox.width);\n        height = Math.floor(boundingBox.height);\n      }\n\n      var ignoredStyles = this.removeStyles(element, MaskElement.ignoreStyles);\n      var maskCanvas = document.createCanvas(x + width, y + height);\n      var maskCtx = maskCanvas.getContext('2d');\n      document.screen.setDefaults(maskCtx);\n      this.renderChildren(maskCtx); // convert mask to alpha with a fake node\n      // TODO: refactor out apply from feColorMatrix\n\n      new FeColorMatrixElement(document, {\n        nodeType: 1,\n        childNodes: [],\n        attributes: [{\n          nodeName: 'type',\n          value: 'luminanceToAlpha'\n        }, {\n          nodeName: 'includeOpacity',\n          value: 'true'\n        }]\n      }).apply(maskCtx, 0, 0, x + width, y + height);\n      var tmpCanvas = document.createCanvas(x + width, y + height);\n      var tmpCtx = tmpCanvas.getContext('2d');\n      document.screen.setDefaults(tmpCtx);\n      element.render(tmpCtx);\n      tmpCtx.globalCompositeOperation = 'destination-in';\n      tmpCtx.fillStyle = maskCtx.createPattern(maskCanvas, 'no-repeat');\n      tmpCtx.fillRect(0, 0, x + width, y + height);\n      ctx.fillStyle = tmpCtx.createPattern(tmpCanvas, 'no-repeat');\n      ctx.fillRect(0, 0, x + width, y + height); // reassign mask\n\n      this.restoreStyles(element, ignoredStyles);\n    }\n  }, {\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return MaskElement;\n}(Element);\n\nMaskElement.ignoreStyles = ['mask', 'transform', 'clip-path'];\n\nvar noop = function noop() {// NOOP\n};\n\nvar ClipPathElement = /*#__PURE__*/function (_Element14) {\n  _inherits(ClipPathElement, _Element14);\n\n  var _super42 = _createSuper(ClipPathElement);\n\n  function ClipPathElement() {\n    var _this51;\n\n    _classCallCheck(this, ClipPathElement);\n\n    _this51 = _super42.apply(this, arguments);\n    _this51.type = 'clipPath';\n    return _this51;\n  }\n\n  _createClass(ClipPathElement, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var document = this.document;\n      var contextProto = Reflect.getPrototypeOf(ctx);\n      var beginPath = ctx.beginPath,\n          closePath = ctx.closePath;\n\n      if (contextProto) {\n        contextProto.beginPath = noop;\n        contextProto.closePath = noop;\n      }\n\n      Reflect.apply(beginPath, ctx, []);\n      this.children.forEach(function (child) {\n        if (typeof child.path === 'undefined') {\n          return;\n        }\n\n        var transform = typeof child.elementTransform !== 'undefined' ? child.elementTransform() : null; // handle <use />\n\n        if (!transform) {\n          transform = Transform.fromElement(document, child);\n        }\n\n        if (transform) {\n          transform.apply(ctx);\n        }\n\n        child.path(ctx);\n\n        if (contextProto) {\n          contextProto.closePath = closePath;\n        }\n\n        if (transform) {\n          transform.unapply(ctx);\n        }\n      });\n      Reflect.apply(closePath, ctx, []);\n      ctx.clip();\n\n      if (contextProto) {\n        contextProto.beginPath = beginPath;\n        contextProto.closePath = closePath;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return ClipPathElement;\n}(Element);\n\nvar FilterElement = /*#__PURE__*/function (_Element15) {\n  _inherits(FilterElement, _Element15);\n\n  var _super43 = _createSuper(FilterElement);\n\n  function FilterElement() {\n    var _this52;\n\n    _classCallCheck(this, FilterElement);\n\n    _this52 = _super43.apply(this, arguments);\n    _this52.type = 'filter';\n    return _this52;\n  }\n\n  _createClass(FilterElement, [{\n    key: \"apply\",\n    value: function apply(ctx, element) {\n      // render as temp svg\n      var document = this.document,\n          children = this.children;\n      var boundingBox = element.getBoundingBox(ctx);\n\n      if (!boundingBox) {\n        return;\n      }\n\n      var px = 0;\n      var py = 0;\n      children.forEach(function (child) {\n        var efd = child.extraFilterDistance || 0;\n        px = Math.max(px, efd);\n        py = Math.max(py, efd);\n      });\n      var width = Math.floor(boundingBox.width);\n      var height = Math.floor(boundingBox.height);\n      var tmpCanvasWidth = width + 2 * px;\n      var tmpCanvasHeight = height + 2 * py;\n\n      if (tmpCanvasWidth < 1 || tmpCanvasHeight < 1) {\n        return;\n      }\n\n      var x = Math.floor(boundingBox.x);\n      var y = Math.floor(boundingBox.y);\n      var ignoredStyles = this.removeStyles(element, FilterElement.ignoreStyles);\n      var tmpCanvas = document.createCanvas(tmpCanvasWidth, tmpCanvasHeight);\n      var tmpCtx = tmpCanvas.getContext('2d');\n      document.screen.setDefaults(tmpCtx);\n      tmpCtx.translate(-x + px, -y + py);\n      element.render(tmpCtx); // apply filters\n\n      children.forEach(function (child) {\n        if (typeof child.apply === 'function') {\n          child.apply(tmpCtx, 0, 0, tmpCanvasWidth, tmpCanvasHeight);\n        }\n      }); // render on me\n\n      ctx.drawImage(tmpCanvas, 0, 0, tmpCanvasWidth, tmpCanvasHeight, x - px, y - py, tmpCanvasWidth, tmpCanvasHeight);\n      this.restoreStyles(element, ignoredStyles);\n    }\n  }, {\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return FilterElement;\n}(Element);\n\nFilterElement.ignoreStyles = ['filter', 'transform', 'clip-path'];\n\nvar FeDropShadowElement = /*#__PURE__*/function (_Element16) {\n  _inherits(FeDropShadowElement, _Element16);\n\n  var _super44 = _createSuper(FeDropShadowElement);\n\n  function FeDropShadowElement(document, node, captureTextNodes) {\n    var _this53;\n\n    _classCallCheck(this, FeDropShadowElement);\n\n    _this53 = _super44.call(this, document, node, captureTextNodes);\n    _this53.type = 'feDropShadow';\n\n    _this53.addStylesFromStyleDefinition();\n\n    return _this53;\n  }\n\n  _createClass(FeDropShadowElement, [{\n    key: \"apply\",\n    value: function apply(_, _x, _y, _width, _height) {// TODO: implement\n    }\n  }]);\n\n  return FeDropShadowElement;\n}(Element);\n\nvar FeMorphologyElement = /*#__PURE__*/function (_Element17) {\n  _inherits(FeMorphologyElement, _Element17);\n\n  var _super45 = _createSuper(FeMorphologyElement);\n\n  function FeMorphologyElement() {\n    var _this54;\n\n    _classCallCheck(this, FeMorphologyElement);\n\n    _this54 = _super45.apply(this, arguments);\n    _this54.type = 'feMorphology';\n    return _this54;\n  }\n\n  _createClass(FeMorphologyElement, [{\n    key: \"apply\",\n    value: function apply(_, _x, _y, _width, _height) {// TODO: implement\n    }\n  }]);\n\n  return FeMorphologyElement;\n}(Element);\n\nvar FeCompositeElement = /*#__PURE__*/function (_Element18) {\n  _inherits(FeCompositeElement, _Element18);\n\n  var _super46 = _createSuper(FeCompositeElement);\n\n  function FeCompositeElement() {\n    var _this55;\n\n    _classCallCheck(this, FeCompositeElement);\n\n    _this55 = _super46.apply(this, arguments);\n    _this55.type = 'feComposite';\n    return _this55;\n  }\n\n  _createClass(FeCompositeElement, [{\n    key: \"apply\",\n    value: function apply(_, _x, _y, _width, _height) {// TODO: implement\n    }\n  }]);\n\n  return FeCompositeElement;\n}(Element);\n\nvar FeGaussianBlurElement = /*#__PURE__*/function (_Element19) {\n  _inherits(FeGaussianBlurElement, _Element19);\n\n  var _super47 = _createSuper(FeGaussianBlurElement);\n\n  function FeGaussianBlurElement(document, node, captureTextNodes) {\n    var _this56;\n\n    _classCallCheck(this, FeGaussianBlurElement);\n\n    _this56 = _super47.call(this, document, node, captureTextNodes);\n    _this56.type = 'feGaussianBlur';\n    _this56.blurRadius = Math.floor(_this56.getAttribute('stdDeviation').getNumber());\n    _this56.extraFilterDistance = _this56.blurRadius;\n    return _this56;\n  }\n\n  _createClass(FeGaussianBlurElement, [{\n    key: \"apply\",\n    value: function apply(ctx, x, y, width, height) {\n      var document = this.document,\n          blurRadius = this.blurRadius;\n      var body = document.window ? document.window.document.body : null;\n      var canvas = ctx.canvas; // StackBlur requires canvas be on document\n\n      canvas.id = document.getUniqueId();\n\n      if (body) {\n        canvas.style.display = 'none';\n        body.appendChild(canvas);\n      }\n\n      canvasRGBA(canvas, x, y, width, height, blurRadius);\n\n      if (body) {\n        body.removeChild(canvas);\n      }\n    }\n  }]);\n\n  return FeGaussianBlurElement;\n}(Element);\n\nvar TitleElement = /*#__PURE__*/function (_Element20) {\n  _inherits(TitleElement, _Element20);\n\n  var _super48 = _createSuper(TitleElement);\n\n  function TitleElement() {\n    var _this57;\n\n    _classCallCheck(this, TitleElement);\n\n    _this57 = _super48.apply(this, arguments);\n    _this57.type = 'title';\n    return _this57;\n  }\n\n  return TitleElement;\n}(Element);\n\nvar DescElement = /*#__PURE__*/function (_Element21) {\n  _inherits(DescElement, _Element21);\n\n  var _super49 = _createSuper(DescElement);\n\n  function DescElement() {\n    var _this58;\n\n    _classCallCheck(this, DescElement);\n\n    _this58 = _super49.apply(this, arguments);\n    _this58.type = 'desc';\n    return _this58;\n  }\n\n  return DescElement;\n}(Element);\n\nvar elements = {\n  'svg': SVGElement,\n  'rect': RectElement,\n  'circle': CircleElement,\n  'ellipse': EllipseElement,\n  'line': LineElement,\n  'polyline': PolylineElement,\n  'polygon': PolygonElement,\n  'path': PathElement,\n  'pattern': PatternElement,\n  'marker': MarkerElement,\n  'defs': DefsElement,\n  'linearGradient': LinearGradientElement,\n  'radialGradient': RadialGradientElement,\n  'stop': StopElement,\n  'animate': AnimateElement,\n  'animateColor': AnimateColorElement,\n  'animateTransform': AnimateTransformElement,\n  'font': FontElement,\n  'font-face': FontFaceElement,\n  'missing-glyph': MissingGlyphElement,\n  'glyph': GlyphElement,\n  'text': TextElement,\n  'tspan': TSpanElement,\n  'tref': TRefElement,\n  'a': AElement,\n  'textPath': TextPathElement,\n  'image': ImageElement,\n  'g': GElement,\n  'symbol': SymbolElement,\n  'style': StyleElement,\n  'use': UseElement,\n  'mask': MaskElement,\n  'clipPath': ClipPathElement,\n  'filter': FilterElement,\n  'feDropShadow': FeDropShadowElement,\n  'feMorphology': FeMorphologyElement,\n  'feComposite': FeCompositeElement,\n  'feColorMatrix': FeColorMatrixElement,\n  'feGaussianBlur': FeGaussianBlurElement,\n  'title': TitleElement,\n  'desc': DescElement\n};\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$1(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$1(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction createCanvas(width, height) {\n  var canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  return canvas;\n}\n\nfunction createImage(_x) {\n  return _createImage.apply(this, arguments);\n}\n\nfunction _createImage() {\n  _createImage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(src) {\n    var anonymousCrossOrigin,\n        image,\n        _args7 = arguments;\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            anonymousCrossOrigin = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : false;\n            image = document.createElement('img');\n\n            if (anonymousCrossOrigin) {\n              image.crossOrigin = 'Anonymous';\n            }\n\n            return _context7.abrupt(\"return\", new Promise(function (resolve, reject) {\n              image.onload = function () {\n                resolve(image);\n              };\n\n              image.onerror = function (_event, _source, _lineno, _colno, error) {\n                reject(error);\n              };\n\n              image.src = src;\n            }));\n\n          case 4:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n  return _createImage.apply(this, arguments);\n}\n\nvar Document = /*#__PURE__*/function () {\n  function Document(canvg) {\n    _classCallCheck(this, Document);\n\n    var _ref11 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref11$rootEmSize = _ref11.rootEmSize,\n        rootEmSize = _ref11$rootEmSize === void 0 ? 12 : _ref11$rootEmSize,\n        _ref11$emSize = _ref11.emSize,\n        emSize = _ref11$emSize === void 0 ? 12 : _ref11$emSize,\n        _ref11$createCanvas = _ref11.createCanvas,\n        createCanvas = _ref11$createCanvas === void 0 ? Document.createCanvas : _ref11$createCanvas,\n        _ref11$createImage = _ref11.createImage,\n        createImage = _ref11$createImage === void 0 ? Document.createImage : _ref11$createImage,\n        anonymousCrossOrigin = _ref11.anonymousCrossOrigin;\n\n    this.canvg = canvg;\n    this.definitions = {};\n    this.styles = {};\n    this.stylesSpecificity = {};\n    this.images = [];\n    this.fonts = [];\n    this.emSizeStack = [];\n    this.uniqueId = 0;\n    this.screen = canvg.screen;\n    this.rootEmSize = rootEmSize;\n    this.emSize = emSize;\n    this.createCanvas = createCanvas;\n    this.createImage = this.bindCreateImage(createImage, anonymousCrossOrigin);\n    this.screen.wait(this.isImagesLoaded.bind(this));\n    this.screen.wait(this.isFontsLoaded.bind(this));\n  }\n\n  _createClass(Document, [{\n    key: \"bindCreateImage\",\n    value: function bindCreateImage(createImage, anonymousCrossOrigin) {\n      if (typeof anonymousCrossOrigin === 'boolean') {\n        return function (source, forceAnonymousCrossOrigin) {\n          return createImage(source, typeof forceAnonymousCrossOrigin === 'boolean' ? forceAnonymousCrossOrigin : anonymousCrossOrigin);\n        };\n      }\n\n      return createImage;\n    }\n  }, {\n    key: \"window\",\n    get: function get() {\n      return this.screen.window;\n    }\n  }, {\n    key: \"fetch\",\n    get: function get() {\n      return this.screen.fetch;\n    }\n  }, {\n    key: \"ctx\",\n    get: function get() {\n      return this.screen.ctx;\n    }\n  }, {\n    key: \"emSize\",\n    get: function get() {\n      var emSizeStack = this.emSizeStack;\n      return emSizeStack[emSizeStack.length - 1];\n    },\n    set: function set(value) {\n      var emSizeStack = this.emSizeStack;\n      emSizeStack.push(value);\n    }\n  }, {\n    key: \"popEmSize\",\n    value: function popEmSize() {\n      var emSizeStack = this.emSizeStack;\n      emSizeStack.pop();\n    }\n  }, {\n    key: \"getUniqueId\",\n    value: function getUniqueId() {\n      return \"canvg\".concat(++this.uniqueId);\n    }\n  }, {\n    key: \"isImagesLoaded\",\n    value: function isImagesLoaded() {\n      return this.images.every(function (_) {\n        return _.loaded;\n      });\n    }\n  }, {\n    key: \"isFontsLoaded\",\n    value: function isFontsLoaded() {\n      return this.fonts.every(function (_) {\n        return _.loaded;\n      });\n    }\n  }, {\n    key: \"createDocumentElement\",\n    value: function createDocumentElement(document) {\n      var documentElement = this.createElement(document.documentElement);\n      documentElement.root = true;\n      documentElement.addStylesFromStyleDefinition();\n      this.documentElement = documentElement;\n      return documentElement;\n    }\n  }, {\n    key: \"createElement\",\n    value: function createElement(node) {\n      var elementType = node.nodeName.replace(/^[^:]+:/, '');\n      var ElementType = Document.elementTypes[elementType];\n\n      if (typeof ElementType !== 'undefined') {\n        return new ElementType(this, node);\n      }\n\n      return new UnknownElement(this, node);\n    }\n  }, {\n    key: \"createTextNode\",\n    value: function createTextNode(node) {\n      return new TextNode(this, node);\n    }\n  }, {\n    key: \"setViewBox\",\n    value: function setViewBox(config) {\n      this.screen.setViewBox(_objectSpread$1({\n        document: this\n      }, config));\n    }\n  }]);\n\n  return Document;\n}();\n\nDocument.createCanvas = createCanvas;\nDocument.createImage = createImage;\nDocument.elementTypes = elements;\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n/**\r\n * SVG renderer on canvas.\r\n */\n\n\nvar Canvg = /*#__PURE__*/function () {\n  /**\r\n   * Main constructor.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG Document.\r\n   * @param options - Rendering options.\r\n   */\n  function Canvg(ctx, svg) {\n    _classCallCheck(this, Canvg);\n\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    this.parser = new Parser(options);\n    this.screen = new Screen(ctx, options);\n    this.options = options;\n    var document = new Document(this, options);\n    var documentElement = document.createDocumentElement(svg);\n    this.document = document;\n    this.documentElement = documentElement;\n  }\n  /**\r\n   * Create Canvg instance from SVG source string or URL.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG source string or URL.\r\n   * @param options - Rendering options.\r\n   * @returns Canvg instance.\r\n   */\n\n\n  _createClass(Canvg, [{\n    key: \"fork\",\n    value:\n    /**\r\n     * Create new Canvg instance with inherited options.\r\n     * @param ctx - Rendering context.\r\n     * @param svg - SVG source string or URL.\r\n     * @param options - Rendering options.\r\n     * @returns Canvg instance.\r\n     */\n    function fork(ctx, svg) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return Canvg.from(ctx, svg, _objectSpread(_objectSpread({}, this.options), options));\n    }\n    /**\r\n     * Create new Canvg instance with inherited options.\r\n     * @param ctx - Rendering context.\r\n     * @param svg - SVG source string.\r\n     * @param options - Rendering options.\r\n     * @returns Canvg instance.\r\n     */\n\n  }, {\n    key: \"forkString\",\n    value: function forkString(ctx, svg) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return Canvg.fromString(ctx, svg, _objectSpread(_objectSpread({}, this.options), options));\n    }\n    /**\r\n     * Document is ready promise.\r\n     * @returns Ready promise.\r\n     */\n\n  }, {\n    key: \"ready\",\n    value: function ready() {\n      return this.screen.ready();\n    }\n    /**\r\n     * Document is ready value.\r\n     * @returns Is ready or not.\r\n     */\n\n  }, {\n    key: \"isReady\",\n    value: function isReady() {\n      return this.screen.isReady();\n    }\n    /**\r\n     * Render only first frame, ignoring animations and mouse.\r\n     * @param options - Rendering options.\r\n     */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _arguments2 = arguments,\n          _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n        var options;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                options = _arguments2.length > 0 && _arguments2[0] !== undefined ? _arguments2[0] : {};\n\n                _this.start(_objectSpread({\n                  enableRedraw: true,\n                  ignoreAnimation: true,\n                  ignoreMouse: true\n                }, options));\n\n                _context8.next = 4;\n                return _this.ready();\n\n              case 4:\n                _this.stop();\n\n              case 5:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8);\n      }))();\n    }\n    /**\r\n     * Start rendering.\r\n     * @param options - Render options.\r\n     */\n\n  }, {\n    key: \"start\",\n    value: function start() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var documentElement = this.documentElement,\n          screen = this.screen,\n          baseOptions = this.options;\n      screen.start(documentElement, _objectSpread(_objectSpread({\n        enableRedraw: true\n      }, baseOptions), options));\n    }\n    /**\r\n     * Stop rendering.\r\n     */\n\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      this.screen.stop();\n    }\n    /**\r\n     * Resize SVG to fit in given size.\r\n     * @param width\r\n     * @param height\r\n     * @param preserveAspectRatio\r\n     */\n\n  }, {\n    key: \"resize\",\n    value: function resize(width) {\n      var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : width;\n      var preserveAspectRatio = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      this.documentElement.resize(width, height, preserveAspectRatio);\n    }\n  }], [{\n    key: \"from\",\n    value: function from(ctx, svg) {\n      var _arguments = arguments;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        var options, parser, svgDocument;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                options = _arguments.length > 2 && _arguments[2] !== undefined ? _arguments[2] : {};\n                parser = new Parser(options);\n                _context9.next = 4;\n                return parser.parse(svg);\n\n              case 4:\n                svgDocument = _context9.sent;\n                return _context9.abrupt(\"return\", new Canvg(ctx, svgDocument, options));\n\n              case 6:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }))();\n    }\n    /**\r\n     * Create Canvg instance from SVG source string.\r\n     * @param ctx - Rendering context.\r\n     * @param svg - SVG source string.\r\n     * @param options - Rendering options.\r\n     * @returns Canvg instance.\r\n     */\n\n  }, {\n    key: \"fromString\",\n    value: function fromString(ctx, svg) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var parser = new Parser(options);\n      var svgDocument = parser.parseFromString(svg);\n      return new Canvg(ctx, svgDocument, options);\n    }\n  }]);\n\n  return Canvg;\n}();\n\nexport default Canvg;\nexport { AElement, AnimateColorElement, AnimateElement, AnimateTransformElement, BoundingBox, CB1, CB2, CB3, CB4, Canvg, CircleElement, ClipPathElement, DefsElement, DescElement, Document, Element, EllipseElement, FeColorMatrixElement, FeCompositeElement, FeDropShadowElement, FeGaussianBlurElement, FeMorphologyElement, FilterElement, Font, FontElement, FontFaceElement, GElement, GlyphElement, GradientElement, ImageElement, LineElement, LinearGradientElement, MarkerElement, MaskElement, Matrix, MissingGlyphElement, Mouse, PSEUDO_ZERO, Parser, PathElement, PathParser, PatternElement, Point, PolygonElement, PolylineElement, Property, QB1, QB2, QB3, RadialGradientElement, RectElement, RenderedElement, Rotate, SVGElement, SVGFontLoader, Scale, Screen, Skew, SkewX, SkewY, StopElement, StyleElement, SymbolElement, TRefElement, TSpanElement, TextElement, TextPathElement, TitleElement, Transform, Translate, UnknownElement, UseElement, ViewPort, compressSpaces, getSelectorSpecificity, normalizeAttributeName, normalizeColor, parseExternalUrl, index as presets, toNumbers, trimLeft, trimRight, vectorMagnitude, vectorsAngle, vectorsRatio }; //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZXMuanMiLCJzb3VyY2VzIjpbXSwic291cmNlc0NvbnRlbnQiOltdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsifQ==","map":{"version":3,"sources":["/Users/mac/Apps/sr-manager/web/node_modules/canvg/lib/index.es.js"],"names":["_asyncToGenerator","_defineProperty","requestAnimationFrame","RGBColor","SVGPathData","canvasRGBA","offscreen","arguments","length","undefined","DOMParserFallback","DOMParser","preset","window","ignoreAnimation","ignoreMouse","createCanvas","width","height","OffscreenCanvas","createImage","url","fetch","response","blob","createImageBitmap","img","Reflect","deleteProperty","node","_ref","canvas","loadImage","index","Object","freeze","__proto__","compressSpaces","str","replace","trimLeft","trimRight","toNumbers","matches","match","map","parseFloat","allUppercase","normalizeAttributeName","name","test","toLowerCase","parseExternalUrl","urlMatch","exec","normalizeColor","color","startsWith","rgbParts","normalizedColor","num","isFloat","String","Math","round","attributeRegex","idRegex","classRegex","pseudoElementRegex","pseudoClassWithBracketsRegex","pseudoClassRegex","elementRegex","findSelectorMatch","selector","regex","getSelectorSpecificity","specificity","currentSelector","delta","join","PSEUDO_ZERO","vectorMagnitude","v","sqrt","pow","vectorsRatio","u","vectorsAngle","acos","CB1","t","CB2","CB3","CB4","QB1","QB2","QB3","Property","document","value","isNormalizedColor","separator","getString","trim","split","zeroIsValue","regexp","result","isString","hasValue","asString","endsWith","def","n","rootEmSize","emSize","axisOrIsFontSize","processPercent","axis","isFontSize","viewPort","screen","getNumber","min","computeSize","max","getRem","getEm","getDpi","PI","definitions","element","opacity","getDefinition","createGradient","ctx","createPattern","getHrefAttribute","patternTransform","getAttribute","setValue","textBaselineMapping","getColor","len","commas","i","ok","alpha","toRGBA","ViewPort","viewPorts","push","pop","getCurrent","d","Point","x","y","point","atan2","transform","xp","yp","defaultValue","scale","path","points","pathPoints","Mouse","working","events","eventElements","onClick","bind","onMouseMove","onclick","onmousemove","style","cursor","forEach","run","parent","_ref2","isPointInPath","boundingBox","_ref3","isPointInBox","offsetLeft","offsetTop","offsetParent","scrollX","scrollY","event","mapXY","clientX","clientY","type","eventTarget","defaultWindow","defaultFetch$1","Screen","FRAMERATE","MAX_VIRTUAL_PIXELS","CLIENT_WIDTH","CLIENT_HEIGHT","mouse","animations","waits","frameDuration","isReadyLock","isFirstRender","intervalId","checker","readyPromise","Promise","resolve","every","_","resolveReady","strokeStyle","lineCap","lineJoin","miterLimit","aspectRatio","desiredWidth","desiredHeight","minX","minY","refX","refY","clip","clipX","clipY","cleanAspectRatio","aspectRatioAlign","aspectRatioMeetOrSlice","align","meetOrSlice","scaleX","scaleY","scaleMin","scaleMax","finalDesiredWidth","finalDesiredHeight","refXProp","refYProp","hasRefs","translate","getPixels","scaledClipX","scaledClipY","beginPath","moveTo","lineTo","closePath","isMeetMinY","isSliceMaxY","isMeetMinX","isSliceMaxX","enableRedraw","ignoreDimensions","ignoreClear","forceRedraw","scaleWidth","scaleHeight","offsetX","offsetY","isReady","render","now","Date","then","tick","shouldUpdate","runEvents","start","cancel","stop","reduce","animation","update","hasEvents","clear","setCurrent","widthStyle","getStyle","heightStyle","concat","cWidth","clientWidth","cHeight","clientHeight","viewBox","xRatio","yRatio","_widthStyle","isNaN","_heightStyle","transformStyle","clearRect","defaultFetch","DefaultDOMParser","Parser","resource","_this","parseFromString","load","xml","parser","checkDocument","err","parserError","getElementsByTagName","Error","textContent","_this2","text","Translate","parse","applyTransform","Rotate","rotate","transformOrigin","angle","originX","originY","cx","cy","numbers","tx","ty","getRadians","rad","cos","sin","Scale","scaleSize","parseScale","Matrix","matrix","a","b","c","e","f","g","h","det","Skew","skew","SkewX","tan","SkewY","parseTransforms","parseTransform","Transform","transforms","data","TransformType","transformTypes","apply","unapply","applyToPoint","transformOriginXProperty","transformOriginYProperty","skewX","skewY","Element","captureTextNodes","attributes","styles","stylesSpecificity","animationFrozen","animationFrozenValue","children","nodeType","Array","from","attribute","nodeName","addStylesFromStyleDefinition","id","childNodes","childNode","addChild","textNode","createTextNode","getText","createIfNotExists","attr","_attr","empty","key","skipAncestors","parentStyle","_style","save","mask","applyEffects","getValue","filter","setContext","renderChildren","clearContext","restore","fromElement","clipPathStyleProp","child","createElement","ignoreChildTypes","includes","styleClasses","some","styleClass","matchesSelector","existingSpecificity","ignoreStyles","toRestore","styleProp","UnknownElement","wrapFontFamily","fontFamily","trimmed","prepareFontFamily","process","prepareFontStyle","fontStyle","targetFontStyle","prepareFontWeight","fontWeight","targetFontWeight","Font","fontVariant","fontSize","inherit","inheritFont","font","parts","set","part","variants","weights","BoundingBox","x1","Number","NaN","y1","x2","y2","addPoint","p0","p1","p2","p3","forX","addX","sumCubic","addY","b2ac","t1","t2","p0x","p0y","p1x","p1y","p2x","p2y","p3x","p3y","bezierCurveAdd","cp1x","cp1y","cp2x","cp2y","addBezierCurve","PathParser","control","current","command","commands","previousCommand","angles","xProp","yProp","makeAbsolute","getPoint","CURVE_TO","SMOOTH_CURVE_TO","QUAD_TO","SMOOTH_QUAD_TO","ox","oy","relative","priorTo","angleTo","addMarkerAngle","j","RenderedElement","modifiedEmSizeStack","opacityStyle","fromMeasure","fillStyleProp","fillOpacityStyleProp","strokeStyleProp","strokeOpacityProp","isUrlDefinition","fillStyle","getFillStyleDefinition","_fillStyle","_fillStyle2","addOpacity","_strokeStyle","_strokeStyle2","strokeWidthStyleProp","newLineWidth","lineWidth","strokeLinecapStyleProp","strokeLinejoinStyleProp","strokeMiterlimitProp","strokeDasharrayStyleProp","strokeDashoffsetProp","gaps","setLineDash","webkitLineDash","mozDash","offset","lineDashOffset","webkitLineDashOffset","mozDashOffset","fontStyleProp","fontStyleStyleProp","fontVariantStyleProp","fontWeightStyleProp","fontSizeStyleProp","fontFamilyStyleProp","toString","isPixels","globalAlpha","calculateOpacity","popEmSize","PathElement","pathParser","reset","isEnd","next","MOVE_TO","pathM","LINE_TO","pathL","HORIZ_LINE_TO","pathH","VERT_LINE_TO","pathV","pathC","pathS","pathQ","pathT","ARC","pathA","CLOSE_PATH","pathZ","getMarkerPoints","getMarkerAngles","markers","checkPath","fillRuleStyleProp","fill","setTransform","stroke","getMarkers","markersLastIndex","markerStartStyleProp","markerMidStyleProp","markerEndStyleProp","marker","_marker","_point","_angle","_marker2","_point2","_angle2","addMarker","controlPoint","currentPoint","bezierCurveTo","addQuadraticCurve","quadraticCurveTo","rX","rY","sweepFlag","xAxisRotation","centp","a1","ad","dir","ah","halfWay","r","sx","sy","arc","Boolean","getAsCurrentPoint","getAsControlPoint","getReflectedControlPoint","xRot","lArcFlag","currp","l","s","cpp","GlyphElement","horizAdvX","unicode","arabicForm","TextElement","measureCache","textBaseline","getTextBaseline","dxAttr","dyAttr","getAnchorDelta","getTElementBoundingBox","initializeCoordinates","childBoundingBox","getChildBoundingBox","addBoundingBox","inheritFontSize","getFontSize","measureText","char","glyph","isArabic","prevChar","nextChar","glyphs","maybeGlyph","missingGlyph","parentNode","indexOf","lastIndex","renderTElementChildren","renderChild","isWorking","checkBoundingBox","getBoundingBox","renderText","customFont","unitsPerEm","fontFace","ctxFont","isRTL","reverse","dx","getGlyph","lw","fillText","strokeText","startI","textAnchor","measureTextRecursive","textParent","xAttr","yAttr","_width","adjustChildCoordinates","measure","measureTargetText","targetText","_measure","TSpanElement","getTextFromNode","TextNode","SVGElement","root","_this$node$parentNode","setDefaults","getComputedStyle","getPropertyValue","fontSizeProp","refXAttr","refYAttr","viewBoxAttr","setViewBox","removeCurrent","preserveAspectRatio","widthAttr","heightAttr","styleAttr","originWidth","originHeight","preserveAspectRatioAttr","RectElement","rxAttr","ryAttr","rx","ry","KAPPA","CircleElement","EllipseElement","LineElement","getPoints","x0","y0","PolylineElement","parsePath","PolygonElement","PatternElement","parentOpacityProp","patternSvg","patternCanvas","patternCtx","getContext","pattern","MarkerElement","orient","markerUnits","markerSvg","overflow","DefsElement","GElement","GradientElement","attributesToInherit","stops","stopsContainer","inheritStopContainer","gradient","getGradient","addParentOpacity","addColorStop","rootView","rect","group","attributeToInherit","colorProp","LinearGradientElement","isBoundingBoxUnits","getGradientUnits","createLinearGradient","RadialGradientElement","fx","fy","fr","createRadialGradient","StopElement","stopOpacity","stopColor","AnimateElement","duration","initialValue","initialUnits","removed","frozen","begin","getMilliseconds","maxDuration","to","values","valuesAttr","attributeType","attributeName","getProgress","progress","newValue","prop","getProperty","getUnits","updated","calcValue","typeAttr","p","lb","floor","ub","ceil","AnimateColorElement","colorFrom","colorTo","AnimateTransformElement","transformFrom","transformTo","FontElement","fontFamilyStyle","FontFaceElement","ascent","descent","MissingGlyphElement","TRefElement","firstChild","AElement","hasText","open","ownKeys$2","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","enumerable","_objectSpread$2","target","source","getOwnPropertyDescriptors","defineProperties","defineProperty","TextPathElement","textWidth","textHeight","pathLength","glyphInfo","letterSpacingCache","measuresCache","Map","pathElement","dataArray","parsePathData","theta","dTheta","psi","fs","setTextData","textDecoration","rotation","partialText","idx","anchor","textFullWidth","fullPathWidth","spacesNumber","inputOffset","dy","charI","glyphWidth","getLetterSpacingAt","splineStep","getEquidistantPointOnPath","segment","dyX","dyY","has","get","chars","thisSpacing","parentSpacing","letterSpacing","textLen","dxSum","acc","cur","getPathLength","startOffset","findSegmentToFitChar","nextOffset","pathCommands","startX","startY","nextCommandType","calcLength","commandType","getLineLength","getPointOnCubicBezier","getPointOnQuadraticBezier","end","inc","abs","getPointOnEllipticalArc","dist","fromX","fromY","m","rise","pt","ix","iy","pRise","pRun","distance","fullLen","cumulativePathLength","currentT","getPointOnLine","pct","p4x","p4y","cosPsi","sinPsi","inputStep","inputPrecision","precision","step","equidistantCache","getPointOnPath","targetDistance","buildEquidistantCache","dataUriRegex","ImageElement","loaded","href","isSvg","images","loadSvg","image","console","error","atob","decodeURIComponent","svg","subDocument","canvg","forkString","documentElement","_image","complete","drawImage","SymbolElement","SVGFontLoader","fonts","svgDocument","fontNode","StyleElement","css","cssDefs","cssParts","cssClasses","cssProps","cssClass","props","cssProp","substr","srcs","src","UseElement","tempSvg","oldParent","cachedElement","imGet","_height","rgba","imSet","val","mi","m1","m2","m3","FeColorMatrixElement","includeOpacity","_x","_y","srcData","getImageData","nr","ng","nb","na","putImageData","MaskElement","ignoredStyles","removeStyles","maskCanvas","maskCtx","tmpCanvas","tmpCtx","globalCompositeOperation","fillRect","restoreStyles","noop","ClipPathElement","contextProto","getPrototypeOf","elementTransform","FilterElement","px","py","efd","extraFilterDistance","tmpCanvasWidth","tmpCanvasHeight","FeDropShadowElement","FeMorphologyElement","FeCompositeElement","FeGaussianBlurElement","blurRadius","body","getUniqueId","display","appendChild","removeChild","TitleElement","DescElement","elements","ownKeys$1","_objectSpread$1","_createImage","anonymousCrossOrigin","crossOrigin","reject","onload","onerror","_event","_source","_lineno","_colno","Document","emSizeStack","uniqueId","bindCreateImage","wait","isImagesLoaded","isFontsLoaded","forceAnonymousCrossOrigin","elementType","ElementType","elementTypes","config","ownKeys","_objectSpread","Canvg","options","createDocumentElement","fromString","ready","_arguments2","baseOptions","resize","_arguments","presets"],"mappings":"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","sourcesContent":["import 'core-js/modules/es.promise.js';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport 'core-js/modules/es.string.match.js';\nimport 'core-js/modules/es.string.replace.js';\nimport 'core-js/modules/es.string.starts-with.js';\nimport 'core-js/modules/es.array.iterator.js';\nimport 'core-js/modules/web.dom-collections.iterator.js';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport 'core-js/modules/es.array.reduce.js';\nimport 'core-js/modules/es.string.ends-with.js';\nimport 'core-js/modules/es.string.split.js';\nimport requestAnimationFrame from 'raf';\nimport 'core-js/modules/es.string.trim.js';\nimport RGBColor from 'rgbcolor';\nimport 'core-js/modules/es.string.includes.js';\nimport 'core-js/modules/es.array.index-of.js';\nimport 'core-js/modules/es.array.reverse.js';\nimport { SVGPathData } from 'svg-pathdata';\nimport 'core-js/modules/es.regexp.to-string.js';\nimport { canvasRGBA } from 'stackblur-canvas';\n\n/**\r\n * Options preset for `OffscreenCanvas`.\r\n * @param config - Preset requirements.\r\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\r\n * @returns Preset object.\r\n */\nfunction offscreen() {\n  var {\n    DOMParser: DOMParserFallback\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var preset = {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser: DOMParserFallback,\n\n    createCanvas(width, height) {\n      return new OffscreenCanvas(width, height);\n    },\n\n    createImage(url) {\n      return _asyncToGenerator(function* () {\n        var response = yield fetch(url);\n        var blob = yield response.blob();\n        var img = yield createImageBitmap(blob);\n        return img;\n      })();\n    }\n\n  };\n\n  if (typeof DOMParser !== 'undefined' || typeof DOMParserFallback === 'undefined') {\n    Reflect.deleteProperty(preset, 'DOMParser');\n  }\n\n  return preset;\n}\n\n/**\r\n * Options preset for `node-canvas`.\r\n * @param config - Preset requirements.\r\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\r\n * @param config.canvas - `node-canvas` exports.\r\n * @param config.fetch - WHATWG-compatible `fetch` function.\r\n * @returns Preset object.\r\n */\nfunction node(_ref) {\n  var {\n    DOMParser,\n    canvas,\n    fetch\n  } = _ref;\n  return {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser,\n    fetch,\n    createCanvas: canvas.createCanvas,\n    createImage: canvas.loadImage\n  };\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\toffscreen: offscreen,\n\tnode: node\n});\n\n/**\r\n * HTML-safe compress white-spaces.\r\n * @param str - String to compress.\r\n * @returns String.\r\n */\nfunction compressSpaces(str) {\n  return str.replace(/(?!\\u3000)\\s+/gm, ' ');\n}\n/**\r\n * HTML-safe left trim.\r\n * @param str - String to trim.\r\n * @returns String.\r\n */\n\nfunction trimLeft(str) {\n  return str.replace(/^[\\n \\t]+/, '');\n}\n/**\r\n * HTML-safe right trim.\r\n * @param str - String to trim.\r\n * @returns String.\r\n */\n\nfunction trimRight(str) {\n  return str.replace(/[\\n \\t]+$/, '');\n}\n/**\r\n * String to numbers array.\r\n * @param str - Numbers string.\r\n * @returns Numbers array.\r\n */\n\nfunction toNumbers(str) {\n  var matches = (str || '').match(/-?(\\d+(?:\\.\\d*(?:[eE][+-]?\\d+)?)?|\\.\\d+)(?=\\D|$)/gm) || [];\n  return matches.map(parseFloat);\n} // Microsoft Edge fix\n\nvar allUppercase = /^[A-Z-]+$/;\n/**\r\n * Normalize attribute name.\r\n * @param name - Attribute name.\r\n * @returns Normalized attribute name.\r\n */\n\nfunction normalizeAttributeName(name) {\n  if (allUppercase.test(name)) {\n    return name.toLowerCase();\n  }\n\n  return name;\n}\n/**\r\n * Parse external URL.\r\n * @param url - CSS url string.\r\n * @returns Parsed URL.\r\n */\n\nfunction parseExternalUrl(url) {\n  //                      single quotes [2]\n  //                      v         double quotes [3]\n  //                      v         v         no quotes [4]\n  //                      v         v         v\n  var urlMatch = /url\\(('([^']+)'|\"([^\"]+)\"|([^'\")]+))\\)/.exec(url) || [];\n  return urlMatch[2] || urlMatch[3] || urlMatch[4];\n}\n/**\r\n * Transform floats to integers in rgb colors.\r\n * @param color - Color to normalize.\r\n * @returns Normalized color.\r\n */\n\nfunction normalizeColor(color) {\n  if (!color.startsWith('rgb')) {\n    return color;\n  }\n\n  var rgbParts = 3;\n  var normalizedColor = color.replace(/\\d+(\\.\\d+)?/g, (num, isFloat) => rgbParts-- && isFloat ? String(Math.round(parseFloat(num))) : num);\n  return normalizedColor;\n}\n\n// slightly modified version of https://github.com/keeganstreet/specificity/blob/master/specificity.js\nvar attributeRegex = /(\\[[^\\]]+\\])/g;\nvar idRegex = /(#[^\\s+>~.[:]+)/g;\nvar classRegex = /(\\.[^\\s+>~.[:]+)/g;\nvar pseudoElementRegex = /(::[^\\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi;\nvar pseudoClassWithBracketsRegex = /(:[\\w-]+\\([^)]*\\))/gi;\nvar pseudoClassRegex = /(:[^\\s+>~.[:]+)/g;\nvar elementRegex = /([^\\s+>~.[:]+)/g;\n\nfunction findSelectorMatch(selector, regex) {\n  var matches = regex.exec(selector);\n\n  if (!matches) {\n    return [selector, 0];\n  }\n\n  return [selector.replace(regex, ' '), matches.length];\n}\n/**\r\n * Measure selector specificity.\r\n * @param selector - Selector to measure.\r\n * @returns Specificity.\r\n */\n\n\nfunction getSelectorSpecificity(selector) {\n  var specificity = [0, 0, 0];\n  var currentSelector = selector.replace(/:not\\(([^)]*)\\)/g, '     $1 ').replace(/{[\\s\\S]*/gm, ' ');\n  var delta = 0;\n  [currentSelector, delta] = findSelectorMatch(currentSelector, attributeRegex);\n  specificity[1] += delta;\n  [currentSelector, delta] = findSelectorMatch(currentSelector, idRegex);\n  specificity[0] += delta;\n  [currentSelector, delta] = findSelectorMatch(currentSelector, classRegex);\n  specificity[1] += delta;\n  [currentSelector, delta] = findSelectorMatch(currentSelector, pseudoElementRegex);\n  specificity[2] += delta;\n  [currentSelector, delta] = findSelectorMatch(currentSelector, pseudoClassWithBracketsRegex);\n  specificity[1] += delta;\n  [currentSelector, delta] = findSelectorMatch(currentSelector, pseudoClassRegex);\n  specificity[1] += delta;\n  currentSelector = currentSelector.replace(/[*\\s+>~]/g, ' ').replace(/[#.]/g, ' ');\n  [currentSelector, delta] = findSelectorMatch(currentSelector, elementRegex); // lgtm [js/useless-assignment-to-local]\n\n  specificity[2] += delta;\n  return specificity.join('');\n}\n\nvar PSEUDO_ZERO = .00000001;\n/**\r\n * Vector magnitude.\r\n * @param v\r\n * @returns Number result.\r\n */\n\nfunction vectorMagnitude(v) {\n  return Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2));\n}\n/**\r\n * Ratio between two vectors.\r\n * @param u\r\n * @param v\r\n * @returns Number result.\r\n */\n\nfunction vectorsRatio(u, v) {\n  return (u[0] * v[0] + u[1] * v[1]) / (vectorMagnitude(u) * vectorMagnitude(v));\n}\n/**\r\n * Angle between two vectors.\r\n * @param u\r\n * @param v\r\n * @returns Number result.\r\n */\n\nfunction vectorsAngle(u, v) {\n  return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vectorsRatio(u, v));\n}\nfunction CB1(t) {\n  return t * t * t;\n}\nfunction CB2(t) {\n  return 3 * t * t * (1 - t);\n}\nfunction CB3(t) {\n  return 3 * t * (1 - t) * (1 - t);\n}\nfunction CB4(t) {\n  return (1 - t) * (1 - t) * (1 - t);\n}\nfunction QB1(t) {\n  return t * t;\n}\nfunction QB2(t) {\n  return 2 * t * (1 - t);\n}\nfunction QB3(t) {\n  return (1 - t) * (1 - t);\n}\n\nclass Property {\n  constructor(document, name, value) {\n    this.document = document;\n    this.name = name;\n    this.value = value;\n    this.isNormalizedColor = false;\n  }\n\n  static empty(document) {\n    return new Property(document, 'EMPTY', '');\n  }\n\n  split() {\n    var separator = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ' ';\n    var {\n      document,\n      name\n    } = this;\n    return compressSpaces(this.getString()).trim().split(separator).map(value => new Property(document, name, value));\n  }\n\n  hasValue(zeroIsValue) {\n    var {\n      value\n    } = this;\n    return value !== null && value !== '' && (zeroIsValue || value !== 0) && typeof value !== 'undefined';\n  }\n\n  isString(regexp) {\n    var {\n      value\n    } = this;\n    var result = typeof value === 'string';\n\n    if (!result || !regexp) {\n      return result;\n    }\n\n    return regexp.test(value);\n  }\n\n  isUrlDefinition() {\n    return this.isString(/^url\\(/);\n  }\n\n  isPixels() {\n    if (!this.hasValue()) {\n      return false;\n    }\n\n    var asString = this.getString();\n\n    switch (true) {\n      case asString.endsWith('px'):\n      case /^[0-9]+$/.test(asString):\n        return true;\n\n      default:\n        return false;\n    }\n  }\n\n  setValue(value) {\n    this.value = value;\n    return this;\n  }\n\n  getValue(def) {\n    if (typeof def === 'undefined' || this.hasValue()) {\n      return this.value;\n    }\n\n    return def;\n  }\n\n  getNumber(def) {\n    if (!this.hasValue()) {\n      if (typeof def === 'undefined') {\n        return 0;\n      }\n\n      return parseFloat(def);\n    }\n\n    var {\n      value\n    } = this;\n    var n = parseFloat(value);\n\n    if (this.isString(/%$/)) {\n      n /= 100.0;\n    }\n\n    return n;\n  }\n\n  getString(def) {\n    if (typeof def === 'undefined' || this.hasValue()) {\n      return typeof this.value === 'undefined' ? '' : String(this.value);\n    }\n\n    return String(def);\n  }\n\n  getColor(def) {\n    var color = this.getString(def);\n\n    if (this.isNormalizedColor) {\n      return color;\n    }\n\n    this.isNormalizedColor = true;\n    color = normalizeColor(color);\n    this.value = color;\n    return color;\n  }\n\n  getDpi() {\n    return 96.0; // TODO: compute?\n  }\n\n  getRem() {\n    return this.document.rootEmSize;\n  }\n\n  getEm() {\n    return this.document.emSize;\n  }\n\n  getUnits() {\n    return this.getString().replace(/[0-9.-]/g, '');\n  }\n\n  getPixels(axisOrIsFontSize) {\n    var processPercent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (!this.hasValue()) {\n      return 0;\n    }\n\n    var [axis, isFontSize] = typeof axisOrIsFontSize === 'boolean' ? [undefined, axisOrIsFontSize] : [axisOrIsFontSize];\n    var {\n      viewPort\n    } = this.document.screen;\n\n    switch (true) {\n      case this.isString(/vmin$/):\n        return this.getNumber() / 100.0 * Math.min(viewPort.computeSize('x'), viewPort.computeSize('y'));\n\n      case this.isString(/vmax$/):\n        return this.getNumber() / 100.0 * Math.max(viewPort.computeSize('x'), viewPort.computeSize('y'));\n\n      case this.isString(/vw$/):\n        return this.getNumber() / 100.0 * viewPort.computeSize('x');\n\n      case this.isString(/vh$/):\n        return this.getNumber() / 100.0 * viewPort.computeSize('y');\n\n      case this.isString(/rem$/):\n        return this.getNumber() * this.getRem();\n\n      case this.isString(/em$/):\n        return this.getNumber() * this.getEm();\n\n      case this.isString(/ex$/):\n        return this.getNumber() * this.getEm() / 2.0;\n\n      case this.isString(/px$/):\n        return this.getNumber();\n\n      case this.isString(/pt$/):\n        return this.getNumber() * this.getDpi() * (1.0 / 72.0);\n\n      case this.isString(/pc$/):\n        return this.getNumber() * 15;\n\n      case this.isString(/cm$/):\n        return this.getNumber() * this.getDpi() / 2.54;\n\n      case this.isString(/mm$/):\n        return this.getNumber() * this.getDpi() / 25.4;\n\n      case this.isString(/in$/):\n        return this.getNumber() * this.getDpi();\n\n      case this.isString(/%$/) && isFontSize:\n        return this.getNumber() * this.getEm();\n\n      case this.isString(/%$/):\n        return this.getNumber() * viewPort.computeSize(axis);\n\n      default:\n        {\n          var n = this.getNumber();\n\n          if (processPercent && n < 1.0) {\n            return n * viewPort.computeSize(axis);\n          }\n\n          return n;\n        }\n    }\n  }\n\n  getMilliseconds() {\n    if (!this.hasValue()) {\n      return 0;\n    }\n\n    if (this.isString(/ms$/)) {\n      return this.getNumber();\n    }\n\n    return this.getNumber() * 1000;\n  }\n\n  getRadians() {\n    if (!this.hasValue()) {\n      return 0;\n    }\n\n    switch (true) {\n      case this.isString(/deg$/):\n        return this.getNumber() * (Math.PI / 180.0);\n\n      case this.isString(/grad$/):\n        return this.getNumber() * (Math.PI / 200.0);\n\n      case this.isString(/rad$/):\n        return this.getNumber();\n\n      default:\n        return this.getNumber() * (Math.PI / 180.0);\n    }\n  }\n\n  getDefinition() {\n    var asString = this.getString();\n    var name = /#([^)'\"]+)/.exec(asString);\n\n    if (name) {\n      name = name[1];\n    }\n\n    if (!name) {\n      name = asString;\n    }\n\n    return this.document.definitions[name];\n  }\n\n  getFillStyleDefinition(element, opacity) {\n    var def = this.getDefinition();\n\n    if (!def) {\n      return null;\n    } // gradient\n\n\n    if (typeof def.createGradient === 'function') {\n      return def.createGradient(this.document.ctx, element, opacity);\n    } // pattern\n\n\n    if (typeof def.createPattern === 'function') {\n      if (def.getHrefAttribute().hasValue()) {\n        var patternTransform = def.getAttribute('patternTransform');\n        def = def.getHrefAttribute().getDefinition();\n\n        if (patternTransform.hasValue()) {\n          def.getAttribute('patternTransform', true).setValue(patternTransform.value);\n        }\n      }\n\n      return def.createPattern(this.document.ctx, element, opacity);\n    }\n\n    return null;\n  }\n\n  getTextBaseline() {\n    if (!this.hasValue()) {\n      return null;\n    }\n\n    return Property.textBaselineMapping[this.getString()];\n  }\n\n  addOpacity(opacity) {\n    var value = this.getColor();\n    var len = value.length;\n    var commas = 0; // Simulate old RGBColor version, which can't parse rgba.\n\n    for (var i = 0; i < len; i++) {\n      if (value[i] === ',') {\n        commas++;\n      }\n\n      if (commas === 3) {\n        break;\n      }\n    }\n\n    if (opacity.hasValue() && this.isString() && commas !== 3) {\n      var color = new RGBColor(value);\n\n      if (color.ok) {\n        color.alpha = opacity.getNumber();\n        value = color.toRGBA();\n      }\n    }\n\n    return new Property(this.document, this.name, value);\n  }\n\n}\nProperty.textBaselineMapping = {\n  'baseline': 'alphabetic',\n  'before-edge': 'top',\n  'text-before-edge': 'top',\n  'middle': 'middle',\n  'central': 'middle',\n  'after-edge': 'bottom',\n  'text-after-edge': 'bottom',\n  'ideographic': 'ideographic',\n  'alphabetic': 'alphabetic',\n  'hanging': 'hanging',\n  'mathematical': 'alphabetic'\n};\n\nclass ViewPort {\n  constructor() {\n    this.viewPorts = [];\n  }\n\n  clear() {\n    this.viewPorts = [];\n  }\n\n  setCurrent(width, height) {\n    this.viewPorts.push({\n      width,\n      height\n    });\n  }\n\n  removeCurrent() {\n    this.viewPorts.pop();\n  }\n\n  getCurrent() {\n    var {\n      viewPorts\n    } = this;\n    return viewPorts[viewPorts.length - 1];\n  }\n\n  get width() {\n    return this.getCurrent().width;\n  }\n\n  get height() {\n    return this.getCurrent().height;\n  }\n\n  computeSize(d) {\n    if (typeof d === 'number') {\n      return d;\n    }\n\n    if (d === 'x') {\n      return this.width;\n    }\n\n    if (d === 'y') {\n      return this.height;\n    }\n\n    return Math.sqrt(Math.pow(this.width, 2) + Math.pow(this.height, 2)) / Math.sqrt(2);\n  }\n\n}\n\nclass Point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  static parse(point) {\n    var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var [x = defaultValue, y = defaultValue] = toNumbers(point);\n    return new Point(x, y);\n  }\n\n  static parseScale(scale) {\n    var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    var [x = defaultValue, y = x] = toNumbers(scale);\n    return new Point(x, y);\n  }\n\n  static parsePath(path) {\n    var points = toNumbers(path);\n    var len = points.length;\n    var pathPoints = [];\n\n    for (var i = 0; i < len; i += 2) {\n      pathPoints.push(new Point(points[i], points[i + 1]));\n    }\n\n    return pathPoints;\n  }\n\n  angleTo(point) {\n    return Math.atan2(point.y - this.y, point.x - this.x);\n  }\n\n  applyTransform(transform) {\n    var {\n      x,\n      y\n    } = this;\n    var xp = x * transform[0] + y * transform[2] + transform[4];\n    var yp = x * transform[1] + y * transform[3] + transform[5];\n    this.x = xp;\n    this.y = yp;\n  }\n\n}\n\nclass Mouse {\n  constructor(screen) {\n    this.screen = screen;\n    this.working = false;\n    this.events = [];\n    this.eventElements = []; // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n\n    this.onClick = this.onClick.bind(this); // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n\n    this.onMouseMove = this.onMouseMove.bind(this);\n  }\n\n  isWorking() {\n    return this.working;\n  }\n\n  start() {\n    if (this.working) {\n      return;\n    }\n\n    var {\n      screen,\n      onClick,\n      onMouseMove\n    } = this;\n    var canvas = screen.ctx.canvas;\n    canvas.onclick = onClick;\n    canvas.onmousemove = onMouseMove;\n    this.working = true;\n  }\n\n  stop() {\n    if (!this.working) {\n      return;\n    }\n\n    var canvas = this.screen.ctx.canvas;\n    this.working = false;\n    canvas.onclick = null;\n    canvas.onmousemove = null;\n  }\n\n  hasEvents() {\n    return this.working && this.events.length > 0;\n  }\n\n  runEvents() {\n    if (!this.working) {\n      return;\n    }\n\n    var {\n      screen: document,\n      events,\n      eventElements\n    } = this;\n    var {\n      style\n    } = document.ctx.canvas;\n\n    if (style) {\n      style.cursor = '';\n    }\n\n    events.forEach((_ref, i) => {\n      var {\n        run\n      } = _ref;\n      var element = eventElements[i];\n\n      while (element) {\n        run(element);\n        element = element.parent;\n      }\n    }); // done running, clear\n\n    this.events = [];\n    this.eventElements = [];\n  }\n\n  checkPath(element, ctx) {\n    if (!this.working || !ctx) {\n      return;\n    }\n\n    var {\n      events,\n      eventElements\n    } = this;\n    events.forEach((_ref2, i) => {\n      var {\n        x,\n        y\n      } = _ref2;\n\n      if (!eventElements[i] && ctx.isPointInPath && ctx.isPointInPath(x, y)) {\n        eventElements[i] = element;\n      }\n    });\n  }\n\n  checkBoundingBox(element, boundingBox) {\n    if (!this.working || !boundingBox) {\n      return;\n    }\n\n    var {\n      events,\n      eventElements\n    } = this;\n    events.forEach((_ref3, i) => {\n      var {\n        x,\n        y\n      } = _ref3;\n\n      if (!eventElements[i] && boundingBox.isPointInBox(x, y)) {\n        eventElements[i] = element;\n      }\n    });\n  }\n\n  mapXY(x, y) {\n    var {\n      window,\n      ctx\n    } = this.screen;\n    var point = new Point(x, y);\n    var element = ctx.canvas;\n\n    while (element) {\n      point.x -= element.offsetLeft;\n      point.y -= element.offsetTop;\n      element = element.offsetParent;\n    }\n\n    if (window.scrollX) {\n      point.x += window.scrollX;\n    }\n\n    if (window.scrollY) {\n      point.y += window.scrollY;\n    }\n\n    return point;\n  }\n\n  onClick(event) {\n    var {\n      x,\n      y\n    } = this.mapXY(event.clientX, event.clientY);\n    this.events.push({\n      type: 'onclick',\n      x,\n      y,\n\n      run(eventTarget) {\n        if (eventTarget.onClick) {\n          eventTarget.onClick();\n        }\n      }\n\n    });\n  }\n\n  onMouseMove(event) {\n    var {\n      x,\n      y\n    } = this.mapXY(event.clientX, event.clientY);\n    this.events.push({\n      type: 'onmousemove',\n      x,\n      y,\n\n      run(eventTarget) {\n        if (eventTarget.onMouseMove) {\n          eventTarget.onMouseMove();\n        }\n      }\n\n    });\n  }\n\n}\n\nvar defaultWindow = typeof window !== 'undefined' ? window : null;\nvar defaultFetch$1 = typeof fetch !== 'undefined' ? fetch.bind(undefined) // `fetch` depends on context: `someObject.fetch(...)` will throw error.\n: null;\nclass Screen {\n  constructor(ctx) {\n    var {\n      fetch = defaultFetch$1,\n      window = defaultWindow\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.ctx = ctx;\n    this.FRAMERATE = 30;\n    this.MAX_VIRTUAL_PIXELS = 30000;\n    this.CLIENT_WIDTH = 800;\n    this.CLIENT_HEIGHT = 600;\n    this.viewPort = new ViewPort();\n    this.mouse = new Mouse(this);\n    this.animations = [];\n    this.waits = [];\n    this.frameDuration = 0;\n    this.isReadyLock = false;\n    this.isFirstRender = true;\n    this.intervalId = null;\n    this.window = window;\n    this.fetch = fetch;\n  }\n\n  wait(checker) {\n    this.waits.push(checker);\n  }\n\n  ready() {\n    // eslint-disable-next-line @typescript-eslint/no-misused-promises\n    if (!this.readyPromise) {\n      return Promise.resolve();\n    }\n\n    return this.readyPromise;\n  }\n\n  isReady() {\n    if (this.isReadyLock) {\n      return true;\n    }\n\n    var isReadyLock = this.waits.every(_ => _());\n\n    if (isReadyLock) {\n      this.waits = [];\n\n      if (this.resolveReady) {\n        this.resolveReady();\n      }\n    }\n\n    this.isReadyLock = isReadyLock;\n    return isReadyLock;\n  }\n\n  setDefaults(ctx) {\n    // initial values and defaults\n    ctx.strokeStyle = 'rgba(0,0,0,0)';\n    ctx.lineCap = 'butt';\n    ctx.lineJoin = 'miter';\n    ctx.miterLimit = 4;\n  }\n\n  setViewBox(_ref) {\n    var {\n      document,\n      ctx,\n      aspectRatio,\n      width,\n      desiredWidth,\n      height,\n      desiredHeight,\n      minX = 0,\n      minY = 0,\n      refX,\n      refY,\n      clip = false,\n      clipX = 0,\n      clipY = 0\n    } = _ref;\n    // aspect ratio - http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\n    var cleanAspectRatio = compressSpaces(aspectRatio).replace(/^defer\\s/, ''); // ignore defer\n\n    var [aspectRatioAlign, aspectRatioMeetOrSlice] = cleanAspectRatio.split(' ');\n    var align = aspectRatioAlign || 'xMidYMid';\n    var meetOrSlice = aspectRatioMeetOrSlice || 'meet'; // calculate scale\n\n    var scaleX = width / desiredWidth;\n    var scaleY = height / desiredHeight;\n    var scaleMin = Math.min(scaleX, scaleY);\n    var scaleMax = Math.max(scaleX, scaleY);\n    var finalDesiredWidth = desiredWidth;\n    var finalDesiredHeight = desiredHeight;\n\n    if (meetOrSlice === 'meet') {\n      finalDesiredWidth *= scaleMin;\n      finalDesiredHeight *= scaleMin;\n    }\n\n    if (meetOrSlice === 'slice') {\n      finalDesiredWidth *= scaleMax;\n      finalDesiredHeight *= scaleMax;\n    }\n\n    var refXProp = new Property(document, 'refX', refX);\n    var refYProp = new Property(document, 'refY', refY);\n    var hasRefs = refXProp.hasValue() && refYProp.hasValue();\n\n    if (hasRefs) {\n      ctx.translate(-scaleMin * refXProp.getPixels('x'), -scaleMin * refYProp.getPixels('y'));\n    }\n\n    if (clip) {\n      var scaledClipX = scaleMin * clipX;\n      var scaledClipY = scaleMin * clipY;\n      ctx.beginPath();\n      ctx.moveTo(scaledClipX, scaledClipY);\n      ctx.lineTo(width, scaledClipY);\n      ctx.lineTo(width, height);\n      ctx.lineTo(scaledClipX, height);\n      ctx.closePath();\n      ctx.clip();\n    }\n\n    if (!hasRefs) {\n      var isMeetMinY = meetOrSlice === 'meet' && scaleMin === scaleY;\n      var isSliceMaxY = meetOrSlice === 'slice' && scaleMax === scaleY;\n      var isMeetMinX = meetOrSlice === 'meet' && scaleMin === scaleX;\n      var isSliceMaxX = meetOrSlice === 'slice' && scaleMax === scaleX;\n\n      if (align.startsWith('xMid') && (isMeetMinY || isSliceMaxY)) {\n        ctx.translate(width / 2.0 - finalDesiredWidth / 2.0, 0);\n      }\n\n      if (align.endsWith('YMid') && (isMeetMinX || isSliceMaxX)) {\n        ctx.translate(0, height / 2.0 - finalDesiredHeight / 2.0);\n      }\n\n      if (align.startsWith('xMax') && (isMeetMinY || isSliceMaxY)) {\n        ctx.translate(width - finalDesiredWidth, 0);\n      }\n\n      if (align.endsWith('YMax') && (isMeetMinX || isSliceMaxX)) {\n        ctx.translate(0, height - finalDesiredHeight);\n      }\n    } // scale\n\n\n    switch (true) {\n      case align === 'none':\n        ctx.scale(scaleX, scaleY);\n        break;\n\n      case meetOrSlice === 'meet':\n        ctx.scale(scaleMin, scaleMin);\n        break;\n\n      case meetOrSlice === 'slice':\n        ctx.scale(scaleMax, scaleMax);\n        break;\n    } // translate\n\n\n    ctx.translate(-minX, -minY);\n  }\n\n  start(element) {\n    var {\n      enableRedraw = false,\n      ignoreMouse = false,\n      ignoreAnimation = false,\n      ignoreDimensions = false,\n      ignoreClear = false,\n      forceRedraw,\n      scaleWidth,\n      scaleHeight,\n      offsetX,\n      offsetY\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var {\n      FRAMERATE,\n      mouse\n    } = this;\n    var frameDuration = 1000 / FRAMERATE;\n    this.frameDuration = frameDuration;\n    this.readyPromise = new Promise(resolve => {\n      this.resolveReady = resolve;\n    });\n\n    if (this.isReady()) {\n      this.render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY);\n    }\n\n    if (!enableRedraw) {\n      return;\n    }\n\n    var now = Date.now();\n    var then = now;\n    var delta = 0;\n\n    var tick = () => {\n      now = Date.now();\n      delta = now - then;\n\n      if (delta >= frameDuration) {\n        then = now - delta % frameDuration;\n\n        if (this.shouldUpdate(ignoreAnimation, forceRedraw)) {\n          this.render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY);\n          mouse.runEvents();\n        }\n      }\n\n      this.intervalId = requestAnimationFrame(tick);\n    };\n\n    if (!ignoreMouse) {\n      mouse.start();\n    }\n\n    this.intervalId = requestAnimationFrame(tick);\n  }\n\n  stop() {\n    if (this.intervalId) {\n      requestAnimationFrame.cancel(this.intervalId);\n      this.intervalId = null;\n    }\n\n    this.mouse.stop();\n  }\n\n  shouldUpdate(ignoreAnimation, forceRedraw) {\n    // need update from animations?\n    if (!ignoreAnimation) {\n      var {\n        frameDuration\n      } = this;\n      var shouldUpdate = this.animations.reduce((shouldUpdate, animation) => animation.update(frameDuration) || shouldUpdate, false);\n\n      if (shouldUpdate) {\n        return true;\n      }\n    } // need update from redraw?\n\n\n    if (typeof forceRedraw === 'function' && forceRedraw()) {\n      return true;\n    }\n\n    if (!this.isReadyLock && this.isReady()) {\n      return true;\n    } // need update from mouse events?\n\n\n    if (this.mouse.hasEvents()) {\n      return true;\n    }\n\n    return false;\n  }\n\n  render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY) {\n    var {\n      CLIENT_WIDTH,\n      CLIENT_HEIGHT,\n      viewPort,\n      ctx,\n      isFirstRender\n    } = this;\n    var canvas = ctx.canvas;\n    viewPort.clear();\n\n    if (canvas.width && canvas.height) {\n      viewPort.setCurrent(canvas.width, canvas.height);\n    } else {\n      viewPort.setCurrent(CLIENT_WIDTH, CLIENT_HEIGHT);\n    }\n\n    var widthStyle = element.getStyle('width');\n    var heightStyle = element.getStyle('height');\n\n    if (!ignoreDimensions && (isFirstRender || typeof scaleWidth !== 'number' && typeof scaleHeight !== 'number')) {\n      // set canvas size\n      if (widthStyle.hasValue()) {\n        canvas.width = widthStyle.getPixels('x');\n\n        if (canvas.style) {\n          canvas.style.width = \"\".concat(canvas.width, \"px\");\n        }\n      }\n\n      if (heightStyle.hasValue()) {\n        canvas.height = heightStyle.getPixels('y');\n\n        if (canvas.style) {\n          canvas.style.height = \"\".concat(canvas.height, \"px\");\n        }\n      }\n    }\n\n    var cWidth = canvas.clientWidth || canvas.width;\n    var cHeight = canvas.clientHeight || canvas.height;\n\n    if (ignoreDimensions && widthStyle.hasValue() && heightStyle.hasValue()) {\n      cWidth = widthStyle.getPixels('x');\n      cHeight = heightStyle.getPixels('y');\n    }\n\n    viewPort.setCurrent(cWidth, cHeight);\n\n    if (typeof offsetX === 'number') {\n      element.getAttribute('x', true).setValue(offsetX);\n    }\n\n    if (typeof offsetY === 'number') {\n      element.getAttribute('y', true).setValue(offsetY);\n    }\n\n    if (typeof scaleWidth === 'number' || typeof scaleHeight === 'number') {\n      var viewBox = toNumbers(element.getAttribute('viewBox').getString());\n      var xRatio = 0;\n      var yRatio = 0;\n\n      if (typeof scaleWidth === 'number') {\n        var _widthStyle = element.getStyle('width');\n\n        if (_widthStyle.hasValue()) {\n          xRatio = _widthStyle.getPixels('x') / scaleWidth;\n        } else if (!isNaN(viewBox[2])) {\n          xRatio = viewBox[2] / scaleWidth;\n        }\n      }\n\n      if (typeof scaleHeight === 'number') {\n        var _heightStyle = element.getStyle('height');\n\n        if (_heightStyle.hasValue()) {\n          yRatio = _heightStyle.getPixels('y') / scaleHeight;\n        } else if (!isNaN(viewBox[3])) {\n          yRatio = viewBox[3] / scaleHeight;\n        }\n      }\n\n      if (!xRatio) {\n        xRatio = yRatio;\n      }\n\n      if (!yRatio) {\n        yRatio = xRatio;\n      }\n\n      element.getAttribute('width', true).setValue(scaleWidth);\n      element.getAttribute('height', true).setValue(scaleHeight);\n      var transformStyle = element.getStyle('transform', true, true);\n      transformStyle.setValue(\"\".concat(transformStyle.getString(), \" scale(\").concat(1.0 / xRatio, \", \").concat(1.0 / yRatio, \")\"));\n    } // clear and render\n\n\n    if (!ignoreClear) {\n      ctx.clearRect(0, 0, cWidth, cHeight);\n    }\n\n    element.render(ctx);\n\n    if (isFirstRender) {\n      this.isFirstRender = false;\n    }\n  }\n\n}\nScreen.defaultWindow = defaultWindow;\nScreen.defaultFetch = defaultFetch$1;\n\nvar {\n  defaultFetch\n} = Screen;\nvar DefaultDOMParser = typeof DOMParser !== 'undefined' ? DOMParser : null;\nclass Parser {\n  constructor() {\n    var {\n      fetch = defaultFetch,\n      DOMParser = DefaultDOMParser\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.fetch = fetch;\n    this.DOMParser = DOMParser;\n  }\n\n  parse(resource) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (resource.startsWith('<')) {\n        return _this.parseFromString(resource);\n      }\n\n      return _this.load(resource);\n    })();\n  }\n\n  parseFromString(xml) {\n    var parser = new this.DOMParser();\n\n    try {\n      return this.checkDocument(parser.parseFromString(xml, 'image/svg+xml'));\n    } catch (err) {\n      return this.checkDocument(parser.parseFromString(xml, 'text/xml'));\n    }\n  }\n\n  checkDocument(document) {\n    var parserError = document.getElementsByTagName('parsererror')[0];\n\n    if (parserError) {\n      throw new Error(parserError.textContent);\n    }\n\n    return document;\n  }\n\n  load(url) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var response = yield _this2.fetch(url);\n      var xml = yield response.text();\n      return _this2.parseFromString(xml);\n    })();\n  }\n\n}\n\nclass Translate {\n  constructor(_, point) {\n    this.type = 'translate';\n    this.point = null;\n    this.point = Point.parse(point);\n  }\n\n  apply(ctx) {\n    var {\n      x,\n      y\n    } = this.point;\n    ctx.translate(x || 0.0, y || 0.0);\n  }\n\n  unapply(ctx) {\n    var {\n      x,\n      y\n    } = this.point;\n    ctx.translate(-1.0 * x || 0.0, -1.0 * y || 0.0);\n  }\n\n  applyToPoint(point) {\n    var {\n      x,\n      y\n    } = this.point;\n    point.applyTransform([1, 0, 0, 1, x || 0.0, y || 0.0]);\n  }\n\n}\n\nclass Rotate {\n  constructor(document, rotate, transformOrigin) {\n    this.type = 'rotate';\n    this.angle = null;\n    this.originX = null;\n    this.originY = null;\n    this.cx = 0;\n    this.cy = 0;\n    var numbers = toNumbers(rotate);\n    this.angle = new Property(document, 'angle', numbers[0]);\n    this.originX = transformOrigin[0];\n    this.originY = transformOrigin[1];\n    this.cx = numbers[1] || 0;\n    this.cy = numbers[2] || 0;\n  }\n\n  apply(ctx) {\n    var {\n      cx,\n      cy,\n      originX,\n      originY,\n      angle\n    } = this;\n    var tx = cx + originX.getPixels('x');\n    var ty = cy + originY.getPixels('y');\n    ctx.translate(tx, ty);\n    ctx.rotate(angle.getRadians());\n    ctx.translate(-tx, -ty);\n  }\n\n  unapply(ctx) {\n    var {\n      cx,\n      cy,\n      originX,\n      originY,\n      angle\n    } = this;\n    var tx = cx + originX.getPixels('x');\n    var ty = cy + originY.getPixels('y');\n    ctx.translate(tx, ty);\n    ctx.rotate(-1.0 * angle.getRadians());\n    ctx.translate(-tx, -ty);\n  }\n\n  applyToPoint(point) {\n    var {\n      cx,\n      cy,\n      angle\n    } = this;\n    var rad = angle.getRadians();\n    point.applyTransform([1, 0, 0, 1, cx || 0.0, cy || 0.0 // this.p.y\n    ]);\n    point.applyTransform([Math.cos(rad), Math.sin(rad), -Math.sin(rad), Math.cos(rad), 0, 0]);\n    point.applyTransform([1, 0, 0, 1, -cx || 0.0, -cy || 0.0 // -this.p.y\n    ]);\n  }\n\n}\n\nclass Scale {\n  constructor(_, scale, transformOrigin) {\n    this.type = 'scale';\n    this.scale = null;\n    this.originX = null;\n    this.originY = null;\n    var scaleSize = Point.parseScale(scale); // Workaround for node-canvas\n\n    if (scaleSize.x === 0 || scaleSize.y === 0) {\n      scaleSize.x = PSEUDO_ZERO;\n      scaleSize.y = PSEUDO_ZERO;\n    }\n\n    this.scale = scaleSize;\n    this.originX = transformOrigin[0];\n    this.originY = transformOrigin[1];\n  }\n\n  apply(ctx) {\n    var {\n      scale: {\n        x,\n        y\n      },\n      originX,\n      originY\n    } = this;\n    var tx = originX.getPixels('x');\n    var ty = originY.getPixels('y');\n    ctx.translate(tx, ty);\n    ctx.scale(x, y || x);\n    ctx.translate(-tx, -ty);\n  }\n\n  unapply(ctx) {\n    var {\n      scale: {\n        x,\n        y\n      },\n      originX,\n      originY\n    } = this;\n    var tx = originX.getPixels('x');\n    var ty = originY.getPixels('y');\n    ctx.translate(tx, ty);\n    ctx.scale(1.0 / x, 1.0 / y || x);\n    ctx.translate(-tx, -ty);\n  }\n\n  applyToPoint(point) {\n    var {\n      x,\n      y\n    } = this.scale;\n    point.applyTransform([x || 0.0, 0, 0, y || 0.0, 0, 0]);\n  }\n\n}\n\nclass Matrix {\n  constructor(_, matrix, transformOrigin) {\n    this.type = 'matrix';\n    this.matrix = [];\n    this.originX = null;\n    this.originY = null;\n    this.matrix = toNumbers(matrix);\n    this.originX = transformOrigin[0];\n    this.originY = transformOrigin[1];\n  }\n\n  apply(ctx) {\n    var {\n      originX,\n      originY,\n      matrix\n    } = this;\n    var tx = originX.getPixels('x');\n    var ty = originY.getPixels('y');\n    ctx.translate(tx, ty);\n    ctx.transform(matrix[0], matrix[1], matrix[2], matrix[3], matrix[4], matrix[5]);\n    ctx.translate(-tx, -ty);\n  }\n\n  unapply(ctx) {\n    var {\n      originX,\n      originY,\n      matrix\n    } = this;\n    var a = matrix[0];\n    var b = matrix[2];\n    var c = matrix[4];\n    var d = matrix[1];\n    var e = matrix[3];\n    var f = matrix[5];\n    var g = 0.0;\n    var h = 0.0;\n    var i = 1.0;\n    var det = 1 / (a * (e * i - f * h) - b * (d * i - f * g) + c * (d * h - e * g));\n    var tx = originX.getPixels('x');\n    var ty = originY.getPixels('y');\n    ctx.translate(tx, ty);\n    ctx.transform(det * (e * i - f * h), det * (f * g - d * i), det * (c * h - b * i), det * (a * i - c * g), det * (b * f - c * e), det * (c * d - a * f));\n    ctx.translate(-tx, -ty);\n  }\n\n  applyToPoint(point) {\n    point.applyTransform(this.matrix);\n  }\n\n}\n\nclass Skew extends Matrix {\n  constructor(document, skew, transformOrigin) {\n    super(document, skew, transformOrigin);\n    this.type = 'skew';\n    this.angle = null;\n    this.angle = new Property(document, 'angle', skew);\n  }\n\n}\n\nclass SkewX extends Skew {\n  constructor(document, skew, transformOrigin) {\n    super(document, skew, transformOrigin);\n    this.type = 'skewX';\n    this.matrix = [1, 0, Math.tan(this.angle.getRadians()), 1, 0, 0];\n  }\n\n}\n\nclass SkewY extends Skew {\n  constructor(document, skew, transformOrigin) {\n    super(document, skew, transformOrigin);\n    this.type = 'skewY';\n    this.matrix = [1, Math.tan(this.angle.getRadians()), 0, 1, 0, 0];\n  }\n\n}\n\nfunction parseTransforms(transform) {\n  return compressSpaces(transform).trim().replace(/\\)([a-zA-Z])/g, ') $1').replace(/\\)(\\s?,\\s?)/g, ') ').split(/\\s(?=[a-z])/);\n}\n\nfunction parseTransform(transform) {\n  var [type, value] = transform.split('(');\n  return [type.trim(), value.trim().replace(')', '')];\n}\n\nclass Transform {\n  constructor(document, transform, transformOrigin) {\n    this.document = document;\n    this.transforms = [];\n    var data = parseTransforms(transform);\n    data.forEach(transform => {\n      if (transform === 'none') {\n        return;\n      }\n\n      var [type, value] = parseTransform(transform);\n      var TransformType = Transform.transformTypes[type];\n\n      if (typeof TransformType !== 'undefined') {\n        this.transforms.push(new TransformType(this.document, value, transformOrigin));\n      }\n    });\n  }\n\n  static fromElement(document, element) {\n    var transformStyle = element.getStyle('transform', false, true);\n    var [transformOriginXProperty, transformOriginYProperty = transformOriginXProperty] = element.getStyle('transform-origin', false, true).split();\n    var transformOrigin = [transformOriginXProperty, transformOriginYProperty];\n\n    if (transformStyle.hasValue()) {\n      return new Transform(document, transformStyle.getString(), transformOrigin);\n    }\n\n    return null;\n  }\n\n  apply(ctx) {\n    var {\n      transforms\n    } = this;\n    var len = transforms.length;\n\n    for (var i = 0; i < len; i++) {\n      transforms[i].apply(ctx);\n    }\n  }\n\n  unapply(ctx) {\n    var {\n      transforms\n    } = this;\n    var len = transforms.length;\n\n    for (var i = len - 1; i >= 0; i--) {\n      transforms[i].unapply(ctx);\n    }\n  } // TODO: applyToPoint unused ... remove?\n\n\n  applyToPoint(point) {\n    var {\n      transforms\n    } = this;\n    var len = transforms.length;\n\n    for (var i = 0; i < len; i++) {\n      transforms[i].applyToPoint(point);\n    }\n  }\n\n}\nTransform.transformTypes = {\n  translate: Translate,\n  rotate: Rotate,\n  scale: Scale,\n  matrix: Matrix,\n  skewX: SkewX,\n  skewY: SkewY\n};\n\nclass Element {\n  constructor(document, node) {\n    var captureTextNodes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.document = document;\n    this.node = node;\n    this.captureTextNodes = captureTextNodes;\n    this.attributes = {};\n    this.styles = {};\n    this.stylesSpecificity = {};\n    this.animationFrozen = false;\n    this.animationFrozenValue = '';\n    this.parent = null;\n    this.children = [];\n\n    if (!node || node.nodeType !== 1) {\n      // ELEMENT_NODE\n      return;\n    } // add attributes\n\n\n    Array.from(node.attributes).forEach(attribute => {\n      var nodeName = normalizeAttributeName(attribute.nodeName);\n      this.attributes[nodeName] = new Property(document, nodeName, attribute.value);\n    });\n    this.addStylesFromStyleDefinition(); // add inline styles\n\n    if (this.getAttribute('style').hasValue()) {\n      var styles = this.getAttribute('style').getString().split(';').map(_ => _.trim());\n      styles.forEach(style => {\n        if (!style) {\n          return;\n        }\n\n        var [name, value] = style.split(':').map(_ => _.trim());\n        this.styles[name] = new Property(document, name, value);\n      });\n    }\n\n    var {\n      definitions\n    } = document;\n    var id = this.getAttribute('id'); // add id\n\n    if (id.hasValue()) {\n      if (!definitions[id.getString()]) {\n        definitions[id.getString()] = this;\n      }\n    }\n\n    Array.from(node.childNodes).forEach(childNode => {\n      if (childNode.nodeType === 1) {\n        this.addChild(childNode); // ELEMENT_NODE\n      } else if (captureTextNodes && (childNode.nodeType === 3 || childNode.nodeType === 4)) {\n        var textNode = document.createTextNode(childNode);\n\n        if (textNode.getText().length > 0) {\n          this.addChild(textNode); // TEXT_NODE\n        }\n      }\n    });\n  }\n\n  getAttribute(name) {\n    var createIfNotExists = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var attr = this.attributes[name];\n\n    if (!attr && createIfNotExists) {\n      var _attr = new Property(this.document, name, '');\n\n      this.attributes[name] = _attr;\n      return _attr;\n    }\n\n    return attr || Property.empty(this.document);\n  }\n\n  getHrefAttribute() {\n    for (var key in this.attributes) {\n      if (key === 'href' || key.endsWith(':href')) {\n        return this.attributes[key];\n      }\n    }\n\n    return Property.empty(this.document);\n  }\n\n  getStyle(name) {\n    var createIfNotExists = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var skipAncestors = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var style = this.styles[name];\n\n    if (style) {\n      return style;\n    }\n\n    var attr = this.getAttribute(name);\n\n    if (attr !== null && attr !== void 0 && attr.hasValue()) {\n      this.styles[name] = attr; // move up to me to cache\n\n      return attr;\n    }\n\n    if (!skipAncestors) {\n      var {\n        parent\n      } = this;\n\n      if (parent) {\n        var parentStyle = parent.getStyle(name);\n\n        if (parentStyle !== null && parentStyle !== void 0 && parentStyle.hasValue()) {\n          return parentStyle;\n        }\n      }\n    }\n\n    if (createIfNotExists) {\n      var _style = new Property(this.document, name, '');\n\n      this.styles[name] = _style;\n      return _style;\n    }\n\n    return style || Property.empty(this.document);\n  }\n\n  render(ctx) {\n    // don't render display=none\n    // don't render visibility=hidden\n    if (this.getStyle('display').getString() === 'none' || this.getStyle('visibility').getString() === 'hidden') {\n      return;\n    }\n\n    ctx.save();\n\n    if (this.getStyle('mask').hasValue()) {\n      // mask\n      var mask = this.getStyle('mask').getDefinition();\n\n      if (mask) {\n        this.applyEffects(ctx);\n        mask.apply(ctx, this);\n      }\n    } else if (this.getStyle('filter').getValue('none') !== 'none') {\n      // filter\n      var filter = this.getStyle('filter').getDefinition();\n\n      if (filter) {\n        this.applyEffects(ctx);\n        filter.apply(ctx, this);\n      }\n    } else {\n      this.setContext(ctx);\n      this.renderChildren(ctx);\n      this.clearContext(ctx);\n    }\n\n    ctx.restore();\n  }\n\n  setContext(_) {// NO RENDER\n  }\n\n  applyEffects(ctx) {\n    // transform\n    var transform = Transform.fromElement(this.document, this);\n\n    if (transform) {\n      transform.apply(ctx);\n    } // clip\n\n\n    var clipPathStyleProp = this.getStyle('clip-path', false, true);\n\n    if (clipPathStyleProp.hasValue()) {\n      var clip = clipPathStyleProp.getDefinition();\n\n      if (clip) {\n        clip.apply(ctx);\n      }\n    }\n  }\n\n  clearContext(_) {// NO RENDER\n  }\n\n  renderChildren(ctx) {\n    this.children.forEach(child => {\n      child.render(ctx);\n    });\n  }\n\n  addChild(childNode) {\n    var child = childNode instanceof Element ? childNode : this.document.createElement(childNode);\n    child.parent = this;\n\n    if (!Element.ignoreChildTypes.includes(child.type)) {\n      this.children.push(child);\n    }\n  }\n\n  matchesSelector(selector) {\n    var {\n      node\n    } = this;\n\n    if (typeof node.matches === 'function') {\n      return node.matches(selector);\n    }\n\n    var styleClasses = node.getAttribute('class');\n\n    if (!styleClasses || styleClasses === '') {\n      return false;\n    }\n\n    return styleClasses.split(' ').some(styleClass => \".\".concat(styleClass) === selector);\n  }\n\n  addStylesFromStyleDefinition() {\n    var {\n      styles,\n      stylesSpecificity\n    } = this.document;\n\n    for (var selector in styles) {\n      if (!selector.startsWith('@') && this.matchesSelector(selector)) {\n        var style = styles[selector];\n        var specificity = stylesSpecificity[selector];\n\n        if (style) {\n          for (var name in style) {\n            var existingSpecificity = this.stylesSpecificity[name];\n\n            if (typeof existingSpecificity === 'undefined') {\n              existingSpecificity = '000';\n            }\n\n            if (specificity >= existingSpecificity) {\n              this.styles[name] = style[name];\n              this.stylesSpecificity[name] = specificity;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  removeStyles(element, ignoreStyles) {\n    var toRestore = ignoreStyles.reduce((toRestore, name) => {\n      var styleProp = element.getStyle(name);\n\n      if (!styleProp.hasValue()) {\n        return toRestore;\n      }\n\n      var value = styleProp.getString();\n      styleProp.setValue('');\n      return [...toRestore, [name, value]];\n    }, []);\n    return toRestore;\n  }\n\n  restoreStyles(element, styles) {\n    styles.forEach((_ref) => {\n      var [name, value] = _ref;\n      element.getStyle(name, true).setValue(value);\n    });\n  }\n\n}\nElement.ignoreChildTypes = ['title'];\n\nclass UnknownElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n  }\n\n}\n\nfunction wrapFontFamily(fontFamily) {\n  var trimmed = fontFamily.trim();\n  return /^('|\")/.test(trimmed) ? trimmed : \"\\\"\".concat(trimmed, \"\\\"\");\n}\n\nfunction prepareFontFamily(fontFamily) {\n  return typeof process === 'undefined' ? fontFamily : fontFamily.trim().split(',').map(wrapFontFamily).join(',');\n}\n/**\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-style\r\n * @param fontStyle\r\n * @returns CSS font style.\r\n */\n\n\nfunction prepareFontStyle(fontStyle) {\n  if (!fontStyle) {\n    return '';\n  }\n\n  var targetFontStyle = fontStyle.trim().toLowerCase();\n\n  switch (targetFontStyle) {\n    case 'normal':\n    case 'italic':\n    case 'oblique':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontStyle;\n\n    default:\n      if (/^oblique\\s+(-|)\\d+deg$/.test(targetFontStyle)) {\n        return targetFontStyle;\n      }\n\n      return '';\n  }\n}\n/**\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\r\n * @param fontWeight\r\n * @returns CSS font weight.\r\n */\n\n\nfunction prepareFontWeight(fontWeight) {\n  if (!fontWeight) {\n    return '';\n  }\n\n  var targetFontWeight = fontWeight.trim().toLowerCase();\n\n  switch (targetFontWeight) {\n    case 'normal':\n    case 'bold':\n    case 'lighter':\n    case 'bolder':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontWeight;\n\n    default:\n      if (/^[\\d.]+$/.test(targetFontWeight)) {\n        return targetFontWeight;\n      }\n\n      return '';\n  }\n}\n\nclass Font {\n  constructor(fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit) {\n    var inheritFont = inherit ? typeof inherit === 'string' ? Font.parse(inherit) : inherit : {};\n    this.fontFamily = fontFamily || inheritFont.fontFamily;\n    this.fontSize = fontSize || inheritFont.fontSize;\n    this.fontStyle = fontStyle || inheritFont.fontStyle;\n    this.fontWeight = fontWeight || inheritFont.fontWeight;\n    this.fontVariant = fontVariant || inheritFont.fontVariant;\n  }\n\n  static parse() {\n    var font = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var inherit = arguments.length > 1 ? arguments[1] : undefined;\n    var fontStyle = '';\n    var fontVariant = '';\n    var fontWeight = '';\n    var fontSize = '';\n    var fontFamily = '';\n    var parts = compressSpaces(font).trim().split(' ');\n    var set = {\n      fontSize: false,\n      fontStyle: false,\n      fontWeight: false,\n      fontVariant: false\n    };\n    parts.forEach(part => {\n      switch (true) {\n        case !set.fontStyle && Font.styles.includes(part):\n          if (part !== 'inherit') {\n            fontStyle = part;\n          }\n\n          set.fontStyle = true;\n          break;\n\n        case !set.fontVariant && Font.variants.includes(part):\n          if (part !== 'inherit') {\n            fontVariant = part;\n          }\n\n          set.fontStyle = true;\n          set.fontVariant = true;\n          break;\n\n        case !set.fontWeight && Font.weights.includes(part):\n          if (part !== 'inherit') {\n            fontWeight = part;\n          }\n\n          set.fontStyle = true;\n          set.fontVariant = true;\n          set.fontWeight = true;\n          break;\n\n        case !set.fontSize:\n          if (part !== 'inherit') {\n            [fontSize] = part.split('/');\n          }\n\n          set.fontStyle = true;\n          set.fontVariant = true;\n          set.fontWeight = true;\n          set.fontSize = true;\n          break;\n\n        default:\n          if (part !== 'inherit') {\n            fontFamily += part;\n          }\n\n      }\n    });\n    return new Font(fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit);\n  }\n\n  toString() {\n    return [prepareFontStyle(this.fontStyle), this.fontVariant, prepareFontWeight(this.fontWeight), this.fontSize, // Wrap fontFamily only on nodejs and only for canvas.ctx\n    prepareFontFamily(this.fontFamily)].join(' ').trim();\n  }\n\n}\nFont.styles = 'normal|italic|oblique|inherit';\nFont.variants = 'normal|small-caps|inherit';\nFont.weights = 'normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit';\n\nclass BoundingBox {\n  constructor() {\n    var x1 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Number.NaN;\n    var y1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Number.NaN;\n    var x2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : Number.NaN;\n    var y2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Number.NaN;\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n    this.addPoint(x1, y1);\n    this.addPoint(x2, y2);\n  }\n\n  get x() {\n    return this.x1;\n  }\n\n  get y() {\n    return this.y1;\n  }\n\n  get width() {\n    return this.x2 - this.x1;\n  }\n\n  get height() {\n    return this.y2 - this.y1;\n  }\n\n  addPoint(x, y) {\n    if (typeof x !== 'undefined') {\n      if (isNaN(this.x1) || isNaN(this.x2)) {\n        this.x1 = x;\n        this.x2 = x;\n      }\n\n      if (x < this.x1) {\n        this.x1 = x;\n      }\n\n      if (x > this.x2) {\n        this.x2 = x;\n      }\n    }\n\n    if (typeof y !== 'undefined') {\n      if (isNaN(this.y1) || isNaN(this.y2)) {\n        this.y1 = y;\n        this.y2 = y;\n      }\n\n      if (y < this.y1) {\n        this.y1 = y;\n      }\n\n      if (y > this.y2) {\n        this.y2 = y;\n      }\n    }\n  }\n\n  addX(x) {\n    this.addPoint(x, null);\n  }\n\n  addY(y) {\n    this.addPoint(null, y);\n  }\n\n  addBoundingBox(boundingBox) {\n    if (!boundingBox) {\n      return;\n    }\n\n    var {\n      x1,\n      y1,\n      x2,\n      y2\n    } = boundingBox;\n    this.addPoint(x1, y1);\n    this.addPoint(x2, y2);\n  }\n\n  sumCubic(t, p0, p1, p2, p3) {\n    return Math.pow(1 - t, 3) * p0 + 3 * Math.pow(1 - t, 2) * t * p1 + 3 * (1 - t) * Math.pow(t, 2) * p2 + Math.pow(t, 3) * p3;\n  }\n\n  bezierCurveAdd(forX, p0, p1, p2, p3) {\n    var b = 6 * p0 - 12 * p1 + 6 * p2;\n    var a = -3 * p0 + 9 * p1 - 9 * p2 + 3 * p3;\n    var c = 3 * p1 - 3 * p0;\n\n    if (a === 0) {\n      if (b === 0) {\n        return;\n      }\n\n      var t = -c / b;\n\n      if (0 < t && t < 1) {\n        if (forX) {\n          this.addX(this.sumCubic(t, p0, p1, p2, p3));\n        } else {\n          this.addY(this.sumCubic(t, p0, p1, p2, p3));\n        }\n      }\n\n      return;\n    }\n\n    var b2ac = Math.pow(b, 2) - 4 * c * a;\n\n    if (b2ac < 0) {\n      return;\n    }\n\n    var t1 = (-b + Math.sqrt(b2ac)) / (2 * a);\n\n    if (0 < t1 && t1 < 1) {\n      if (forX) {\n        this.addX(this.sumCubic(t1, p0, p1, p2, p3));\n      } else {\n        this.addY(this.sumCubic(t1, p0, p1, p2, p3));\n      }\n    }\n\n    var t2 = (-b - Math.sqrt(b2ac)) / (2 * a);\n\n    if (0 < t2 && t2 < 1) {\n      if (forX) {\n        this.addX(this.sumCubic(t2, p0, p1, p2, p3));\n      } else {\n        this.addY(this.sumCubic(t2, p0, p1, p2, p3));\n      }\n    }\n  } // from http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html\n\n\n  addBezierCurve(p0x, p0y, p1x, p1y, p2x, p2y, p3x, p3y) {\n    this.addPoint(p0x, p0y);\n    this.addPoint(p3x, p3y);\n    this.bezierCurveAdd(true, p0x, p1x, p2x, p3x);\n    this.bezierCurveAdd(false, p0y, p1y, p2y, p3y);\n  }\n\n  addQuadraticCurve(p0x, p0y, p1x, p1y, p2x, p2y) {\n    var cp1x = p0x + 2 / 3 * (p1x - p0x); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\n    var cp1y = p0y + 2 / 3 * (p1y - p0y); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\n    var cp2x = cp1x + 1 / 3 * (p2x - p0x); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\n    var cp2y = cp1y + 1 / 3 * (p2y - p0y); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\n    this.addBezierCurve(p0x, p0y, cp1x, cp2x, cp1y, cp2y, p2x, p2y);\n  }\n\n  isPointInBox(x, y) {\n    var {\n      x1,\n      y1,\n      x2,\n      y2\n    } = this;\n    return x1 <= x && x <= x2 && y1 <= y && y <= y2;\n  }\n\n}\n\nclass PathParser extends SVGPathData {\n  constructor(path) {\n    super(path // Fix spaces after signs.\n    .replace(/([+\\-.])\\s+/gm, '$1') // Remove invalid part.\n    .replace(/[^MmZzLlHhVvCcSsQqTtAae\\d\\s.,+-].*/g, ''));\n    this.control = null;\n    this.start = null;\n    this.current = null;\n    this.command = null;\n    this.commands = this.commands;\n    this.i = -1;\n    this.previousCommand = null;\n    this.points = [];\n    this.angles = [];\n  }\n\n  reset() {\n    this.i = -1;\n    this.command = null;\n    this.previousCommand = null;\n    this.start = new Point(0, 0);\n    this.control = new Point(0, 0);\n    this.current = new Point(0, 0);\n    this.points = [];\n    this.angles = [];\n  }\n\n  isEnd() {\n    var {\n      i,\n      commands\n    } = this;\n    return i >= commands.length - 1;\n  }\n\n  next() {\n    var command = this.commands[++this.i];\n    this.previousCommand = this.command;\n    this.command = command;\n    return command;\n  }\n\n  getPoint() {\n    var xProp = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'x';\n    var yProp = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'y';\n    var point = new Point(this.command[xProp], this.command[yProp]);\n    return this.makeAbsolute(point);\n  }\n\n  getAsControlPoint(xProp, yProp) {\n    var point = this.getPoint(xProp, yProp);\n    this.control = point;\n    return point;\n  }\n\n  getAsCurrentPoint(xProp, yProp) {\n    var point = this.getPoint(xProp, yProp);\n    this.current = point;\n    return point;\n  }\n\n  getReflectedControlPoint() {\n    var previousCommand = this.previousCommand.type;\n\n    if (previousCommand !== SVGPathData.CURVE_TO && previousCommand !== SVGPathData.SMOOTH_CURVE_TO && previousCommand !== SVGPathData.QUAD_TO && previousCommand !== SVGPathData.SMOOTH_QUAD_TO) {\n      return this.current;\n    } // reflect point\n\n\n    var {\n      current: {\n        x: cx,\n        y: cy\n      },\n      control: {\n        x: ox,\n        y: oy\n      }\n    } = this;\n    var point = new Point(2 * cx - ox, 2 * cy - oy);\n    return point;\n  }\n\n  makeAbsolute(point) {\n    if (this.command.relative) {\n      var {\n        x,\n        y\n      } = this.current;\n      point.x += x;\n      point.y += y;\n    }\n\n    return point;\n  }\n\n  addMarker(point, from, priorTo) {\n    var {\n      points,\n      angles\n    } = this; // if the last angle isn't filled in because we didn't have this point yet ...\n\n    if (priorTo && angles.length > 0 && !angles[angles.length - 1]) {\n      angles[angles.length - 1] = points[points.length - 1].angleTo(priorTo);\n    }\n\n    this.addMarkerAngle(point, from ? from.angleTo(point) : null);\n  }\n\n  addMarkerAngle(point, angle) {\n    this.points.push(point);\n    this.angles.push(angle);\n  }\n\n  getMarkerPoints() {\n    return this.points;\n  }\n\n  getMarkerAngles() {\n    var {\n      angles\n    } = this;\n    var len = angles.length;\n\n    for (var i = 0; i < len; i++) {\n      if (!angles[i]) {\n        for (var j = i + 1; j < len; j++) {\n          if (angles[j]) {\n            angles[i] = angles[j];\n            break;\n          }\n        }\n      }\n    }\n\n    return angles;\n  }\n\n}\n\nclass RenderedElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.modifiedEmSizeStack = false;\n  }\n\n  calculateOpacity() {\n    var opacity = 1.0; // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n\n    var element = this;\n\n    while (element) {\n      var opacityStyle = element.getStyle('opacity', false, true); // no ancestors on style call\n\n      if (opacityStyle.hasValue(true)) {\n        opacity *= opacityStyle.getNumber();\n      }\n\n      element = element.parent;\n    }\n\n    return opacity;\n  }\n\n  setContext(ctx) {\n    var fromMeasure = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (!fromMeasure) {\n      // causes stack overflow when measuring text with gradients\n      // fill\n      var fillStyleProp = this.getStyle('fill');\n      var fillOpacityStyleProp = this.getStyle('fill-opacity');\n      var strokeStyleProp = this.getStyle('stroke');\n      var strokeOpacityProp = this.getStyle('stroke-opacity');\n\n      if (fillStyleProp.isUrlDefinition()) {\n        var fillStyle = fillStyleProp.getFillStyleDefinition(this, fillOpacityStyleProp);\n\n        if (fillStyle) {\n          ctx.fillStyle = fillStyle;\n        }\n      } else if (fillStyleProp.hasValue()) {\n        if (fillStyleProp.getString() === 'currentColor') {\n          fillStyleProp.setValue(this.getStyle('color').getColor());\n        }\n\n        var _fillStyle = fillStyleProp.getColor();\n\n        if (_fillStyle !== 'inherit') {\n          ctx.fillStyle = _fillStyle === 'none' ? 'rgba(0,0,0,0)' : _fillStyle;\n        }\n      }\n\n      if (fillOpacityStyleProp.hasValue()) {\n        var _fillStyle2 = new Property(this.document, 'fill', ctx.fillStyle).addOpacity(fillOpacityStyleProp).getColor();\n\n        ctx.fillStyle = _fillStyle2;\n      } // stroke\n\n\n      if (strokeStyleProp.isUrlDefinition()) {\n        var strokeStyle = strokeStyleProp.getFillStyleDefinition(this, strokeOpacityProp);\n\n        if (strokeStyle) {\n          ctx.strokeStyle = strokeStyle;\n        }\n      } else if (strokeStyleProp.hasValue()) {\n        if (strokeStyleProp.getString() === 'currentColor') {\n          strokeStyleProp.setValue(this.getStyle('color').getColor());\n        }\n\n        var _strokeStyle = strokeStyleProp.getString();\n\n        if (_strokeStyle !== 'inherit') {\n          ctx.strokeStyle = _strokeStyle === 'none' ? 'rgba(0,0,0,0)' : _strokeStyle;\n        }\n      }\n\n      if (strokeOpacityProp.hasValue()) {\n        var _strokeStyle2 = new Property(this.document, 'stroke', ctx.strokeStyle).addOpacity(strokeOpacityProp).getString();\n\n        ctx.strokeStyle = _strokeStyle2;\n      }\n\n      var strokeWidthStyleProp = this.getStyle('stroke-width');\n\n      if (strokeWidthStyleProp.hasValue()) {\n        var newLineWidth = strokeWidthStyleProp.getPixels();\n        ctx.lineWidth = !newLineWidth ? PSEUDO_ZERO // browsers don't respect 0 (or node-canvas? :-)\n        : newLineWidth;\n      }\n\n      var strokeLinecapStyleProp = this.getStyle('stroke-linecap');\n      var strokeLinejoinStyleProp = this.getStyle('stroke-linejoin');\n      var strokeMiterlimitProp = this.getStyle('stroke-miterlimit'); // NEED TEST\n      // const pointOrderStyleProp = this.getStyle('paint-order');\n\n      var strokeDasharrayStyleProp = this.getStyle('stroke-dasharray');\n      var strokeDashoffsetProp = this.getStyle('stroke-dashoffset');\n\n      if (strokeLinecapStyleProp.hasValue()) {\n        ctx.lineCap = strokeLinecapStyleProp.getString();\n      }\n\n      if (strokeLinejoinStyleProp.hasValue()) {\n        ctx.lineJoin = strokeLinejoinStyleProp.getString();\n      }\n\n      if (strokeMiterlimitProp.hasValue()) {\n        ctx.miterLimit = strokeMiterlimitProp.getNumber();\n      } // NEED TEST\n      // if (pointOrderStyleProp.hasValue()) {\n      // \t// ?\n      // \tctx.paintOrder = pointOrderStyleProp.getValue();\n      // }\n\n\n      if (strokeDasharrayStyleProp.hasValue() && strokeDasharrayStyleProp.getString() !== 'none') {\n        var gaps = toNumbers(strokeDasharrayStyleProp.getString());\n\n        if (typeof ctx.setLineDash !== 'undefined') {\n          ctx.setLineDash(gaps);\n        } else // @ts-expect-error Handle browser prefix.\n          if (typeof ctx.webkitLineDash !== 'undefined') {\n            // @ts-expect-error Handle browser prefix.\n            ctx.webkitLineDash = gaps;\n          } else // @ts-expect-error Handle browser prefix.\n            if (typeof ctx.mozDash !== 'undefined' && !(gaps.length === 1 && gaps[0] === 0)) {\n              // @ts-expect-error Handle browser prefix.\n              ctx.mozDash = gaps;\n            }\n\n        var offset = strokeDashoffsetProp.getPixels();\n\n        if (typeof ctx.lineDashOffset !== 'undefined') {\n          ctx.lineDashOffset = offset;\n        } else // @ts-expect-error Handle browser prefix.\n          if (typeof ctx.webkitLineDashOffset !== 'undefined') {\n            // @ts-expect-error Handle browser prefix.\n            ctx.webkitLineDashOffset = offset;\n          } else // @ts-expect-error Handle browser prefix.\n            if (typeof ctx.mozDashOffset !== 'undefined') {\n              // @ts-expect-error Handle browser prefix.\n              ctx.mozDashOffset = offset;\n            }\n      }\n    } // font\n\n\n    this.modifiedEmSizeStack = false;\n\n    if (typeof ctx.font !== 'undefined') {\n      var fontStyleProp = this.getStyle('font');\n      var fontStyleStyleProp = this.getStyle('font-style');\n      var fontVariantStyleProp = this.getStyle('font-variant');\n      var fontWeightStyleProp = this.getStyle('font-weight');\n      var fontSizeStyleProp = this.getStyle('font-size');\n      var fontFamilyStyleProp = this.getStyle('font-family');\n      var font = new Font(fontStyleStyleProp.getString(), fontVariantStyleProp.getString(), fontWeightStyleProp.getString(), fontSizeStyleProp.hasValue() ? \"\".concat(fontSizeStyleProp.getPixels(true), \"px\") : '', fontFamilyStyleProp.getString(), Font.parse(fontStyleProp.getString(), ctx.font));\n      fontStyleStyleProp.setValue(font.fontStyle);\n      fontVariantStyleProp.setValue(font.fontVariant);\n      fontWeightStyleProp.setValue(font.fontWeight);\n      fontSizeStyleProp.setValue(font.fontSize);\n      fontFamilyStyleProp.setValue(font.fontFamily);\n      ctx.font = font.toString();\n\n      if (fontSizeStyleProp.isPixels()) {\n        this.document.emSize = fontSizeStyleProp.getPixels();\n        this.modifiedEmSizeStack = true;\n      }\n    }\n\n    if (!fromMeasure) {\n      // effects\n      this.applyEffects(ctx); // opacity\n\n      ctx.globalAlpha = this.calculateOpacity();\n    }\n  }\n\n  clearContext(ctx) {\n    super.clearContext(ctx);\n\n    if (this.modifiedEmSizeStack) {\n      this.document.popEmSize();\n    }\n  }\n\n}\n\nclass PathElement extends RenderedElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'path';\n    this.pathParser = null;\n    this.pathParser = new PathParser(this.getAttribute('d').getString());\n  }\n\n  path(ctx) {\n    var {\n      pathParser\n    } = this;\n    var boundingBox = new BoundingBox();\n    pathParser.reset();\n\n    if (ctx) {\n      ctx.beginPath();\n    }\n\n    while (!pathParser.isEnd()) {\n      switch (pathParser.next().type) {\n        case PathParser.MOVE_TO:\n          this.pathM(ctx, boundingBox);\n          break;\n\n        case PathParser.LINE_TO:\n          this.pathL(ctx, boundingBox);\n          break;\n\n        case PathParser.HORIZ_LINE_TO:\n          this.pathH(ctx, boundingBox);\n          break;\n\n        case PathParser.VERT_LINE_TO:\n          this.pathV(ctx, boundingBox);\n          break;\n\n        case PathParser.CURVE_TO:\n          this.pathC(ctx, boundingBox);\n          break;\n\n        case PathParser.SMOOTH_CURVE_TO:\n          this.pathS(ctx, boundingBox);\n          break;\n\n        case PathParser.QUAD_TO:\n          this.pathQ(ctx, boundingBox);\n          break;\n\n        case PathParser.SMOOTH_QUAD_TO:\n          this.pathT(ctx, boundingBox);\n          break;\n\n        case PathParser.ARC:\n          this.pathA(ctx, boundingBox);\n          break;\n\n        case PathParser.CLOSE_PATH:\n          this.pathZ(ctx, boundingBox);\n          break;\n      }\n    }\n\n    return boundingBox;\n  }\n\n  getBoundingBox(_) {\n    return this.path();\n  }\n\n  getMarkers() {\n    var {\n      pathParser\n    } = this;\n    var points = pathParser.getMarkerPoints();\n    var angles = pathParser.getMarkerAngles();\n    var markers = points.map((point, i) => [point, angles[i]]);\n    return markers;\n  }\n\n  renderChildren(ctx) {\n    this.path(ctx);\n    this.document.screen.mouse.checkPath(this, ctx);\n    var fillRuleStyleProp = this.getStyle('fill-rule');\n\n    if (ctx.fillStyle !== '') {\n      if (fillRuleStyleProp.getString('inherit') !== 'inherit') {\n        ctx.fill(fillRuleStyleProp.getString());\n      } else {\n        ctx.fill();\n      }\n    }\n\n    if (ctx.strokeStyle !== '') {\n      if (this.getAttribute('vector-effect').getString() === 'non-scaling-stroke') {\n        ctx.save();\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\n        ctx.stroke();\n        ctx.restore();\n      } else {\n        ctx.stroke();\n      }\n    }\n\n    var markers = this.getMarkers();\n\n    if (markers) {\n      var markersLastIndex = markers.length - 1;\n      var markerStartStyleProp = this.getStyle('marker-start');\n      var markerMidStyleProp = this.getStyle('marker-mid');\n      var markerEndStyleProp = this.getStyle('marker-end');\n\n      if (markerStartStyleProp.isUrlDefinition()) {\n        var marker = markerStartStyleProp.getDefinition();\n        var [point, angle] = markers[0];\n        marker.render(ctx, point, angle);\n      }\n\n      if (markerMidStyleProp.isUrlDefinition()) {\n        var _marker = markerMidStyleProp.getDefinition();\n\n        for (var i = 1; i < markersLastIndex; i++) {\n          var [_point, _angle] = markers[i];\n\n          _marker.render(ctx, _point, _angle);\n        }\n      }\n\n      if (markerEndStyleProp.isUrlDefinition()) {\n        var _marker2 = markerEndStyleProp.getDefinition();\n\n        var [_point2, _angle2] = markers[markersLastIndex];\n\n        _marker2.render(ctx, _point2, _angle2);\n      }\n    }\n  }\n\n  static pathM(pathParser) {\n    var point = pathParser.getAsCurrentPoint();\n    pathParser.start = pathParser.current;\n    return {\n      point\n    };\n  }\n\n  pathM(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      point\n    } = PathElement.pathM(pathParser);\n    var {\n      x,\n      y\n    } = point;\n    pathParser.addMarker(point);\n    boundingBox.addPoint(x, y);\n\n    if (ctx) {\n      ctx.moveTo(x, y);\n    }\n  }\n\n  static pathL(pathParser) {\n    var {\n      current\n    } = pathParser;\n    var point = pathParser.getAsCurrentPoint();\n    return {\n      current,\n      point\n    };\n  }\n\n  pathL(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      current,\n      point\n    } = PathElement.pathL(pathParser);\n    var {\n      x,\n      y\n    } = point;\n    pathParser.addMarker(point, current);\n    boundingBox.addPoint(x, y);\n\n    if (ctx) {\n      ctx.lineTo(x, y);\n    }\n  }\n\n  static pathH(pathParser) {\n    var {\n      current,\n      command\n    } = pathParser;\n    var point = new Point((command.relative ? current.x : 0) + command.x, current.y);\n    pathParser.current = point;\n    return {\n      current,\n      point\n    };\n  }\n\n  pathH(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      current,\n      point\n    } = PathElement.pathH(pathParser);\n    var {\n      x,\n      y\n    } = point;\n    pathParser.addMarker(point, current);\n    boundingBox.addPoint(x, y);\n\n    if (ctx) {\n      ctx.lineTo(x, y);\n    }\n  }\n\n  static pathV(pathParser) {\n    var {\n      current,\n      command\n    } = pathParser;\n    var point = new Point(current.x, (command.relative ? current.y : 0) + command.y);\n    pathParser.current = point;\n    return {\n      current,\n      point\n    };\n  }\n\n  pathV(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      current,\n      point\n    } = PathElement.pathV(pathParser);\n    var {\n      x,\n      y\n    } = point;\n    pathParser.addMarker(point, current);\n    boundingBox.addPoint(x, y);\n\n    if (ctx) {\n      ctx.lineTo(x, y);\n    }\n  }\n\n  static pathC(pathParser) {\n    var {\n      current\n    } = pathParser;\n    var point = pathParser.getPoint('x1', 'y1');\n    var controlPoint = pathParser.getAsControlPoint('x2', 'y2');\n    var currentPoint = pathParser.getAsCurrentPoint();\n    return {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    };\n  }\n\n  pathC(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathC(pathParser);\n    pathParser.addMarker(currentPoint, controlPoint, point);\n    boundingBox.addBezierCurve(current.x, current.y, point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n    if (ctx) {\n      ctx.bezierCurveTo(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }\n\n  static pathS(pathParser) {\n    var {\n      current\n    } = pathParser;\n    var point = pathParser.getReflectedControlPoint();\n    var controlPoint = pathParser.getAsControlPoint('x2', 'y2');\n    var currentPoint = pathParser.getAsCurrentPoint();\n    return {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    };\n  }\n\n  pathS(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      current,\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathS(pathParser);\n    pathParser.addMarker(currentPoint, controlPoint, point);\n    boundingBox.addBezierCurve(current.x, current.y, point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n    if (ctx) {\n      ctx.bezierCurveTo(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }\n\n  static pathQ(pathParser) {\n    var {\n      current\n    } = pathParser;\n    var controlPoint = pathParser.getAsControlPoint('x1', 'y1');\n    var currentPoint = pathParser.getAsCurrentPoint();\n    return {\n      current,\n      controlPoint,\n      currentPoint\n    };\n  }\n\n  pathQ(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      current,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathQ(pathParser);\n    pathParser.addMarker(currentPoint, controlPoint, controlPoint);\n    boundingBox.addQuadraticCurve(current.x, current.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n    if (ctx) {\n      ctx.quadraticCurveTo(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }\n\n  static pathT(pathParser) {\n    var {\n      current\n    } = pathParser;\n    var controlPoint = pathParser.getReflectedControlPoint();\n    pathParser.control = controlPoint;\n    var currentPoint = pathParser.getAsCurrentPoint();\n    return {\n      current,\n      controlPoint,\n      currentPoint\n    };\n  }\n\n  pathT(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      current,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathT(pathParser);\n    pathParser.addMarker(currentPoint, controlPoint, controlPoint);\n    boundingBox.addQuadraticCurve(current.x, current.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n    if (ctx) {\n      ctx.quadraticCurveTo(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }\n\n  static pathA(pathParser) {\n    var {\n      current,\n      command\n    } = pathParser;\n    var {\n      rX,\n      rY,\n      xRot,\n      lArcFlag,\n      sweepFlag\n    } = command;\n    var xAxisRotation = xRot * (Math.PI / 180.0);\n    var currentPoint = pathParser.getAsCurrentPoint(); // Conversion from endpoint to center parameterization\n    // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n    // x1', y1'\n\n    var currp = new Point(Math.cos(xAxisRotation) * (current.x - currentPoint.x) / 2.0 + Math.sin(xAxisRotation) * (current.y - currentPoint.y) / 2.0, -Math.sin(xAxisRotation) * (current.x - currentPoint.x) / 2.0 + Math.cos(xAxisRotation) * (current.y - currentPoint.y) / 2.0); // adjust radii\n\n    var l = Math.pow(currp.x, 2) / Math.pow(rX, 2) + Math.pow(currp.y, 2) / Math.pow(rY, 2);\n\n    if (l > 1) {\n      rX *= Math.sqrt(l);\n      rY *= Math.sqrt(l);\n    } // cx', cy'\n\n\n    var s = (lArcFlag === sweepFlag ? -1 : 1) * Math.sqrt((Math.pow(rX, 2) * Math.pow(rY, 2) - Math.pow(rX, 2) * Math.pow(currp.y, 2) - Math.pow(rY, 2) * Math.pow(currp.x, 2)) / (Math.pow(rX, 2) * Math.pow(currp.y, 2) + Math.pow(rY, 2) * Math.pow(currp.x, 2)));\n\n    if (isNaN(s)) {\n      s = 0;\n    }\n\n    var cpp = new Point(s * rX * currp.y / rY, s * -rY * currp.x / rX); // cx, cy\n\n    var centp = new Point((current.x + currentPoint.x) / 2.0 + Math.cos(xAxisRotation) * cpp.x - Math.sin(xAxisRotation) * cpp.y, (current.y + currentPoint.y) / 2.0 + Math.sin(xAxisRotation) * cpp.x + Math.cos(xAxisRotation) * cpp.y); // initial angle\n\n    var a1 = vectorsAngle([1, 0], [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY]); // θ1\n    // angle delta\n\n    var u = [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY];\n    var v = [(-currp.x - cpp.x) / rX, (-currp.y - cpp.y) / rY];\n    var ad = vectorsAngle(u, v); // Δθ\n\n    if (vectorsRatio(u, v) <= -1) {\n      ad = Math.PI;\n    }\n\n    if (vectorsRatio(u, v) >= 1) {\n      ad = 0;\n    }\n\n    return {\n      currentPoint,\n      rX,\n      rY,\n      sweepFlag,\n      xAxisRotation,\n      centp,\n      a1,\n      ad\n    };\n  }\n\n  pathA(ctx, boundingBox) {\n    var {\n      pathParser\n    } = this;\n    var {\n      currentPoint,\n      rX,\n      rY,\n      sweepFlag,\n      xAxisRotation,\n      centp,\n      a1,\n      ad\n    } = PathElement.pathA(pathParser); // for markers\n\n    var dir = 1 - sweepFlag ? 1.0 : -1.0;\n    var ah = a1 + dir * (ad / 2.0);\n    var halfWay = new Point(centp.x + rX * Math.cos(ah), centp.y + rY * Math.sin(ah));\n    pathParser.addMarkerAngle(halfWay, ah - dir * Math.PI / 2);\n    pathParser.addMarkerAngle(currentPoint, ah - dir * Math.PI);\n    boundingBox.addPoint(currentPoint.x, currentPoint.y); // TODO: this is too naive, make it better\n\n    if (ctx && !isNaN(a1) && !isNaN(ad)) {\n      var r = rX > rY ? rX : rY;\n      var sx = rX > rY ? 1 : rX / rY;\n      var sy = rX > rY ? rY / rX : 1;\n      ctx.translate(centp.x, centp.y);\n      ctx.rotate(xAxisRotation);\n      ctx.scale(sx, sy);\n      ctx.arc(0, 0, r, a1, a1 + ad, Boolean(1 - sweepFlag));\n      ctx.scale(1 / sx, 1 / sy);\n      ctx.rotate(-xAxisRotation);\n      ctx.translate(-centp.x, -centp.y);\n    }\n  }\n\n  static pathZ(pathParser) {\n    pathParser.current = pathParser.start;\n  }\n\n  pathZ(ctx, boundingBox) {\n    PathElement.pathZ(this.pathParser);\n\n    if (ctx) {\n      // only close path if it is not a straight line\n      if (boundingBox.x1 !== boundingBox.x2 && boundingBox.y1 !== boundingBox.y2) {\n        ctx.closePath();\n      }\n    }\n  }\n\n}\n\nclass GlyphElement extends PathElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'glyph';\n    this.horizAdvX = this.getAttribute('horiz-adv-x').getNumber();\n    this.unicode = this.getAttribute('unicode').getString();\n    this.arabicForm = this.getAttribute('arabic-form').getString();\n  }\n\n}\n\nclass TextElement extends RenderedElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, new.target === TextElement ? true : captureTextNodes);\n    this.type = 'text';\n    this.x = 0;\n    this.y = 0;\n    this.measureCache = -1;\n  }\n\n  setContext(ctx) {\n    var fromMeasure = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    super.setContext(ctx, fromMeasure);\n    var textBaseline = this.getStyle('dominant-baseline').getTextBaseline() || this.getStyle('alignment-baseline').getTextBaseline();\n\n    if (textBaseline) {\n      ctx.textBaseline = textBaseline;\n    }\n  }\n\n  initializeCoordinates(ctx) {\n    this.x = this.getAttribute('x').getPixels('x');\n    this.y = this.getAttribute('y').getPixels('y');\n    var dxAttr = this.getAttribute('dx');\n    var dyAttr = this.getAttribute('dy');\n\n    if (dxAttr.hasValue()) {\n      this.x += dxAttr.getPixels('x');\n    }\n\n    if (dyAttr.hasValue()) {\n      this.y += dyAttr.getPixels('y');\n    }\n\n    this.x += this.getAnchorDelta(ctx, this, 0);\n  }\n\n  getBoundingBox(ctx) {\n    if (this.type !== 'text') {\n      return this.getTElementBoundingBox(ctx);\n    }\n\n    this.initializeCoordinates(ctx);\n    var boundingBox = null;\n    this.children.forEach((_, i) => {\n      var childBoundingBox = this.getChildBoundingBox(ctx, this, this, i);\n\n      if (!boundingBox) {\n        boundingBox = childBoundingBox;\n      } else {\n        boundingBox.addBoundingBox(childBoundingBox);\n      }\n    });\n    return boundingBox;\n  }\n\n  getFontSize() {\n    var {\n      document,\n      parent\n    } = this;\n    var inheritFontSize = Font.parse(document.ctx.font).fontSize;\n    var fontSize = parent.getStyle('font-size').getNumber(inheritFontSize);\n    return fontSize;\n  }\n\n  getTElementBoundingBox(ctx) {\n    var fontSize = this.getFontSize();\n    return new BoundingBox(this.x, this.y - fontSize, this.x + this.measureText(ctx), this.y);\n  }\n\n  getGlyph(font, text, i) {\n    var char = text[i];\n    var glyph = null;\n\n    if (font.isArabic) {\n      var len = text.length;\n      var prevChar = text[i - 1];\n      var nextChar = text[i + 1];\n      var arabicForm = 'isolated';\n\n      if ((i === 0 || prevChar === ' ') && i < len - 2 && nextChar !== ' ') {\n        arabicForm = 'terminal';\n      }\n\n      if (i > 0 && prevChar !== ' ' && i < len - 2 && nextChar !== ' ') {\n        arabicForm = 'medial';\n      }\n\n      if (i > 0 && prevChar !== ' ' && (i === len - 1 || nextChar === ' ')) {\n        arabicForm = 'initial';\n      }\n\n      if (typeof font.glyphs[char] !== 'undefined') {\n        // NEED TEST\n        var maybeGlyph = font.glyphs[char];\n        glyph = maybeGlyph instanceof GlyphElement ? maybeGlyph : maybeGlyph[arabicForm];\n      }\n    } else {\n      glyph = font.glyphs[char];\n    }\n\n    if (!glyph) {\n      glyph = font.missingGlyph;\n    }\n\n    return glyph;\n  }\n\n  getText() {\n    return '';\n  }\n\n  getTextFromNode(node) {\n    var textNode = node || this.node;\n    var childNodes = Array.from(textNode.parentNode.childNodes);\n    var index = childNodes.indexOf(textNode);\n    var lastIndex = childNodes.length - 1;\n    var text = compressSpaces( // textNode.value\n    // || textNode.text\n    textNode.textContent || '');\n\n    if (index === 0) {\n      text = trimLeft(text);\n    }\n\n    if (index === lastIndex) {\n      text = trimRight(text);\n    }\n\n    return text;\n  }\n\n  renderChildren(ctx) {\n    if (this.type !== 'text') {\n      this.renderTElementChildren(ctx);\n      return;\n    }\n\n    this.initializeCoordinates(ctx);\n    this.children.forEach((_, i) => {\n      this.renderChild(ctx, this, this, i);\n    });\n    var {\n      mouse\n    } = this.document.screen; // Do not calc bounding box if mouse is not working.\n\n    if (mouse.isWorking()) {\n      mouse.checkBoundingBox(this, this.getBoundingBox(ctx));\n    }\n  }\n\n  renderTElementChildren(ctx) {\n    var {\n      document,\n      parent\n    } = this;\n    var renderText = this.getText();\n    var customFont = parent.getStyle('font-family').getDefinition();\n\n    if (customFont) {\n      var {\n        unitsPerEm\n      } = customFont.fontFace;\n      var ctxFont = Font.parse(document.ctx.font);\n      var fontSize = parent.getStyle('font-size').getNumber(ctxFont.fontSize);\n      var fontStyle = parent.getStyle('font-style').getString(ctxFont.fontStyle);\n      var scale = fontSize / unitsPerEm;\n      var text = customFont.isRTL ? renderText.split('').reverse().join('') : renderText;\n      var dx = toNumbers(parent.getAttribute('dx').getString());\n      var len = text.length;\n\n      for (var i = 0; i < len; i++) {\n        var glyph = this.getGlyph(customFont, text, i);\n        ctx.translate(this.x, this.y);\n        ctx.scale(scale, -scale);\n        var lw = ctx.lineWidth;\n        ctx.lineWidth = ctx.lineWidth * unitsPerEm / fontSize;\n\n        if (fontStyle === 'italic') {\n          ctx.transform(1, 0, .4, 1, 0, 0);\n        }\n\n        glyph.render(ctx);\n\n        if (fontStyle === 'italic') {\n          ctx.transform(1, 0, -.4, 1, 0, 0);\n        }\n\n        ctx.lineWidth = lw;\n        ctx.scale(1 / scale, -1 / scale);\n        ctx.translate(-this.x, -this.y);\n        this.x += fontSize * (glyph.horizAdvX || customFont.horizAdvX) / unitsPerEm;\n\n        if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n          this.x += dx[i];\n        }\n      }\n\n      return;\n    }\n\n    var {\n      x,\n      y\n    } = this; // NEED TEST\n    // if (ctx.paintOrder === 'stroke') {\n    // \tif (ctx.strokeStyle) {\n    // \t\tctx.strokeText(renderText, x, y);\n    // \t}\n    // \tif (ctx.fillStyle) {\n    // \t\tctx.fillText(renderText, x, y);\n    // \t}\n    // } else {\n\n    if (ctx.fillStyle) {\n      ctx.fillText(renderText, x, y);\n    }\n\n    if (ctx.strokeStyle) {\n      ctx.strokeText(renderText, x, y);\n    } // }\n\n  }\n\n  getAnchorDelta(ctx, parent, startI) {\n    var textAnchor = this.getStyle('text-anchor').getString('start');\n\n    if (textAnchor !== 'start') {\n      var {\n        children\n      } = parent;\n      var len = children.length;\n      var child = null;\n      var width = 0;\n\n      for (var i = startI; i < len; i++) {\n        child = children[i];\n\n        if (i > startI && child.getAttribute('x').hasValue() || child.getAttribute('text-anchor').hasValue()) {\n          break; // new group\n        }\n\n        width += child.measureTextRecursive(ctx);\n      }\n\n      return -1 * (textAnchor === 'end' ? width : width / 2.0);\n    }\n\n    return 0;\n  }\n\n  adjustChildCoordinates(ctx, textParent, parent, i) {\n    var child = parent.children[i];\n\n    if (typeof child.measureText !== 'function') {\n      return child;\n    }\n\n    ctx.save();\n    child.setContext(ctx, true);\n    var xAttr = child.getAttribute('x');\n    var yAttr = child.getAttribute('y');\n    var dxAttr = child.getAttribute('dx');\n    var dyAttr = child.getAttribute('dy');\n    var textAnchor = child.getAttribute('text-anchor').getString('start');\n\n    if (i === 0 && child.type !== 'textNode') {\n      if (!xAttr.hasValue()) {\n        xAttr.setValue(textParent.getAttribute('x').getValue('0'));\n      }\n\n      if (!yAttr.hasValue()) {\n        yAttr.setValue(textParent.getAttribute('y').getValue('0'));\n      }\n\n      if (!dxAttr.hasValue()) {\n        dxAttr.setValue(textParent.getAttribute('dx').getValue('0'));\n      }\n\n      if (!dyAttr.hasValue()) {\n        dyAttr.setValue(textParent.getAttribute('dy').getValue('0'));\n      }\n    }\n\n    if (xAttr.hasValue()) {\n      child.x = xAttr.getPixels('x') + textParent.getAnchorDelta(ctx, parent, i);\n\n      if (textAnchor !== 'start') {\n        var width = child.measureTextRecursive(ctx);\n        child.x += -1 * (textAnchor === 'end' ? width : width / 2.0);\n      }\n\n      if (dxAttr.hasValue()) {\n        child.x += dxAttr.getPixels('x');\n      }\n    } else {\n      if (textAnchor !== 'start') {\n        var _width = child.measureTextRecursive(ctx);\n\n        textParent.x += -1 * (textAnchor === 'end' ? _width : _width / 2.0);\n      }\n\n      if (dxAttr.hasValue()) {\n        textParent.x += dxAttr.getPixels('x');\n      }\n\n      child.x = textParent.x;\n    }\n\n    textParent.x = child.x + child.measureText(ctx);\n\n    if (yAttr.hasValue()) {\n      child.y = yAttr.getPixels('y');\n\n      if (dyAttr.hasValue()) {\n        child.y += dyAttr.getPixels('y');\n      }\n    } else {\n      if (dyAttr.hasValue()) {\n        textParent.y += dyAttr.getPixels('y');\n      }\n\n      child.y = textParent.y;\n    }\n\n    textParent.y = child.y;\n    child.clearContext(ctx);\n    ctx.restore();\n    return child;\n  }\n\n  getChildBoundingBox(ctx, textParent, parent, i) {\n    var child = this.adjustChildCoordinates(ctx, textParent, parent, i); // not a text node?\n\n    if (typeof child.getBoundingBox !== 'function') {\n      return null;\n    }\n\n    var boundingBox = child.getBoundingBox(ctx);\n\n    if (!boundingBox) {\n      return null;\n    }\n\n    child.children.forEach((_, i) => {\n      var childBoundingBox = textParent.getChildBoundingBox(ctx, textParent, child, i);\n      boundingBox.addBoundingBox(childBoundingBox);\n    });\n    return boundingBox;\n  }\n\n  renderChild(ctx, textParent, parent, i) {\n    var child = this.adjustChildCoordinates(ctx, textParent, parent, i);\n    child.render(ctx);\n    child.children.forEach((_, i) => {\n      textParent.renderChild(ctx, textParent, child, i);\n    });\n  }\n\n  measureTextRecursive(ctx) {\n    var width = this.children.reduce((width, child) => width + child.measureTextRecursive(ctx), this.measureText(ctx));\n    return width;\n  }\n\n  measureText(ctx) {\n    var {\n      measureCache\n    } = this;\n\n    if (~measureCache) {\n      return measureCache;\n    }\n\n    var renderText = this.getText();\n    var measure = this.measureTargetText(ctx, renderText);\n    this.measureCache = measure;\n    return measure;\n  }\n\n  measureTargetText(ctx, targetText) {\n    if (!targetText.length) {\n      return 0;\n    }\n\n    var {\n      parent\n    } = this;\n    var customFont = parent.getStyle('font-family').getDefinition();\n\n    if (customFont) {\n      var fontSize = this.getFontSize();\n      var text = customFont.isRTL ? targetText.split('').reverse().join('') : targetText;\n      var dx = toNumbers(parent.getAttribute('dx').getString());\n      var len = text.length;\n      var _measure = 0;\n\n      for (var i = 0; i < len; i++) {\n        var glyph = this.getGlyph(customFont, text, i);\n        _measure += (glyph.horizAdvX || customFont.horizAdvX) * fontSize / customFont.fontFace.unitsPerEm;\n\n        if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n          _measure += dx[i];\n        }\n      }\n\n      return _measure;\n    }\n\n    if (!ctx.measureText) {\n      return targetText.length * 10;\n    }\n\n    ctx.save();\n    this.setContext(ctx, true);\n    var {\n      width: measure\n    } = ctx.measureText(targetText);\n    this.clearContext(ctx);\n    ctx.restore();\n    return measure;\n  }\n\n}\n\nclass TSpanElement extends TextElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, new.target === TSpanElement ? true : captureTextNodes);\n    this.type = 'tspan'; // if this node has children, then they own the text\n\n    this.text = this.children.length > 0 ? '' : this.getTextFromNode();\n  }\n\n  getText() {\n    return this.text;\n  }\n\n}\n\nclass TextNode extends TSpanElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'textNode';\n  }\n\n}\n\nclass SVGElement extends RenderedElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'svg';\n    this.root = false;\n  }\n\n  setContext(ctx) {\n    var _this$node$parentNode;\n\n    var {\n      document\n    } = this;\n    var {\n      screen,\n      window\n    } = document;\n    var canvas = ctx.canvas;\n    screen.setDefaults(ctx);\n\n    if (canvas.style && typeof ctx.font !== 'undefined' && window && typeof window.getComputedStyle !== 'undefined') {\n      ctx.font = window.getComputedStyle(canvas).getPropertyValue('font');\n      var fontSizeProp = new Property(document, 'fontSize', Font.parse(ctx.font).fontSize);\n\n      if (fontSizeProp.hasValue()) {\n        document.rootEmSize = fontSizeProp.getPixels('y');\n        document.emSize = document.rootEmSize;\n      }\n    } // create new view port\n\n\n    if (!this.getAttribute('x').hasValue()) {\n      this.getAttribute('x', true).setValue(0);\n    }\n\n    if (!this.getAttribute('y').hasValue()) {\n      this.getAttribute('y', true).setValue(0);\n    }\n\n    var {\n      width,\n      height\n    } = screen.viewPort;\n\n    if (!this.getStyle('width').hasValue()) {\n      this.getStyle('width', true).setValue('100%');\n    }\n\n    if (!this.getStyle('height').hasValue()) {\n      this.getStyle('height', true).setValue('100%');\n    }\n\n    if (!this.getStyle('color').hasValue()) {\n      this.getStyle('color', true).setValue('black');\n    }\n\n    var refXAttr = this.getAttribute('refX');\n    var refYAttr = this.getAttribute('refY');\n    var viewBoxAttr = this.getAttribute('viewBox');\n    var viewBox = viewBoxAttr.hasValue() ? toNumbers(viewBoxAttr.getString()) : null;\n    var clip = !this.root && this.getStyle('overflow').getValue('hidden') !== 'visible';\n    var minX = 0;\n    var minY = 0;\n    var clipX = 0;\n    var clipY = 0;\n\n    if (viewBox) {\n      minX = viewBox[0];\n      minY = viewBox[1];\n    }\n\n    if (!this.root) {\n      width = this.getStyle('width').getPixels('x');\n      height = this.getStyle('height').getPixels('y');\n\n      if (this.type === 'marker') {\n        clipX = minX;\n        clipY = minY;\n        minX = 0;\n        minY = 0;\n      }\n    }\n\n    screen.viewPort.setCurrent(width, height); // Default value of transform-origin is center only for root SVG elements\n    // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform-origin\n\n    if (this.node // is not temporary SVGElement\n    && (!this.parent || ((_this$node$parentNode = this.node.parentNode) === null || _this$node$parentNode === void 0 ? void 0 : _this$node$parentNode.nodeName) === 'foreignObject') && this.getStyle('transform', false, true).hasValue() && !this.getStyle('transform-origin', false, true).hasValue()) {\n      this.getStyle('transform-origin', true, true).setValue('50% 50%');\n    }\n\n    super.setContext(ctx);\n    ctx.translate(this.getAttribute('x').getPixels('x'), this.getAttribute('y').getPixels('y'));\n\n    if (viewBox) {\n      width = viewBox[2];\n      height = viewBox[3];\n    }\n\n    document.setViewBox({\n      ctx,\n      aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n      width: screen.viewPort.width,\n      desiredWidth: width,\n      height: screen.viewPort.height,\n      desiredHeight: height,\n      minX,\n      minY,\n      refX: refXAttr.getValue(),\n      refY: refYAttr.getValue(),\n      clip,\n      clipX,\n      clipY\n    });\n\n    if (viewBox) {\n      screen.viewPort.removeCurrent();\n      screen.viewPort.setCurrent(width, height);\n    }\n  }\n\n  clearContext(ctx) {\n    super.clearContext(ctx);\n    this.document.screen.viewPort.removeCurrent();\n  }\n  /**\r\n   * Resize SVG to fit in given size.\r\n   * @param width\r\n   * @param height\r\n   * @param preserveAspectRatio\r\n   */\n\n\n  resize(width) {\n    var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : width;\n    var preserveAspectRatio = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var widthAttr = this.getAttribute('width', true);\n    var heightAttr = this.getAttribute('height', true);\n    var viewBoxAttr = this.getAttribute('viewBox');\n    var styleAttr = this.getAttribute('style');\n    var originWidth = widthAttr.getNumber(0);\n    var originHeight = heightAttr.getNumber(0);\n\n    if (preserveAspectRatio) {\n      if (typeof preserveAspectRatio === 'string') {\n        this.getAttribute('preserveAspectRatio', true).setValue(preserveAspectRatio);\n      } else {\n        var preserveAspectRatioAttr = this.getAttribute('preserveAspectRatio');\n\n        if (preserveAspectRatioAttr.hasValue()) {\n          preserveAspectRatioAttr.setValue(preserveAspectRatioAttr.getString().replace(/^\\s*(\\S.*\\S)\\s*$/, '$1'));\n        }\n      }\n    }\n\n    widthAttr.setValue(width);\n    heightAttr.setValue(height);\n\n    if (!viewBoxAttr.hasValue()) {\n      viewBoxAttr.setValue(\"0 0 \".concat(originWidth || width, \" \").concat(originHeight || height));\n    }\n\n    if (styleAttr.hasValue()) {\n      var widthStyle = this.getStyle('width');\n      var heightStyle = this.getStyle('height');\n\n      if (widthStyle.hasValue()) {\n        widthStyle.setValue(\"\".concat(width, \"px\"));\n      }\n\n      if (heightStyle.hasValue()) {\n        heightStyle.setValue(\"\".concat(height, \"px\"));\n      }\n    }\n  }\n\n}\n\nclass RectElement extends PathElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'rect';\n  }\n\n  path(ctx) {\n    var x = this.getAttribute('x').getPixels('x');\n    var y = this.getAttribute('y').getPixels('y');\n    var width = this.getStyle('width', false, true).getPixels('x');\n    var height = this.getStyle('height', false, true).getPixels('y');\n    var rxAttr = this.getAttribute('rx');\n    var ryAttr = this.getAttribute('ry');\n    var rx = rxAttr.getPixels('x');\n    var ry = ryAttr.getPixels('y');\n\n    if (rxAttr.hasValue() && !ryAttr.hasValue()) {\n      ry = rx;\n    }\n\n    if (ryAttr.hasValue() && !rxAttr.hasValue()) {\n      rx = ry;\n    }\n\n    rx = Math.min(rx, width / 2.0);\n    ry = Math.min(ry, height / 2.0);\n\n    if (ctx) {\n      var KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);\n      ctx.beginPath(); // always start the path so we don't fill prior paths\n\n      if (height > 0 && width > 0) {\n        ctx.moveTo(x + rx, y);\n        ctx.lineTo(x + width - rx, y);\n        ctx.bezierCurveTo(x + width - rx + KAPPA * rx, y, x + width, y + ry - KAPPA * ry, x + width, y + ry);\n        ctx.lineTo(x + width, y + height - ry);\n        ctx.bezierCurveTo(x + width, y + height - ry + KAPPA * ry, x + width - rx + KAPPA * rx, y + height, x + width - rx, y + height);\n        ctx.lineTo(x + rx, y + height);\n        ctx.bezierCurveTo(x + rx - KAPPA * rx, y + height, x, y + height - ry + KAPPA * ry, x, y + height - ry);\n        ctx.lineTo(x, y + ry);\n        ctx.bezierCurveTo(x, y + ry - KAPPA * ry, x + rx - KAPPA * rx, y, x + rx, y);\n        ctx.closePath();\n      }\n    }\n\n    return new BoundingBox(x, y, x + width, y + height);\n  }\n\n  getMarkers() {\n    return null;\n  }\n\n}\n\nclass CircleElement extends PathElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'circle';\n  }\n\n  path(ctx) {\n    var cx = this.getAttribute('cx').getPixels('x');\n    var cy = this.getAttribute('cy').getPixels('y');\n    var r = this.getAttribute('r').getPixels();\n\n    if (ctx && r > 0) {\n      ctx.beginPath();\n      ctx.arc(cx, cy, r, 0, Math.PI * 2, false);\n      ctx.closePath();\n    }\n\n    return new BoundingBox(cx - r, cy - r, cx + r, cy + r);\n  }\n\n  getMarkers() {\n    return null;\n  }\n\n}\n\nclass EllipseElement extends PathElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'ellipse';\n  }\n\n  path(ctx) {\n    var KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);\n    var rx = this.getAttribute('rx').getPixels('x');\n    var ry = this.getAttribute('ry').getPixels('y');\n    var cx = this.getAttribute('cx').getPixels('x');\n    var cy = this.getAttribute('cy').getPixels('y');\n\n    if (ctx && rx > 0 && ry > 0) {\n      ctx.beginPath();\n      ctx.moveTo(cx + rx, cy);\n      ctx.bezierCurveTo(cx + rx, cy + KAPPA * ry, cx + KAPPA * rx, cy + ry, cx, cy + ry);\n      ctx.bezierCurveTo(cx - KAPPA * rx, cy + ry, cx - rx, cy + KAPPA * ry, cx - rx, cy);\n      ctx.bezierCurveTo(cx - rx, cy - KAPPA * ry, cx - KAPPA * rx, cy - ry, cx, cy - ry);\n      ctx.bezierCurveTo(cx + KAPPA * rx, cy - ry, cx + rx, cy - KAPPA * ry, cx + rx, cy);\n      ctx.closePath();\n    }\n\n    return new BoundingBox(cx - rx, cy - ry, cx + rx, cy + ry);\n  }\n\n  getMarkers() {\n    return null;\n  }\n\n}\n\nclass LineElement extends PathElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'line';\n  }\n\n  getPoints() {\n    return [new Point(this.getAttribute('x1').getPixels('x'), this.getAttribute('y1').getPixels('y')), new Point(this.getAttribute('x2').getPixels('x'), this.getAttribute('y2').getPixels('y'))];\n  }\n\n  path(ctx) {\n    var [{\n      x: x0,\n      y: y0\n    }, {\n      x: x1,\n      y: y1\n    }] = this.getPoints();\n\n    if (ctx) {\n      ctx.beginPath();\n      ctx.moveTo(x0, y0);\n      ctx.lineTo(x1, y1);\n    }\n\n    return new BoundingBox(x0, y0, x1, y1);\n  }\n\n  getMarkers() {\n    var [p0, p1] = this.getPoints();\n    var a = p0.angleTo(p1);\n    return [[p0, a], [p1, a]];\n  }\n\n}\n\nclass PolylineElement extends PathElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'polyline';\n    this.points = [];\n    this.points = Point.parsePath(this.getAttribute('points').getString());\n  }\n\n  path(ctx) {\n    var {\n      points\n    } = this;\n    var [{\n      x: x0,\n      y: y0\n    }] = points;\n    var boundingBox = new BoundingBox(x0, y0);\n\n    if (ctx) {\n      ctx.beginPath();\n      ctx.moveTo(x0, y0);\n    }\n\n    points.forEach((_ref) => {\n      var {\n        x,\n        y\n      } = _ref;\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n      }\n    });\n    return boundingBox;\n  }\n\n  getMarkers() {\n    var {\n      points\n    } = this;\n    var lastIndex = points.length - 1;\n    var markers = [];\n    points.forEach((point, i) => {\n      if (i === lastIndex) {\n        return;\n      }\n\n      markers.push([point, point.angleTo(points[i + 1])]);\n    });\n\n    if (markers.length > 0) {\n      markers.push([points[points.length - 1], markers[markers.length - 1][1]]);\n    }\n\n    return markers;\n  }\n\n}\n\nclass PolygonElement extends PolylineElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'polygon';\n  }\n\n  path(ctx) {\n    var boundingBox = super.path(ctx);\n    var [{\n      x,\n      y\n    }] = this.points;\n\n    if (ctx) {\n      ctx.lineTo(x, y);\n      ctx.closePath();\n    }\n\n    return boundingBox;\n  }\n\n}\n\nclass PatternElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'pattern';\n  }\n\n  createPattern(ctx, _, parentOpacityProp) {\n    var width = this.getStyle('width').getPixels('x', true);\n    var height = this.getStyle('height').getPixels('y', true); // render me using a temporary svg element\n\n    var patternSvg = new SVGElement(this.document, null);\n    patternSvg.attributes.viewBox = new Property(this.document, 'viewBox', this.getAttribute('viewBox').getValue());\n    patternSvg.attributes.width = new Property(this.document, 'width', \"\".concat(width, \"px\"));\n    patternSvg.attributes.height = new Property(this.document, 'height', \"\".concat(height, \"px\"));\n    patternSvg.attributes.transform = new Property(this.document, 'transform', this.getAttribute('patternTransform').getValue());\n    patternSvg.children = this.children;\n    var patternCanvas = this.document.createCanvas(width, height);\n    var patternCtx = patternCanvas.getContext('2d');\n    var xAttr = this.getAttribute('x');\n    var yAttr = this.getAttribute('y');\n\n    if (xAttr.hasValue() && yAttr.hasValue()) {\n      patternCtx.translate(xAttr.getPixels('x', true), yAttr.getPixels('y', true));\n    }\n\n    if (parentOpacityProp.hasValue()) {\n      this.styles['fill-opacity'] = parentOpacityProp;\n    } else {\n      Reflect.deleteProperty(this.styles, 'fill-opacity');\n    } // render 3x3 grid so when we transform there's no white space on edges\n\n\n    for (var x = -1; x <= 1; x++) {\n      for (var y = -1; y <= 1; y++) {\n        patternCtx.save();\n        patternSvg.attributes.x = new Property(this.document, 'x', x * patternCanvas.width);\n        patternSvg.attributes.y = new Property(this.document, 'y', y * patternCanvas.height);\n        patternSvg.render(patternCtx);\n        patternCtx.restore();\n      }\n    }\n\n    var pattern = ctx.createPattern(patternCanvas, 'repeat');\n    return pattern;\n  }\n\n}\n\nclass MarkerElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'marker';\n  }\n\n  render(ctx, point, angle) {\n    if (!point) {\n      return;\n    }\n\n    var {\n      x,\n      y\n    } = point;\n    var orient = this.getAttribute('orient').getString('auto');\n    var markerUnits = this.getAttribute('markerUnits').getString('strokeWidth');\n    ctx.translate(x, y);\n\n    if (orient === 'auto') {\n      ctx.rotate(angle);\n    }\n\n    if (markerUnits === 'strokeWidth') {\n      ctx.scale(ctx.lineWidth, ctx.lineWidth);\n    }\n\n    ctx.save(); // render me using a temporary svg element\n\n    var markerSvg = new SVGElement(this.document, null);\n    markerSvg.type = this.type;\n    markerSvg.attributes.viewBox = new Property(this.document, 'viewBox', this.getAttribute('viewBox').getValue());\n    markerSvg.attributes.refX = new Property(this.document, 'refX', this.getAttribute('refX').getValue());\n    markerSvg.attributes.refY = new Property(this.document, 'refY', this.getAttribute('refY').getValue());\n    markerSvg.attributes.width = new Property(this.document, 'width', this.getAttribute('markerWidth').getValue());\n    markerSvg.attributes.height = new Property(this.document, 'height', this.getAttribute('markerHeight').getValue());\n    markerSvg.attributes.overflow = new Property(this.document, 'overflow', this.getAttribute('overflow').getValue());\n    markerSvg.attributes.fill = new Property(this.document, 'fill', this.getAttribute('fill').getColor('black'));\n    markerSvg.attributes.stroke = new Property(this.document, 'stroke', this.getAttribute('stroke').getValue('none'));\n    markerSvg.children = this.children;\n    markerSvg.render(ctx);\n    ctx.restore();\n\n    if (markerUnits === 'strokeWidth') {\n      ctx.scale(1 / ctx.lineWidth, 1 / ctx.lineWidth);\n    }\n\n    if (orient === 'auto') {\n      ctx.rotate(-angle);\n    }\n\n    ctx.translate(-x, -y);\n  }\n\n}\n\nclass DefsElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'defs';\n  }\n\n  render() {// NOOP\n  }\n\n}\n\nclass GElement extends RenderedElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'g';\n  }\n\n  getBoundingBox(ctx) {\n    var boundingBox = new BoundingBox();\n    this.children.forEach(child => {\n      boundingBox.addBoundingBox(child.getBoundingBox(ctx));\n    });\n    return boundingBox;\n  }\n\n}\n\nclass GradientElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.attributesToInherit = ['gradientUnits'];\n    this.stops = [];\n    var {\n      stops,\n      children\n    } = this;\n    children.forEach(child => {\n      if (child.type === 'stop') {\n        stops.push(child);\n      }\n    });\n  }\n\n  getGradientUnits() {\n    return this.getAttribute('gradientUnits').getString('objectBoundingBox');\n  }\n\n  createGradient(ctx, element, parentOpacityProp) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias, consistent-this\n    var stopsContainer = this;\n\n    if (this.getHrefAttribute().hasValue()) {\n      stopsContainer = this.getHrefAttribute().getDefinition();\n      this.inheritStopContainer(stopsContainer);\n    }\n\n    var {\n      stops\n    } = stopsContainer;\n    var gradient = this.getGradient(ctx, element);\n\n    if (!gradient) {\n      return this.addParentOpacity(parentOpacityProp, stops[stops.length - 1].color);\n    }\n\n    stops.forEach(stop => {\n      gradient.addColorStop(stop.offset, this.addParentOpacity(parentOpacityProp, stop.color));\n    });\n\n    if (this.getAttribute('gradientTransform').hasValue()) {\n      // render as transformed pattern on temporary canvas\n      var {\n        document\n      } = this;\n      var {\n        MAX_VIRTUAL_PIXELS,\n        viewPort\n      } = document.screen;\n      var [rootView] = viewPort.viewPorts;\n      var rect = new RectElement(document, null);\n      rect.attributes.x = new Property(document, 'x', -MAX_VIRTUAL_PIXELS / 3.0);\n      rect.attributes.y = new Property(document, 'y', -MAX_VIRTUAL_PIXELS / 3.0);\n      rect.attributes.width = new Property(document, 'width', MAX_VIRTUAL_PIXELS);\n      rect.attributes.height = new Property(document, 'height', MAX_VIRTUAL_PIXELS);\n      var group = new GElement(document, null);\n      group.attributes.transform = new Property(document, 'transform', this.getAttribute('gradientTransform').getValue());\n      group.children = [rect];\n      var patternSvg = new SVGElement(document, null);\n      patternSvg.attributes.x = new Property(document, 'x', 0);\n      patternSvg.attributes.y = new Property(document, 'y', 0);\n      patternSvg.attributes.width = new Property(document, 'width', rootView.width);\n      patternSvg.attributes.height = new Property(document, 'height', rootView.height);\n      patternSvg.children = [group];\n      var patternCanvas = document.createCanvas(rootView.width, rootView.height);\n      var patternCtx = patternCanvas.getContext('2d');\n      patternCtx.fillStyle = gradient;\n      patternSvg.render(patternCtx);\n      return patternCtx.createPattern(patternCanvas, 'no-repeat');\n    }\n\n    return gradient;\n  }\n\n  inheritStopContainer(stopsContainer) {\n    this.attributesToInherit.forEach(attributeToInherit => {\n      if (!this.getAttribute(attributeToInherit).hasValue() && stopsContainer.getAttribute(attributeToInherit).hasValue()) {\n        this.getAttribute(attributeToInherit, true).setValue(stopsContainer.getAttribute(attributeToInherit).getValue());\n      }\n    });\n  }\n\n  addParentOpacity(parentOpacityProp, color) {\n    if (parentOpacityProp.hasValue()) {\n      var colorProp = new Property(this.document, 'color', color);\n      return colorProp.addOpacity(parentOpacityProp).getColor();\n    }\n\n    return color;\n  }\n\n}\n\nclass LinearGradientElement extends GradientElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'linearGradient';\n    this.attributesToInherit.push('x1', 'y1', 'x2', 'y2');\n  }\n\n  getGradient(ctx, element) {\n    var isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox';\n    var boundingBox = isBoundingBoxUnits ? element.getBoundingBox(ctx) : null;\n\n    if (isBoundingBoxUnits && !boundingBox) {\n      return null;\n    }\n\n    if (!this.getAttribute('x1').hasValue() && !this.getAttribute('y1').hasValue() && !this.getAttribute('x2').hasValue() && !this.getAttribute('y2').hasValue()) {\n      this.getAttribute('x1', true).setValue(0);\n      this.getAttribute('y1', true).setValue(0);\n      this.getAttribute('x2', true).setValue(1);\n      this.getAttribute('y2', true).setValue(0);\n    }\n\n    var x1 = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('x1').getNumber() : this.getAttribute('x1').getPixels('x');\n    var y1 = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('y1').getNumber() : this.getAttribute('y1').getPixels('y');\n    var x2 = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('x2').getNumber() : this.getAttribute('x2').getPixels('x');\n    var y2 = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('y2').getNumber() : this.getAttribute('y2').getPixels('y');\n\n    if (x1 === x2 && y1 === y2) {\n      return null;\n    }\n\n    return ctx.createLinearGradient(x1, y1, x2, y2);\n  }\n\n}\n\nclass RadialGradientElement extends GradientElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'radialGradient';\n    this.attributesToInherit.push('cx', 'cy', 'r', 'fx', 'fy', 'fr');\n  }\n\n  getGradient(ctx, element) {\n    var isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox';\n    var boundingBox = element.getBoundingBox(ctx);\n\n    if (isBoundingBoxUnits && !boundingBox) {\n      return null;\n    }\n\n    if (!this.getAttribute('cx').hasValue()) {\n      this.getAttribute('cx', true).setValue('50%');\n    }\n\n    if (!this.getAttribute('cy').hasValue()) {\n      this.getAttribute('cy', true).setValue('50%');\n    }\n\n    if (!this.getAttribute('r').hasValue()) {\n      this.getAttribute('r', true).setValue('50%');\n    }\n\n    var cx = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('cx').getNumber() : this.getAttribute('cx').getPixels('x');\n    var cy = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('cy').getNumber() : this.getAttribute('cy').getPixels('y');\n    var fx = cx;\n    var fy = cy;\n\n    if (this.getAttribute('fx').hasValue()) {\n      fx = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('fx').getNumber() : this.getAttribute('fx').getPixels('x');\n    }\n\n    if (this.getAttribute('fy').hasValue()) {\n      fy = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('fy').getNumber() : this.getAttribute('fy').getPixels('y');\n    }\n\n    var r = isBoundingBoxUnits ? (boundingBox.width + boundingBox.height) / 2.0 * this.getAttribute('r').getNumber() : this.getAttribute('r').getPixels();\n    var fr = this.getAttribute('fr').getPixels();\n    return ctx.createRadialGradient(fx, fy, fr, cx, cy, r);\n  }\n\n}\n\nclass StopElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'stop';\n    var offset = Math.max(0, Math.min(1, this.getAttribute('offset').getNumber()));\n    var stopOpacity = this.getStyle('stop-opacity');\n    var stopColor = this.getStyle('stop-color', true);\n\n    if (stopColor.getString() === '') {\n      stopColor.setValue('#000');\n    }\n\n    if (stopOpacity.hasValue()) {\n      stopColor = stopColor.addOpacity(stopOpacity);\n    }\n\n    this.offset = offset;\n    this.color = stopColor.getColor();\n  }\n\n}\n\nclass AnimateElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'animate';\n    this.duration = 0;\n    this.initialValue = null;\n    this.initialUnits = '';\n    this.removed = false;\n    this.frozen = false;\n    document.screen.animations.push(this);\n    this.begin = this.getAttribute('begin').getMilliseconds();\n    this.maxDuration = this.begin + this.getAttribute('dur').getMilliseconds();\n    this.from = this.getAttribute('from');\n    this.to = this.getAttribute('to');\n    this.values = new Property(document, 'values', null);\n    var valuesAttr = this.getAttribute('values');\n\n    if (valuesAttr.hasValue()) {\n      this.values.setValue(valuesAttr.getString().split(';'));\n    }\n  }\n\n  getProperty() {\n    var attributeType = this.getAttribute('attributeType').getString();\n    var attributeName = this.getAttribute('attributeName').getString();\n\n    if (attributeType === 'CSS') {\n      return this.parent.getStyle(attributeName, true);\n    }\n\n    return this.parent.getAttribute(attributeName, true);\n  }\n\n  calcValue() {\n    var {\n      initialUnits\n    } = this;\n    var {\n      progress,\n      from,\n      to\n    } = this.getProgress(); // tween value linearly\n\n    var newValue = from.getNumber() + (to.getNumber() - from.getNumber()) * progress;\n\n    if (initialUnits === '%') {\n      newValue *= 100.0; // numValue() returns 0-1 whereas properties are 0-100\n    }\n\n    return \"\".concat(newValue).concat(initialUnits);\n  }\n\n  update(delta) {\n    var {\n      parent\n    } = this;\n    var prop = this.getProperty(); // set initial value\n\n    if (!this.initialValue) {\n      this.initialValue = prop.getString();\n      this.initialUnits = prop.getUnits();\n    } // if we're past the end time\n\n\n    if (this.duration > this.maxDuration) {\n      var fill = this.getAttribute('fill').getString('remove'); // loop for indefinitely repeating animations\n\n      if (this.getAttribute('repeatCount').getString() === 'indefinite' || this.getAttribute('repeatDur').getString() === 'indefinite') {\n        this.duration = 0;\n      } else if (fill === 'freeze' && !this.frozen) {\n        this.frozen = true;\n        parent.animationFrozen = true;\n        parent.animationFrozenValue = prop.getString();\n      } else if (fill === 'remove' && !this.removed) {\n        this.removed = true;\n        prop.setValue(parent.animationFrozen ? parent.animationFrozenValue : this.initialValue);\n        return true;\n      }\n\n      return false;\n    }\n\n    this.duration += delta; // if we're past the begin time\n\n    var updated = false;\n\n    if (this.begin < this.duration) {\n      var newValue = this.calcValue(); // tween\n\n      var typeAttr = this.getAttribute('type');\n\n      if (typeAttr.hasValue()) {\n        // for transform, etc.\n        var type = typeAttr.getString();\n        newValue = \"\".concat(type, \"(\").concat(newValue, \")\");\n      }\n\n      prop.setValue(newValue);\n      updated = true;\n    }\n\n    return updated;\n  }\n\n  getProgress() {\n    var {\n      document,\n      values\n    } = this;\n    var result = {\n      progress: (this.duration - this.begin) / (this.maxDuration - this.begin)\n    };\n\n    if (values.hasValue()) {\n      var p = result.progress * (values.getValue().length - 1);\n      var lb = Math.floor(p);\n      var ub = Math.ceil(p);\n      result.from = new Property(document, 'from', parseFloat(values.getValue()[lb]));\n      result.to = new Property(document, 'to', parseFloat(values.getValue()[ub]));\n      result.progress = (p - lb) / (ub - lb);\n    } else {\n      result.from = this.from;\n      result.to = this.to;\n    }\n\n    return result;\n  }\n\n}\n\nclass AnimateColorElement extends AnimateElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'animateColor';\n  }\n\n  calcValue() {\n    var {\n      progress,\n      from,\n      to\n    } = this.getProgress();\n    var colorFrom = new RGBColor(from.getColor());\n    var colorTo = new RGBColor(to.getColor());\n\n    if (colorFrom.ok && colorTo.ok) {\n      // tween color linearly\n      var r = colorFrom.r + (colorTo.r - colorFrom.r) * progress;\n      var g = colorFrom.g + (colorTo.g - colorFrom.g) * progress;\n      var b = colorFrom.b + (colorTo.b - colorFrom.b) * progress; // ? alpha\n\n      return \"rgb(\".concat(Math.floor(r), \", \").concat(Math.floor(g), \", \").concat(Math.floor(b), \")\");\n    }\n\n    return this.getAttribute('from').getColor();\n  }\n\n}\n\nclass AnimateTransformElement extends AnimateElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'animateTransform';\n  }\n\n  calcValue() {\n    var {\n      progress,\n      from,\n      to\n    } = this.getProgress(); // tween value linearly\n\n    var transformFrom = toNumbers(from.getString());\n    var transformTo = toNumbers(to.getString());\n    var newValue = transformFrom.map((from, i) => {\n      var to = transformTo[i];\n      return from + (to - from) * progress;\n    }).join(' ');\n    return newValue;\n  }\n\n}\n\nclass FontElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'font';\n    this.glyphs = {};\n    this.horizAdvX = this.getAttribute('horiz-adv-x').getNumber();\n    var {\n      definitions\n    } = document;\n    var {\n      children\n    } = this;\n\n    for (var child of children) {\n      switch (child.type) {\n        case 'font-face':\n          {\n            this.fontFace = child;\n            var fontFamilyStyle = child.getStyle('font-family');\n\n            if (fontFamilyStyle.hasValue()) {\n              definitions[fontFamilyStyle.getString()] = this;\n            }\n\n            break;\n          }\n\n        case 'missing-glyph':\n          this.missingGlyph = child;\n          break;\n\n        case 'glyph':\n          {\n            var glyph = child;\n\n            if (glyph.arabicForm) {\n              this.isRTL = true;\n              this.isArabic = true;\n\n              if (typeof this.glyphs[glyph.unicode] === 'undefined') {\n                this.glyphs[glyph.unicode] = {};\n              }\n\n              this.glyphs[glyph.unicode][glyph.arabicForm] = glyph;\n            } else {\n              this.glyphs[glyph.unicode] = glyph;\n            }\n\n            break;\n          }\n      }\n    }\n  }\n\n  render() {// NO RENDER\n  }\n\n}\n\nclass FontFaceElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'font-face';\n    this.ascent = this.getAttribute('ascent').getNumber();\n    this.descent = this.getAttribute('descent').getNumber();\n    this.unitsPerEm = this.getAttribute('units-per-em').getNumber();\n  }\n\n}\n\nclass MissingGlyphElement extends PathElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'missing-glyph';\n    this.horizAdvX = 0;\n  }\n\n}\n\nclass TRefElement extends TextElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'tref';\n  }\n\n  getText() {\n    var element = this.getHrefAttribute().getDefinition();\n\n    if (element) {\n      var firstChild = element.children[0];\n\n      if (firstChild) {\n        return firstChild.getText();\n      }\n    }\n\n    return '';\n  }\n\n}\n\nclass AElement extends TextElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'a';\n    var {\n      childNodes\n    } = node;\n    var firstChild = childNodes[0];\n    var hasText = childNodes.length > 0 && Array.from(childNodes).every(node => node.nodeType === 3);\n    this.hasText = hasText;\n    this.text = hasText ? this.getTextFromNode(firstChild) : '';\n  }\n\n  getText() {\n    return this.text;\n  }\n\n  renderChildren(ctx) {\n    if (this.hasText) {\n      // render as text element\n      super.renderChildren(ctx);\n      var {\n        document,\n        x,\n        y\n      } = this;\n      var {\n        mouse\n      } = document.screen;\n      var fontSize = new Property(document, 'fontSize', Font.parse(document.ctx.font).fontSize); // Do not calc bounding box if mouse is not working.\n\n      if (mouse.isWorking()) {\n        mouse.checkBoundingBox(this, new BoundingBox(x, y - fontSize.getPixels('y'), x + this.measureText(ctx), y));\n      }\n    } else if (this.children.length > 0) {\n      // render as temporary group\n      var g = new GElement(this.document, null);\n      g.children = this.children;\n      g.parent = this;\n      g.render(ctx);\n    }\n  }\n\n  onClick() {\n    var {\n      window\n    } = this.document;\n\n    if (window) {\n      window.open(this.getHrefAttribute().getString());\n    }\n  }\n\n  onMouseMove() {\n    var ctx = this.document.ctx;\n    ctx.canvas.style.cursor = 'pointer';\n  }\n\n}\n\nfunction ownKeys$2(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$2(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$2(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$2(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nclass TextPathElement extends TextElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'textPath';\n    this.textWidth = 0;\n    this.textHeight = 0;\n    this.pathLength = -1;\n    this.glyphInfo = null;\n    this.letterSpacingCache = [];\n    this.measuresCache = new Map([['', 0]]);\n    var pathElement = this.getHrefAttribute().getDefinition();\n    this.text = this.getTextFromNode();\n    this.dataArray = this.parsePathData(pathElement);\n  }\n\n  getText() {\n    return this.text;\n  }\n\n  path(ctx) {\n    var {\n      dataArray\n    } = this;\n\n    if (ctx) {\n      ctx.beginPath();\n    }\n\n    dataArray.forEach((_ref) => {\n      var {\n        type,\n        points\n      } = _ref;\n\n      switch (type) {\n        case PathParser.LINE_TO:\n          if (ctx) {\n            ctx.lineTo(points[0], points[1]);\n          }\n\n          break;\n\n        case PathParser.MOVE_TO:\n          if (ctx) {\n            ctx.moveTo(points[0], points[1]);\n          }\n\n          break;\n\n        case PathParser.CURVE_TO:\n          if (ctx) {\n            ctx.bezierCurveTo(points[0], points[1], points[2], points[3], points[4], points[5]);\n          }\n\n          break;\n\n        case PathParser.QUAD_TO:\n          if (ctx) {\n            ctx.quadraticCurveTo(points[0], points[1], points[2], points[3]);\n          }\n\n          break;\n\n        case PathParser.ARC:\n          {\n            var [cx, cy, rx, ry, theta, dTheta, psi, fs] = points;\n            var r = rx > ry ? rx : ry;\n            var scaleX = rx > ry ? 1 : rx / ry;\n            var scaleY = rx > ry ? ry / rx : 1;\n\n            if (ctx) {\n              ctx.translate(cx, cy);\n              ctx.rotate(psi);\n              ctx.scale(scaleX, scaleY);\n              ctx.arc(0, 0, r, theta, theta + dTheta, Boolean(1 - fs));\n              ctx.scale(1 / scaleX, 1 / scaleY);\n              ctx.rotate(-psi);\n              ctx.translate(-cx, -cy);\n            }\n\n            break;\n          }\n\n        case PathParser.CLOSE_PATH:\n          if (ctx) {\n            ctx.closePath();\n          }\n\n          break;\n      }\n    });\n  }\n\n  renderChildren(ctx) {\n    this.setTextData(ctx);\n    ctx.save();\n    var textDecoration = this.parent.getStyle('text-decoration').getString();\n    var fontSize = this.getFontSize();\n    var {\n      glyphInfo\n    } = this;\n    var fill = ctx.fillStyle;\n\n    if (textDecoration === 'underline') {\n      ctx.beginPath();\n    }\n\n    glyphInfo.forEach((glyph, i) => {\n      var {\n        p0,\n        p1,\n        rotation,\n        text: partialText\n      } = glyph;\n      ctx.save();\n      ctx.translate(p0.x, p0.y);\n      ctx.rotate(rotation);\n\n      if (ctx.fillStyle) {\n        ctx.fillText(partialText, 0, 0);\n      }\n\n      if (ctx.strokeStyle) {\n        ctx.strokeText(partialText, 0, 0);\n      }\n\n      ctx.restore();\n\n      if (textDecoration === 'underline') {\n        if (i === 0) {\n          ctx.moveTo(p0.x, p0.y + fontSize / 8);\n        }\n\n        ctx.lineTo(p1.x, p1.y + fontSize / 5);\n      } // // To assist with debugging visually, uncomment following\n      //\n      // ctx.beginPath();\n      // if (i % 2)\n      // \tctx.strokeStyle = 'red';\n      // else\n      // \tctx.strokeStyle = 'green';\n      // ctx.moveTo(p0.x, p0.y);\n      // ctx.lineTo(p1.x, p1.y);\n      // ctx.stroke();\n      // ctx.closePath();\n\n    });\n\n    if (textDecoration === 'underline') {\n      ctx.lineWidth = fontSize / 20;\n      ctx.strokeStyle = fill;\n      ctx.stroke();\n      ctx.closePath();\n    }\n\n    ctx.restore();\n  }\n\n  getLetterSpacingAt() {\n    var idx = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    return this.letterSpacingCache[idx] || 0;\n  }\n\n  findSegmentToFitChar(ctx, anchor, textFullWidth, fullPathWidth, spacesNumber, inputOffset, dy, c, charI) {\n    var offset = inputOffset;\n    var glyphWidth = this.measureText(ctx, c);\n\n    if (c === ' ' && anchor === 'justify' && textFullWidth < fullPathWidth) {\n      glyphWidth += (fullPathWidth - textFullWidth) / spacesNumber;\n    }\n\n    if (charI > -1) {\n      offset += this.getLetterSpacingAt(charI);\n    }\n\n    var splineStep = this.textHeight / 20;\n    var p0 = this.getEquidistantPointOnPath(offset, splineStep, 0);\n    var p1 = this.getEquidistantPointOnPath(offset + glyphWidth, splineStep, 0);\n    var segment = {\n      p0,\n      p1\n    };\n    var rotation = p0 && p1 ? Math.atan2(p1.y - p0.y, p1.x - p0.x) : 0;\n\n    if (dy) {\n      var dyX = Math.cos(Math.PI / 2 + rotation) * dy;\n      var dyY = Math.cos(-rotation) * dy;\n      segment.p0 = _objectSpread$2(_objectSpread$2({}, p0), {}, {\n        x: p0.x + dyX,\n        y: p0.y + dyY\n      });\n      segment.p1 = _objectSpread$2(_objectSpread$2({}, p1), {}, {\n        x: p1.x + dyX,\n        y: p1.y + dyY\n      });\n    }\n\n    offset += glyphWidth;\n    return {\n      offset,\n      segment,\n      rotation\n    };\n  }\n\n  measureText(ctx, text) {\n    var {\n      measuresCache\n    } = this;\n    var targetText = text || this.getText();\n\n    if (measuresCache.has(targetText)) {\n      return measuresCache.get(targetText);\n    }\n\n    var measure = this.measureTargetText(ctx, targetText);\n    measuresCache.set(targetText, measure);\n    return measure;\n  } // This method supposes what all custom fonts already loaded.\n  // If some font will be loaded after this method call, <textPath> will not be rendered correctly.\n  // You need to call this method manually to update glyphs cache.\n\n\n  setTextData(ctx) {\n    if (this.glyphInfo) {\n      return;\n    }\n\n    var renderText = this.getText();\n    var chars = renderText.split('');\n    var spacesNumber = renderText.split(' ').length - 1;\n    var dx = this.parent.getAttribute('dx').split().map(_ => _.getPixels('x'));\n    var dy = this.parent.getAttribute('dy').getPixels('y');\n    var anchor = this.parent.getStyle('text-anchor').getString('start');\n    var thisSpacing = this.getStyle('letter-spacing');\n    var parentSpacing = this.parent.getStyle('letter-spacing');\n    var letterSpacing = 0;\n\n    if (!thisSpacing.hasValue() || thisSpacing.getValue() === 'inherit') {\n      letterSpacing = parentSpacing.getPixels();\n    } else if (thisSpacing.hasValue()) {\n      if (thisSpacing.getValue() !== 'initial' && thisSpacing.getValue() !== 'unset') {\n        letterSpacing = thisSpacing.getPixels();\n      }\n    } // fill letter-spacing cache\n\n\n    var letterSpacingCache = [];\n    var textLen = renderText.length;\n    this.letterSpacingCache = letterSpacingCache;\n\n    for (var i = 0; i < textLen; i++) {\n      letterSpacingCache.push(typeof dx[i] !== 'undefined' ? dx[i] : letterSpacing);\n    }\n\n    var dxSum = letterSpacingCache.reduce((acc, cur, i) => i === 0 ? 0 : acc + cur || 0, 0);\n    var textWidth = this.measureText(ctx);\n    var textFullWidth = Math.max(textWidth + dxSum, 0);\n    this.textWidth = textWidth;\n    this.textHeight = this.getFontSize();\n    this.glyphInfo = [];\n    var fullPathWidth = this.getPathLength();\n    var startOffset = this.getStyle('startOffset').getNumber(0) * fullPathWidth;\n    var offset = 0;\n\n    if (anchor === 'middle' || anchor === 'center') {\n      offset = -textFullWidth / 2;\n    }\n\n    if (anchor === 'end' || anchor === 'right') {\n      offset = -textFullWidth;\n    }\n\n    offset += startOffset;\n    chars.forEach((char, i) => {\n      // Find such segment what distance between p0 and p1 is approx. width of glyph\n      var {\n        offset: nextOffset,\n        segment,\n        rotation\n      } = this.findSegmentToFitChar(ctx, anchor, textFullWidth, fullPathWidth, spacesNumber, offset, dy, char, i);\n      offset = nextOffset;\n\n      if (!segment.p0 || !segment.p1) {\n        return;\n      } // const width = this.getLineLength(\n      // \tsegment.p0.x,\n      // \tsegment.p0.y,\n      // \tsegment.p1.x,\n      // \tsegment.p1.y\n      // );\n      // Note: Since glyphs are rendered one at a time, any kerning pair data built into the font will not be used.\n      // Can foresee having a rough pair table built in that the developer can override as needed.\n      // Or use \"dx\" attribute of the <text> node as a naive replacement\n      // const kern = 0;\n      // placeholder for future implementation\n      // const midpoint = this.getPointOnLine(\n      // \tkern + width / 2.0,\n      // \tsegment.p0.x, segment.p0.y, segment.p1.x, segment.p1.y\n      // );\n\n\n      this.glyphInfo.push({\n        // transposeX: midpoint.x,\n        // transposeY: midpoint.y,\n        text: chars[i],\n        p0: segment.p0,\n        p1: segment.p1,\n        rotation\n      });\n    });\n  }\n\n  parsePathData(path) {\n    this.pathLength = -1; // reset path length\n\n    if (!path) {\n      return [];\n    }\n\n    var pathCommands = [];\n    var {\n      pathParser\n    } = path;\n    pathParser.reset(); // convert l, H, h, V, and v to L\n\n    while (!pathParser.isEnd()) {\n      var {\n        current\n      } = pathParser;\n      var startX = current ? current.x : 0;\n      var startY = current ? current.y : 0;\n      var command = pathParser.next();\n      var nextCommandType = command.type;\n      var points = [];\n\n      switch (command.type) {\n        case PathParser.MOVE_TO:\n          this.pathM(pathParser, points);\n          break;\n\n        case PathParser.LINE_TO:\n          nextCommandType = this.pathL(pathParser, points);\n          break;\n\n        case PathParser.HORIZ_LINE_TO:\n          nextCommandType = this.pathH(pathParser, points);\n          break;\n\n        case PathParser.VERT_LINE_TO:\n          nextCommandType = this.pathV(pathParser, points);\n          break;\n\n        case PathParser.CURVE_TO:\n          this.pathC(pathParser, points);\n          break;\n\n        case PathParser.SMOOTH_CURVE_TO:\n          nextCommandType = this.pathS(pathParser, points);\n          break;\n\n        case PathParser.QUAD_TO:\n          this.pathQ(pathParser, points);\n          break;\n\n        case PathParser.SMOOTH_QUAD_TO:\n          nextCommandType = this.pathT(pathParser, points);\n          break;\n\n        case PathParser.ARC:\n          points = this.pathA(pathParser);\n          break;\n\n        case PathParser.CLOSE_PATH:\n          PathElement.pathZ(pathParser);\n          break;\n      }\n\n      if (command.type !== PathParser.CLOSE_PATH) {\n        pathCommands.push({\n          type: nextCommandType,\n          points,\n          start: {\n            x: startX,\n            y: startY\n          },\n          pathLength: this.calcLength(startX, startY, nextCommandType, points)\n        });\n      } else {\n        pathCommands.push({\n          type: PathParser.CLOSE_PATH,\n          points: [],\n          pathLength: 0\n        });\n      }\n    }\n\n    return pathCommands;\n  }\n\n  pathM(pathParser, points) {\n    var {\n      x,\n      y\n    } = PathElement.pathM(pathParser).point;\n    points.push(x, y);\n  }\n\n  pathL(pathParser, points) {\n    var {\n      x,\n      y\n    } = PathElement.pathL(pathParser).point;\n    points.push(x, y);\n    return PathParser.LINE_TO;\n  }\n\n  pathH(pathParser, points) {\n    var {\n      x,\n      y\n    } = PathElement.pathH(pathParser).point;\n    points.push(x, y);\n    return PathParser.LINE_TO;\n  }\n\n  pathV(pathParser, points) {\n    var {\n      x,\n      y\n    } = PathElement.pathV(pathParser).point;\n    points.push(x, y);\n    return PathParser.LINE_TO;\n  }\n\n  pathC(pathParser, points) {\n    var {\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathC(pathParser);\n    points.push(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n  }\n\n  pathS(pathParser, points) {\n    var {\n      point,\n      controlPoint,\n      currentPoint\n    } = PathElement.pathS(pathParser);\n    points.push(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    return PathParser.CURVE_TO;\n  }\n\n  pathQ(pathParser, points) {\n    var {\n      controlPoint,\n      currentPoint\n    } = PathElement.pathQ(pathParser);\n    points.push(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n  }\n\n  pathT(pathParser, points) {\n    var {\n      controlPoint,\n      currentPoint\n    } = PathElement.pathT(pathParser);\n    points.push(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    return PathParser.QUAD_TO;\n  }\n\n  pathA(pathParser) {\n    var {\n      rX,\n      rY,\n      sweepFlag,\n      xAxisRotation,\n      centp,\n      a1,\n      ad\n    } = PathElement.pathA(pathParser);\n\n    if (sweepFlag === 0 && ad > 0) {\n      ad -= 2 * Math.PI;\n    }\n\n    if (sweepFlag === 1 && ad < 0) {\n      ad += 2 * Math.PI;\n    }\n\n    return [centp.x, centp.y, rX, rY, a1, ad, xAxisRotation, sweepFlag];\n  }\n\n  calcLength(x, y, commandType, points) {\n    var len = 0;\n    var p1 = null;\n    var p2 = null;\n    var t = 0;\n\n    switch (commandType) {\n      case PathParser.LINE_TO:\n        return this.getLineLength(x, y, points[0], points[1]);\n\n      case PathParser.CURVE_TO:\n        // Approximates by breaking curve into 100 line segments\n        len = 0.0;\n        p1 = this.getPointOnCubicBezier(0, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n\n        for (t = 0.01; t <= 1; t += 0.01) {\n          p2 = this.getPointOnCubicBezier(t, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n          len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n          p1 = p2;\n        }\n\n        return len;\n\n      case PathParser.QUAD_TO:\n        // Approximates by breaking curve into 100 line segments\n        len = 0.0;\n        p1 = this.getPointOnQuadraticBezier(0, x, y, points[0], points[1], points[2], points[3]);\n\n        for (t = 0.01; t <= 1; t += 0.01) {\n          p2 = this.getPointOnQuadraticBezier(t, x, y, points[0], points[1], points[2], points[3]);\n          len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n          p1 = p2;\n        }\n\n        return len;\n\n      case PathParser.ARC:\n        {\n          // Approximates by breaking curve into line segments\n          len = 0.0;\n          var start = points[4]; // 4 = theta\n\n          var dTheta = points[5]; // 5 = dTheta\n\n          var end = points[4] + dTheta;\n          var inc = Math.PI / 180.0; // 1 degree resolution\n\n          if (Math.abs(start - end) < inc) {\n            inc = Math.abs(start - end);\n          } // Note: for purpose of calculating arc length, not going to worry about rotating X-axis by angle psi\n\n\n          p1 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], start, 0);\n\n          if (dTheta < 0) {\n            // clockwise\n            for (t = start - inc; t > end; t -= inc) {\n              p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n              len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n              p1 = p2;\n            }\n          } else {\n            // counter-clockwise\n            for (t = start + inc; t < end; t += inc) {\n              p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n              len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n              p1 = p2;\n            }\n          }\n\n          p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], end, 0);\n          len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n          return len;\n        }\n    }\n\n    return 0;\n  }\n\n  getPointOnLine(dist, p1x, p1y, p2x, p2y) {\n    var fromX = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : p1x;\n    var fromY = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : p1y;\n    var m = (p2y - p1y) / (p2x - p1x + PSEUDO_ZERO);\n    var run = Math.sqrt(dist * dist / (1 + m * m));\n\n    if (p2x < p1x) {\n      run *= -1;\n    }\n\n    var rise = m * run;\n    var pt = null;\n\n    if (p2x === p1x) {\n      // vertical line\n      pt = {\n        x: fromX,\n        y: fromY + rise\n      };\n    } else if ((fromY - p1y) / (fromX - p1x + PSEUDO_ZERO) === m) {\n      pt = {\n        x: fromX + run,\n        y: fromY + rise\n      };\n    } else {\n      var ix = 0;\n      var iy = 0;\n      var len = this.getLineLength(p1x, p1y, p2x, p2y);\n\n      if (len < PSEUDO_ZERO) {\n        return null;\n      }\n\n      var u = (fromX - p1x) * (p2x - p1x) + (fromY - p1y) * (p2y - p1y);\n      u /= len * len;\n      ix = p1x + u * (p2x - p1x);\n      iy = p1y + u * (p2y - p1y);\n      var pRise = this.getLineLength(fromX, fromY, ix, iy);\n      var pRun = Math.sqrt(dist * dist - pRise * pRise);\n      run = Math.sqrt(pRun * pRun / (1 + m * m));\n\n      if (p2x < p1x) {\n        run *= -1;\n      }\n\n      rise = m * run;\n      pt = {\n        x: ix + run,\n        y: iy + rise\n      };\n    }\n\n    return pt;\n  }\n\n  getPointOnPath(distance) {\n    var fullLen = this.getPathLength();\n    var cumulativePathLength = 0;\n    var p = null;\n\n    if (distance < -0.00005 || distance - 0.00005 > fullLen) {\n      return null;\n    }\n\n    var {\n      dataArray\n    } = this;\n\n    for (var command of dataArray) {\n      if (command && (command.pathLength < 0.00005 || cumulativePathLength + command.pathLength + 0.00005 < distance)) {\n        cumulativePathLength += command.pathLength;\n        continue;\n      }\n\n      var delta = distance - cumulativePathLength;\n      var currentT = 0;\n\n      switch (command.type) {\n        case PathParser.LINE_TO:\n          p = this.getPointOnLine(delta, command.start.x, command.start.y, command.points[0], command.points[1], command.start.x, command.start.y);\n          break;\n\n        case PathParser.ARC:\n          {\n            var start = command.points[4]; // 4 = theta\n\n            var dTheta = command.points[5]; // 5 = dTheta\n\n            var end = command.points[4] + dTheta;\n            currentT = start + delta / command.pathLength * dTheta;\n\n            if (dTheta < 0 && currentT < end || dTheta >= 0 && currentT > end) {\n              break;\n            }\n\n            p = this.getPointOnEllipticalArc(command.points[0], command.points[1], command.points[2], command.points[3], currentT, command.points[6]);\n            break;\n          }\n\n        case PathParser.CURVE_TO:\n          currentT = delta / command.pathLength;\n\n          if (currentT > 1) {\n            currentT = 1;\n          }\n\n          p = this.getPointOnCubicBezier(currentT, command.start.x, command.start.y, command.points[0], command.points[1], command.points[2], command.points[3], command.points[4], command.points[5]);\n          break;\n\n        case PathParser.QUAD_TO:\n          currentT = delta / command.pathLength;\n\n          if (currentT > 1) {\n            currentT = 1;\n          }\n\n          p = this.getPointOnQuadraticBezier(currentT, command.start.x, command.start.y, command.points[0], command.points[1], command.points[2], command.points[3]);\n          break;\n      }\n\n      if (p) {\n        return p;\n      }\n\n      break;\n    }\n\n    return null;\n  }\n\n  getLineLength(x1, y1, x2, y2) {\n    return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n  }\n\n  getPathLength() {\n    if (this.pathLength === -1) {\n      this.pathLength = this.dataArray.reduce((length, command) => command.pathLength > 0 ? length + command.pathLength : length, 0);\n    }\n\n    return this.pathLength;\n  }\n\n  getPointOnCubicBezier(pct, p1x, p1y, p2x, p2y, p3x, p3y, p4x, p4y) {\n    var x = p4x * CB1(pct) + p3x * CB2(pct) + p2x * CB3(pct) + p1x * CB4(pct);\n    var y = p4y * CB1(pct) + p3y * CB2(pct) + p2y * CB3(pct) + p1y * CB4(pct);\n    return {\n      x,\n      y\n    };\n  }\n\n  getPointOnQuadraticBezier(pct, p1x, p1y, p2x, p2y, p3x, p3y) {\n    var x = p3x * QB1(pct) + p2x * QB2(pct) + p1x * QB3(pct);\n    var y = p3y * QB1(pct) + p2y * QB2(pct) + p1y * QB3(pct);\n    return {\n      x,\n      y\n    };\n  }\n\n  getPointOnEllipticalArc(cx, cy, rx, ry, theta, psi) {\n    var cosPsi = Math.cos(psi);\n    var sinPsi = Math.sin(psi);\n    var pt = {\n      x: rx * Math.cos(theta),\n      y: ry * Math.sin(theta)\n    };\n    return {\n      x: cx + (pt.x * cosPsi - pt.y * sinPsi),\n      y: cy + (pt.x * sinPsi + pt.y * cosPsi)\n    };\n  } // TODO need some optimisations. possibly build cache only for curved segments?\n\n\n  buildEquidistantCache(inputStep, inputPrecision) {\n    var fullLen = this.getPathLength();\n    var precision = inputPrecision || 0.25; // accuracy vs performance\n\n    var step = inputStep || fullLen / 100;\n\n    if (!this.equidistantCache || this.equidistantCache.step !== step || this.equidistantCache.precision !== precision) {\n      // Prepare cache\n      this.equidistantCache = {\n        step,\n        precision,\n        points: []\n      }; // Calculate points\n\n      var s = 0;\n\n      for (var l = 0; l <= fullLen; l += precision) {\n        var p0 = this.getPointOnPath(l);\n        var p1 = this.getPointOnPath(l + precision);\n\n        if (!p0 || !p1) {\n          continue;\n        }\n\n        s += this.getLineLength(p0.x, p0.y, p1.x, p1.y);\n\n        if (s >= step) {\n          this.equidistantCache.points.push({\n            x: p0.x,\n            y: p0.y,\n            distance: l\n          });\n          s -= step;\n        }\n      }\n    }\n  }\n\n  getEquidistantPointOnPath(targetDistance, step, precision) {\n    this.buildEquidistantCache(step, precision);\n\n    if (targetDistance < 0 || targetDistance - this.getPathLength() > 0.00005) {\n      return null;\n    }\n\n    var idx = Math.round(targetDistance / this.getPathLength() * (this.equidistantCache.points.length - 1));\n    return this.equidistantCache.points[idx] || null;\n  }\n\n}\n\nvar dataUriRegex = /^\\s*data:(([^/,;]+\\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;\nclass ImageElement extends RenderedElement {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'image';\n    this.loaded = false;\n    var href = this.getHrefAttribute().getString();\n\n    if (!href) {\n      return;\n    }\n\n    var isSvg = href.endsWith('.svg') || /^\\s*data:image\\/svg\\+xml/i.test(href);\n    document.images.push(this);\n\n    if (!isSvg) {\n      void this.loadImage(href);\n    } else {\n      void this.loadSvg(href);\n    }\n\n    this.isSvg = isSvg;\n  }\n\n  loadImage(href) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        var image = yield _this.document.createImage(href);\n        _this.image = image;\n      } catch (err) {\n        console.error(\"Error while loading image \\\"\".concat(href, \"\\\":\"), err);\n      }\n\n      _this.loaded = true;\n    })();\n  }\n\n  loadSvg(href) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var match = dataUriRegex.exec(href);\n\n      if (match) {\n        var data = match[5];\n\n        if (match[4] === 'base64') {\n          _this2.image = atob(data);\n        } else {\n          _this2.image = decodeURIComponent(data);\n        }\n      } else {\n        try {\n          var response = yield _this2.document.fetch(href);\n          var svg = yield response.text();\n          _this2.image = svg;\n        } catch (err) {\n          console.error(\"Error while loading image \\\"\".concat(href, \"\\\":\"), err);\n        }\n      }\n\n      _this2.loaded = true;\n    })();\n  }\n\n  renderChildren(ctx) {\n    var {\n      document,\n      image,\n      loaded\n    } = this;\n    var x = this.getAttribute('x').getPixels('x');\n    var y = this.getAttribute('y').getPixels('y');\n    var width = this.getStyle('width').getPixels('x');\n    var height = this.getStyle('height').getPixels('y');\n\n    if (!loaded || !image || !width || !height) {\n      return;\n    }\n\n    ctx.save();\n    ctx.translate(x, y);\n\n    if (this.isSvg) {\n      var subDocument = document.canvg.forkString(ctx, this.image, {\n        ignoreMouse: true,\n        ignoreAnimation: true,\n        ignoreDimensions: true,\n        ignoreClear: true,\n        offsetX: 0,\n        offsetY: 0,\n        scaleWidth: width,\n        scaleHeight: height\n      });\n      subDocument.document.documentElement.parent = this;\n      void subDocument.render();\n    } else {\n      var _image = this.image;\n      document.setViewBox({\n        ctx,\n        aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n        width,\n        desiredWidth: _image.width,\n        height,\n        desiredHeight: _image.height\n      });\n\n      if (this.loaded) {\n        if (typeof _image.complete === 'undefined' || _image.complete) {\n          ctx.drawImage(_image, 0, 0);\n        }\n      }\n    }\n\n    ctx.restore();\n  }\n\n  getBoundingBox() {\n    var x = this.getAttribute('x').getPixels('x');\n    var y = this.getAttribute('y').getPixels('y');\n    var width = this.getStyle('width').getPixels('x');\n    var height = this.getStyle('height').getPixels('y');\n    return new BoundingBox(x, y, x + width, y + height);\n  }\n\n}\n\nclass SymbolElement extends RenderedElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'symbol';\n  }\n\n  render(_) {// NO RENDER\n  }\n\n}\n\nclass SVGFontLoader {\n  constructor(document) {\n    this.document = document;\n    this.loaded = false;\n    document.fonts.push(this);\n  }\n\n  load(fontFamily, url) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        var {\n          document\n        } = _this;\n        var svgDocument = yield document.canvg.parser.load(url);\n        var fonts = svgDocument.getElementsByTagName('font');\n        Array.from(fonts).forEach(fontNode => {\n          var font = document.createElement(fontNode);\n          document.definitions[fontFamily] = font;\n        });\n      } catch (err) {\n        console.error(\"Error while loading font \\\"\".concat(url, \"\\\":\"), err);\n      }\n\n      _this.loaded = true;\n    })();\n  }\n\n}\n\nclass StyleElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'style';\n    var css = compressSpaces(Array.from(node.childNodes) // NEED TEST\n    .map(_ => _.textContent).join('').replace(/(\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+\\/)|(^[\\s]*\\/\\/.*)/gm, '') // remove comments\n    .replace(/@import.*;/g, '') // remove imports\n    );\n    var cssDefs = css.split('}');\n    cssDefs.forEach(_ => {\n      var def = _.trim();\n\n      if (!def) {\n        return;\n      }\n\n      var cssParts = def.split('{');\n      var cssClasses = cssParts[0].split(',');\n      var cssProps = cssParts[1].split(';');\n      cssClasses.forEach(_ => {\n        var cssClass = _.trim();\n\n        if (!cssClass) {\n          return;\n        }\n\n        var props = document.styles[cssClass] || {};\n        cssProps.forEach(cssProp => {\n          var prop = cssProp.indexOf(':');\n          var name = cssProp.substr(0, prop).trim();\n          var value = cssProp.substr(prop + 1, cssProp.length - prop).trim();\n\n          if (name && value) {\n            props[name] = new Property(document, name, value);\n          }\n        });\n        document.styles[cssClass] = props;\n        document.stylesSpecificity[cssClass] = getSelectorSpecificity(cssClass);\n\n        if (cssClass === '@font-face') {\n          //  && !nodeEnv\n          var fontFamily = props['font-family'].getString().replace(/\"|'/g, '');\n          var srcs = props.src.getString().split(',');\n          srcs.forEach(src => {\n            if (src.indexOf('format(\"svg\")') > 0) {\n              var url = parseExternalUrl(src);\n\n              if (url) {\n                void new SVGFontLoader(document).load(fontFamily, url);\n              }\n            }\n          });\n        }\n      });\n    });\n  }\n\n}\nStyleElement.parseExternalUrl = parseExternalUrl;\n\nclass UseElement extends RenderedElement {\n  constructor() {\n    super(...arguments);\n    this.type = 'use';\n  }\n\n  setContext(ctx) {\n    super.setContext(ctx);\n    var xAttr = this.getAttribute('x');\n    var yAttr = this.getAttribute('y');\n\n    if (xAttr.hasValue()) {\n      ctx.translate(xAttr.getPixels('x'), 0);\n    }\n\n    if (yAttr.hasValue()) {\n      ctx.translate(0, yAttr.getPixels('y'));\n    }\n  }\n\n  path(ctx) {\n    var {\n      element\n    } = this;\n\n    if (element) {\n      element.path(ctx);\n    }\n  }\n\n  renderChildren(ctx) {\n    var {\n      document,\n      element\n    } = this;\n\n    if (element) {\n      var tempSvg = element;\n\n      if (element.type === 'symbol') {\n        // render me using a temporary svg element in symbol cases (http://www.w3.org/TR/SVG/struct.html#UseElement)\n        tempSvg = new SVGElement(document, null);\n        tempSvg.attributes.viewBox = new Property(document, 'viewBox', element.getAttribute('viewBox').getString());\n        tempSvg.attributes.preserveAspectRatio = new Property(document, 'preserveAspectRatio', element.getAttribute('preserveAspectRatio').getString());\n        tempSvg.attributes.overflow = new Property(document, 'overflow', element.getAttribute('overflow').getString());\n        tempSvg.children = element.children; // element is still the parent of the children\n\n        element.styles.opacity = new Property(document, 'opacity', this.calculateOpacity());\n      }\n\n      if (tempSvg.type === 'svg') {\n        var widthStyle = this.getStyle('width', false, true);\n        var heightStyle = this.getStyle('height', false, true); // if symbol or svg, inherit width/height from me\n\n        if (widthStyle.hasValue()) {\n          tempSvg.attributes.width = new Property(document, 'width', widthStyle.getString());\n        }\n\n        if (heightStyle.hasValue()) {\n          tempSvg.attributes.height = new Property(document, 'height', heightStyle.getString());\n        }\n      }\n\n      var oldParent = tempSvg.parent;\n      tempSvg.parent = this;\n      tempSvg.render(ctx);\n      tempSvg.parent = oldParent;\n    }\n  }\n\n  getBoundingBox(ctx) {\n    var {\n      element\n    } = this;\n\n    if (element) {\n      return element.getBoundingBox(ctx);\n    }\n\n    return null;\n  }\n\n  elementTransform() {\n    var {\n      document,\n      element\n    } = this;\n    return Transform.fromElement(document, element);\n  }\n\n  get element() {\n    if (!this.cachedElement) {\n      this.cachedElement = this.getHrefAttribute().getDefinition();\n    }\n\n    return this.cachedElement;\n  }\n\n}\n\nfunction imGet(img, x, y, width, _height, rgba) {\n  return img[y * width * 4 + x * 4 + rgba];\n}\n\nfunction imSet(img, x, y, width, _height, rgba, val) {\n  img[y * width * 4 + x * 4 + rgba] = val;\n}\n\nfunction m(matrix, i, v) {\n  var mi = matrix[i];\n  return mi * v;\n}\n\nfunction c(a, m1, m2, m3) {\n  return m1 + Math.cos(a) * m2 + Math.sin(a) * m3;\n}\n\nclass FeColorMatrixElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'feColorMatrix';\n    var matrix = toNumbers(this.getAttribute('values').getString());\n\n    switch (this.getAttribute('type').getString('matrix')) {\n      // http://www.w3.org/TR/SVG/filters.html#feColorMatrixElement\n      case 'saturate':\n        {\n          var s = matrix[0];\n          /* eslint-disable array-element-newline */\n\n          matrix = [0.213 + 0.787 * s, 0.715 - 0.715 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 + 0.285 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 - 0.715 * s, 0.072 + 0.928 * s, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n          /* eslint-enable array-element-newline */\n\n          break;\n        }\n\n      case 'hueRotate':\n        {\n          var a = matrix[0] * Math.PI / 180.0;\n          /* eslint-disable array-element-newline */\n\n          matrix = [c(a, 0.213, 0.787, -0.213), c(a, 0.715, -0.715, -0.715), c(a, 0.072, -0.072, 0.928), 0, 0, c(a, 0.213, -0.213, 0.143), c(a, 0.715, 0.285, 0.140), c(a, 0.072, -0.072, -0.283), 0, 0, c(a, 0.213, -0.213, -0.787), c(a, 0.715, -0.715, 0.715), c(a, 0.072, 0.928, 0.072), 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n          /* eslint-enable array-element-newline */\n\n          break;\n        }\n\n      case 'luminanceToAlpha':\n        /* eslint-disable array-element-newline */\n        matrix = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2125, 0.7154, 0.0721, 0, 0, 0, 0, 0, 0, 1];\n        /* eslint-enable array-element-newline */\n\n        break;\n    }\n\n    this.matrix = matrix;\n    this.includeOpacity = this.getAttribute('includeOpacity').hasValue();\n  }\n\n  apply(ctx, _x, _y, width, height) {\n    // assuming x==0 && y==0 for now\n    var {\n      includeOpacity,\n      matrix\n    } = this;\n    var srcData = ctx.getImageData(0, 0, width, height);\n\n    for (var y = 0; y < height; y++) {\n      for (var x = 0; x < width; x++) {\n        var r = imGet(srcData.data, x, y, width, height, 0);\n        var g = imGet(srcData.data, x, y, width, height, 1);\n        var b = imGet(srcData.data, x, y, width, height, 2);\n        var a = imGet(srcData.data, x, y, width, height, 3);\n        var nr = m(matrix, 0, r) + m(matrix, 1, g) + m(matrix, 2, b) + m(matrix, 3, a) + m(matrix, 4, 1);\n        var ng = m(matrix, 5, r) + m(matrix, 6, g) + m(matrix, 7, b) + m(matrix, 8, a) + m(matrix, 9, 1);\n        var nb = m(matrix, 10, r) + m(matrix, 11, g) + m(matrix, 12, b) + m(matrix, 13, a) + m(matrix, 14, 1);\n        var na = m(matrix, 15, r) + m(matrix, 16, g) + m(matrix, 17, b) + m(matrix, 18, a) + m(matrix, 19, 1);\n\n        if (includeOpacity) {\n          nr = 0;\n          ng = 0;\n          nb = 0;\n          na *= a / 255;\n        }\n\n        imSet(srcData.data, x, y, width, height, 0, nr);\n        imSet(srcData.data, x, y, width, height, 1, ng);\n        imSet(srcData.data, x, y, width, height, 2, nb);\n        imSet(srcData.data, x, y, width, height, 3, na);\n      }\n    }\n\n    ctx.clearRect(0, 0, width, height);\n    ctx.putImageData(srcData, 0, 0);\n  }\n\n}\n\nclass MaskElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'mask';\n  }\n\n  apply(ctx, element) {\n    var {\n      document\n    } = this; // render as temp svg\n\n    var x = this.getAttribute('x').getPixels('x');\n    var y = this.getAttribute('y').getPixels('y');\n    var width = this.getStyle('width').getPixels('x');\n    var height = this.getStyle('height').getPixels('y');\n\n    if (!width && !height) {\n      var boundingBox = new BoundingBox();\n      this.children.forEach(child => {\n        boundingBox.addBoundingBox(child.getBoundingBox(ctx));\n      });\n      x = Math.floor(boundingBox.x1);\n      y = Math.floor(boundingBox.y1);\n      width = Math.floor(boundingBox.width);\n      height = Math.floor(boundingBox.height);\n    }\n\n    var ignoredStyles = this.removeStyles(element, MaskElement.ignoreStyles);\n    var maskCanvas = document.createCanvas(x + width, y + height);\n    var maskCtx = maskCanvas.getContext('2d');\n    document.screen.setDefaults(maskCtx);\n    this.renderChildren(maskCtx); // convert mask to alpha with a fake node\n    // TODO: refactor out apply from feColorMatrix\n\n    new FeColorMatrixElement(document, {\n      nodeType: 1,\n      childNodes: [],\n      attributes: [{\n        nodeName: 'type',\n        value: 'luminanceToAlpha'\n      }, {\n        nodeName: 'includeOpacity',\n        value: 'true'\n      }]\n    }).apply(maskCtx, 0, 0, x + width, y + height);\n    var tmpCanvas = document.createCanvas(x + width, y + height);\n    var tmpCtx = tmpCanvas.getContext('2d');\n    document.screen.setDefaults(tmpCtx);\n    element.render(tmpCtx);\n    tmpCtx.globalCompositeOperation = 'destination-in';\n    tmpCtx.fillStyle = maskCtx.createPattern(maskCanvas, 'no-repeat');\n    tmpCtx.fillRect(0, 0, x + width, y + height);\n    ctx.fillStyle = tmpCtx.createPattern(tmpCanvas, 'no-repeat');\n    ctx.fillRect(0, 0, x + width, y + height); // reassign mask\n\n    this.restoreStyles(element, ignoredStyles);\n  }\n\n  render(_) {// NO RENDER\n  }\n\n}\nMaskElement.ignoreStyles = ['mask', 'transform', 'clip-path'];\n\nvar noop = () => {// NOOP\n};\n\nclass ClipPathElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'clipPath';\n  }\n\n  apply(ctx) {\n    var {\n      document\n    } = this;\n    var contextProto = Reflect.getPrototypeOf(ctx);\n    var {\n      beginPath,\n      closePath\n    } = ctx;\n\n    if (contextProto) {\n      contextProto.beginPath = noop;\n      contextProto.closePath = noop;\n    }\n\n    Reflect.apply(beginPath, ctx, []);\n    this.children.forEach(child => {\n      if (typeof child.path === 'undefined') {\n        return;\n      }\n\n      var transform = typeof child.elementTransform !== 'undefined' ? child.elementTransform() : null; // handle <use />\n\n      if (!transform) {\n        transform = Transform.fromElement(document, child);\n      }\n\n      if (transform) {\n        transform.apply(ctx);\n      }\n\n      child.path(ctx);\n\n      if (contextProto) {\n        contextProto.closePath = closePath;\n      }\n\n      if (transform) {\n        transform.unapply(ctx);\n      }\n    });\n    Reflect.apply(closePath, ctx, []);\n    ctx.clip();\n\n    if (contextProto) {\n      contextProto.beginPath = beginPath;\n      contextProto.closePath = closePath;\n    }\n  }\n\n  render(_) {// NO RENDER\n  }\n\n}\n\nclass FilterElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'filter';\n  }\n\n  apply(ctx, element) {\n    // render as temp svg\n    var {\n      document,\n      children\n    } = this;\n    var boundingBox = element.getBoundingBox(ctx);\n\n    if (!boundingBox) {\n      return;\n    }\n\n    var px = 0;\n    var py = 0;\n    children.forEach(child => {\n      var efd = child.extraFilterDistance || 0;\n      px = Math.max(px, efd);\n      py = Math.max(py, efd);\n    });\n    var width = Math.floor(boundingBox.width);\n    var height = Math.floor(boundingBox.height);\n    var tmpCanvasWidth = width + 2 * px;\n    var tmpCanvasHeight = height + 2 * py;\n\n    if (tmpCanvasWidth < 1 || tmpCanvasHeight < 1) {\n      return;\n    }\n\n    var x = Math.floor(boundingBox.x);\n    var y = Math.floor(boundingBox.y);\n    var ignoredStyles = this.removeStyles(element, FilterElement.ignoreStyles);\n    var tmpCanvas = document.createCanvas(tmpCanvasWidth, tmpCanvasHeight);\n    var tmpCtx = tmpCanvas.getContext('2d');\n    document.screen.setDefaults(tmpCtx);\n    tmpCtx.translate(-x + px, -y + py);\n    element.render(tmpCtx); // apply filters\n\n    children.forEach(child => {\n      if (typeof child.apply === 'function') {\n        child.apply(tmpCtx, 0, 0, tmpCanvasWidth, tmpCanvasHeight);\n      }\n    }); // render on me\n\n    ctx.drawImage(tmpCanvas, 0, 0, tmpCanvasWidth, tmpCanvasHeight, x - px, y - py, tmpCanvasWidth, tmpCanvasHeight);\n    this.restoreStyles(element, ignoredStyles);\n  }\n\n  render(_) {// NO RENDER\n  }\n\n}\nFilterElement.ignoreStyles = ['filter', 'transform', 'clip-path'];\n\nclass FeDropShadowElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'feDropShadow';\n    this.addStylesFromStyleDefinition();\n  }\n\n  apply(_, _x, _y, _width, _height) {// TODO: implement\n  }\n\n}\n\nclass FeMorphologyElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'feMorphology';\n  }\n\n  apply(_, _x, _y, _width, _height) {// TODO: implement\n  }\n\n}\n\nclass FeCompositeElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'feComposite';\n  }\n\n  apply(_, _x, _y, _width, _height) {// TODO: implement\n  }\n\n}\n\nclass FeGaussianBlurElement extends Element {\n  constructor(document, node, captureTextNodes) {\n    super(document, node, captureTextNodes);\n    this.type = 'feGaussianBlur';\n    this.blurRadius = Math.floor(this.getAttribute('stdDeviation').getNumber());\n    this.extraFilterDistance = this.blurRadius;\n  }\n\n  apply(ctx, x, y, width, height) {\n    var {\n      document,\n      blurRadius\n    } = this;\n    var body = document.window ? document.window.document.body : null;\n    var canvas = ctx.canvas; // StackBlur requires canvas be on document\n\n    canvas.id = document.getUniqueId();\n\n    if (body) {\n      canvas.style.display = 'none';\n      body.appendChild(canvas);\n    }\n\n    canvasRGBA(canvas, x, y, width, height, blurRadius);\n\n    if (body) {\n      body.removeChild(canvas);\n    }\n  }\n\n}\n\nclass TitleElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'title';\n  }\n\n}\n\nclass DescElement extends Element {\n  constructor() {\n    super(...arguments);\n    this.type = 'desc';\n  }\n\n}\n\nvar elements = {\n  'svg': SVGElement,\n  'rect': RectElement,\n  'circle': CircleElement,\n  'ellipse': EllipseElement,\n  'line': LineElement,\n  'polyline': PolylineElement,\n  'polygon': PolygonElement,\n  'path': PathElement,\n  'pattern': PatternElement,\n  'marker': MarkerElement,\n  'defs': DefsElement,\n  'linearGradient': LinearGradientElement,\n  'radialGradient': RadialGradientElement,\n  'stop': StopElement,\n  'animate': AnimateElement,\n  'animateColor': AnimateColorElement,\n  'animateTransform': AnimateTransformElement,\n  'font': FontElement,\n  'font-face': FontFaceElement,\n  'missing-glyph': MissingGlyphElement,\n  'glyph': GlyphElement,\n  'text': TextElement,\n  'tspan': TSpanElement,\n  'tref': TRefElement,\n  'a': AElement,\n  'textPath': TextPathElement,\n  'image': ImageElement,\n  'g': GElement,\n  'symbol': SymbolElement,\n  'style': StyleElement,\n  'use': UseElement,\n  'mask': MaskElement,\n  'clipPath': ClipPathElement,\n  'filter': FilterElement,\n  'feDropShadow': FeDropShadowElement,\n  'feMorphology': FeMorphologyElement,\n  'feComposite': FeCompositeElement,\n  'feColorMatrix': FeColorMatrixElement,\n  'feGaussianBlur': FeGaussianBlurElement,\n  'title': TitleElement,\n  'desc': DescElement\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction createCanvas(width, height) {\n  var canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  return canvas;\n}\n\nfunction createImage(_x) {\n  return _createImage.apply(this, arguments);\n}\n\nfunction _createImage() {\n  _createImage = _asyncToGenerator(function* (src) {\n    var anonymousCrossOrigin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var image = document.createElement('img');\n\n    if (anonymousCrossOrigin) {\n      image.crossOrigin = 'Anonymous';\n    }\n\n    return new Promise((resolve, reject) => {\n      image.onload = () => {\n        resolve(image);\n      };\n\n      image.onerror = (_event, _source, _lineno, _colno, error) => {\n        reject(error);\n      };\n\n      image.src = src;\n    });\n  });\n  return _createImage.apply(this, arguments);\n}\n\nclass Document {\n  constructor(canvg) {\n    var {\n      rootEmSize = 12,\n      emSize = 12,\n      createCanvas = Document.createCanvas,\n      createImage = Document.createImage,\n      anonymousCrossOrigin\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.canvg = canvg;\n    this.definitions = {};\n    this.styles = {};\n    this.stylesSpecificity = {};\n    this.images = [];\n    this.fonts = [];\n    this.emSizeStack = [];\n    this.uniqueId = 0;\n    this.screen = canvg.screen;\n    this.rootEmSize = rootEmSize;\n    this.emSize = emSize;\n    this.createCanvas = createCanvas;\n    this.createImage = this.bindCreateImage(createImage, anonymousCrossOrigin);\n    this.screen.wait(this.isImagesLoaded.bind(this));\n    this.screen.wait(this.isFontsLoaded.bind(this));\n  }\n\n  bindCreateImage(createImage, anonymousCrossOrigin) {\n    if (typeof anonymousCrossOrigin === 'boolean') {\n      return (source, forceAnonymousCrossOrigin) => createImage(source, typeof forceAnonymousCrossOrigin === 'boolean' ? forceAnonymousCrossOrigin : anonymousCrossOrigin);\n    }\n\n    return createImage;\n  }\n\n  get window() {\n    return this.screen.window;\n  }\n\n  get fetch() {\n    return this.screen.fetch;\n  }\n\n  get ctx() {\n    return this.screen.ctx;\n  }\n\n  get emSize() {\n    var {\n      emSizeStack\n    } = this;\n    return emSizeStack[emSizeStack.length - 1];\n  }\n\n  set emSize(value) {\n    var {\n      emSizeStack\n    } = this;\n    emSizeStack.push(value);\n  }\n\n  popEmSize() {\n    var {\n      emSizeStack\n    } = this;\n    emSizeStack.pop();\n  }\n\n  getUniqueId() {\n    return \"canvg\".concat(++this.uniqueId);\n  }\n\n  isImagesLoaded() {\n    return this.images.every(_ => _.loaded);\n  }\n\n  isFontsLoaded() {\n    return this.fonts.every(_ => _.loaded);\n  }\n\n  createDocumentElement(document) {\n    var documentElement = this.createElement(document.documentElement);\n    documentElement.root = true;\n    documentElement.addStylesFromStyleDefinition();\n    this.documentElement = documentElement;\n    return documentElement;\n  }\n\n  createElement(node) {\n    var elementType = node.nodeName.replace(/^[^:]+:/, '');\n    var ElementType = Document.elementTypes[elementType];\n\n    if (typeof ElementType !== 'undefined') {\n      return new ElementType(this, node);\n    }\n\n    return new UnknownElement(this, node);\n  }\n\n  createTextNode(node) {\n    return new TextNode(this, node);\n  }\n\n  setViewBox(config) {\n    this.screen.setViewBox(_objectSpread$1({\n      document: this\n    }, config));\n  }\n\n}\nDocument.createCanvas = createCanvas;\nDocument.createImage = createImage;\nDocument.elementTypes = elements;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/**\r\n * SVG renderer on canvas.\r\n */\n\nclass Canvg {\n  /**\r\n   * Main constructor.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG Document.\r\n   * @param options - Rendering options.\r\n   */\n  constructor(ctx, svg) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    this.parser = new Parser(options);\n    this.screen = new Screen(ctx, options);\n    this.options = options;\n    var document = new Document(this, options);\n    var documentElement = document.createDocumentElement(svg);\n    this.document = document;\n    this.documentElement = documentElement;\n  }\n  /**\r\n   * Create Canvg instance from SVG source string or URL.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG source string or URL.\r\n   * @param options - Rendering options.\r\n   * @returns Canvg instance.\r\n   */\n\n\n  static from(ctx, svg) {\n    var _arguments = arguments;\n    return _asyncToGenerator(function* () {\n      var options = _arguments.length > 2 && _arguments[2] !== undefined ? _arguments[2] : {};\n      var parser = new Parser(options);\n      var svgDocument = yield parser.parse(svg);\n      return new Canvg(ctx, svgDocument, options);\n    })();\n  }\n  /**\r\n   * Create Canvg instance from SVG source string.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG source string.\r\n   * @param options - Rendering options.\r\n   * @returns Canvg instance.\r\n   */\n\n\n  static fromString(ctx, svg) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var parser = new Parser(options);\n    var svgDocument = parser.parseFromString(svg);\n    return new Canvg(ctx, svgDocument, options);\n  }\n  /**\r\n   * Create new Canvg instance with inherited options.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG source string or URL.\r\n   * @param options - Rendering options.\r\n   * @returns Canvg instance.\r\n   */\n\n\n  fork(ctx, svg) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return Canvg.from(ctx, svg, _objectSpread(_objectSpread({}, this.options), options));\n  }\n  /**\r\n   * Create new Canvg instance with inherited options.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG source string.\r\n   * @param options - Rendering options.\r\n   * @returns Canvg instance.\r\n   */\n\n\n  forkString(ctx, svg) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return Canvg.fromString(ctx, svg, _objectSpread(_objectSpread({}, this.options), options));\n  }\n  /**\r\n   * Document is ready promise.\r\n   * @returns Ready promise.\r\n   */\n\n\n  ready() {\n    return this.screen.ready();\n  }\n  /**\r\n   * Document is ready value.\r\n   * @returns Is ready or not.\r\n   */\n\n\n  isReady() {\n    return this.screen.isReady();\n  }\n  /**\r\n   * Render only first frame, ignoring animations and mouse.\r\n   * @param options - Rendering options.\r\n   */\n\n\n  render() {\n    var _arguments2 = arguments,\n        _this = this;\n\n    return _asyncToGenerator(function* () {\n      var options = _arguments2.length > 0 && _arguments2[0] !== undefined ? _arguments2[0] : {};\n\n      _this.start(_objectSpread({\n        enableRedraw: true,\n        ignoreAnimation: true,\n        ignoreMouse: true\n      }, options));\n\n      yield _this.ready();\n\n      _this.stop();\n    })();\n  }\n  /**\r\n   * Start rendering.\r\n   * @param options - Render options.\r\n   */\n\n\n  start() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var {\n      documentElement,\n      screen,\n      options: baseOptions\n    } = this;\n    screen.start(documentElement, _objectSpread(_objectSpread({\n      enableRedraw: true\n    }, baseOptions), options));\n  }\n  /**\r\n   * Stop rendering.\r\n   */\n\n\n  stop() {\n    this.screen.stop();\n  }\n  /**\r\n   * Resize SVG to fit in given size.\r\n   * @param width\r\n   * @param height\r\n   * @param preserveAspectRatio\r\n   */\n\n\n  resize(width) {\n    var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : width;\n    var preserveAspectRatio = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.documentElement.resize(width, height, preserveAspectRatio);\n  }\n\n}\n\nexport default Canvg;\nexport { AElement, AnimateColorElement, AnimateElement, AnimateTransformElement, BoundingBox, CB1, CB2, CB3, CB4, Canvg, CircleElement, ClipPathElement, DefsElement, DescElement, Document, Element, EllipseElement, FeColorMatrixElement, FeCompositeElement, FeDropShadowElement, FeGaussianBlurElement, FeMorphologyElement, FilterElement, Font, FontElement, FontFaceElement, GElement, GlyphElement, GradientElement, ImageElement, LineElement, LinearGradientElement, MarkerElement, MaskElement, Matrix, MissingGlyphElement, Mouse, PSEUDO_ZERO, Parser, PathElement, PathParser, PatternElement, Point, PolygonElement, PolylineElement, Property, QB1, QB2, QB3, RadialGradientElement, RectElement, RenderedElement, Rotate, SVGElement, SVGFontLoader, Scale, Screen, Skew, SkewX, SkewY, StopElement, StyleElement, SymbolElement, TRefElement, TSpanElement, TextElement, TextPathElement, TitleElement, Transform, Translate, UnknownElement, UseElement, ViewPort, compressSpaces, getSelectorSpecificity, normalizeAttributeName, normalizeColor, parseExternalUrl, index as presets, toNumbers, trimLeft, trimRight, vectorMagnitude, vectorsAngle, vectorsRatio };\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZXMuanMiLCJzb3VyY2VzIjpbXSwic291cmNlc0NvbnRlbnQiOltdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsifQ==\n"]},"metadata":{},"sourceType":"module"}